<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>flask-websocket | karr's blog</title><meta name="author" content="karr"><meta name="copyright" content="karr"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="项目结构 web-socketiosocketio.js github下载地址 1https:&#x2F;&#x2F;github.com&#x2F;socketio&#x2F;socket.io&#x2F;blob&#x2F;main&#x2F;client-dist&#x2F;socket.io.js index.html1234567891011121314151617181920212223242526272829&lt;!DOCTYPE html&gt;&lt;ht">
<meta property="og:type" content="article">
<meta property="og:title" content="flask-websocket">
<meta property="og:url" content="https://bitterteaer.github.io/flask-websocket/index.html">
<meta property="og:site_name" content="karr&#39;s blog">
<meta property="og:description" content="项目结构 web-socketiosocketio.js github下载地址 1https:&#x2F;&#x2F;github.com&#x2F;socketio&#x2F;socket.io&#x2F;blob&#x2F;main&#x2F;client-dist&#x2F;socket.io.js index.html1234567891011121314151617181920212223242526272829&lt;!DOCTYPE html&gt;&lt;ht">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://bitterteaer.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2022-08-02T06:43:59.903Z">
<meta property="article:modified_time" content="2025-02-19T09:01:15.268Z">
<meta property="article:author" content="karr">
<meta property="article:tag" content="人工智能, AI, AGI, AIGC, AI Agent, Prompt, LLM, 人工智能应用, 深度学习, 机器学习, 自然语言处理, 生成式AI, 智能算法, 数据科学, 自动化技术, AI驱动技术, AI解决方案, 人机交互, 认知计算, 算法模型, AI平台, 强人工智能, 弱人工智能, 语义理解, 智能代理, AI系统集成, AI工具">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://bitterteaer.github.io/img/avatar.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://bitterteaer.github.io/flask-websocket/index.html"><link rel="preconnect" href="//unpkg.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://unpkg.com/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'flask-websocket',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-02-19 17:01:15'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">281</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">195</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="karr's blog"><span class="site-name">karr's blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">flask-websocket</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-08-02T06:43:59.903Z" title="Created 2022-08-02 14:43:59">2022-08-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-02-19T09:01:15.268Z" title="Updated 2025-02-19 17:01:15">2025-02-19</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="flask-websocket"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><p><img src="https://img2022.cnblogs.com/blog/2450939/202208/2450939-20220802143949399-1503158256.png" alt="image"></p>
<h3 id="web-socketio"><a href="#web-socketio" class="headerlink" title="web-socketio"></a>web-socketio</h3><p>socketio.js github下载地址</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/socketio/socket.io/blob/main/client-dist/socket.io.js</span><br></pre></td></tr></table></figure>
<h4 id="index-html"><a href="#index-html" class="headerlink" title="index.html"></a>index.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/static/js/socketio_v4.5.1.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> websocket_url = <span class="string">&#x27;http://&#x27;</span> + <span class="variable language_">document</span>.<span class="property">domain</span> + <span class="string">&#x27;:&#x27;</span> + location.<span class="property">port</span> + <span class="string">&#x27;/testnamespace&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//没错是用http开头的url了，因为这个库会自动解析并帮我们创建websocket对象的</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//最后的namespace是websocket中的命名空间，后面再讲</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> socket = io.<span class="title function_">connect</span>(websocket_url);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//发送消息</span></span></span><br><span class="line"><span class="language-javascript">    socket.<span class="title function_">emit</span>(<span class="string">&#x27;request_for_response&#x27;</span>,&#123;<span class="string">&#x27;param&#x27;</span>:<span class="string">&#x27;value&#x27;</span>&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//监听回复的消息</span></span></span><br><span class="line"><span class="language-javascript">    socket.<span class="title function_">on</span>(<span class="string">&#x27;response&#x27;</span>,<span class="keyword">function</span>(<span class="params">data</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (data.<span class="property">code</span> == <span class="string">&#x27;200&#x27;</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">alert</span>(data.<span class="property">msg</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">alert</span>(<span class="string">&#x27;ERROR:&#x27;</span> + data.<span class="property">msg</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="flask-socketio"><a href="#flask-socketio" class="headerlink" title="flask-socketio"></a>flask-socketio</h3><p>pip 下载</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install flask-socketio</span><br></pre></td></tr></table></figure>
<h4 id="app-py"><a href="#app-py" class="headerlink" title="app.py"></a>app.py</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line"><span class="keyword">from</span> flask_socketio <span class="keyword">import</span> SocketIO, emit</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">socketio = SocketIO()</span><br><span class="line">socketio.init_app(app)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对app进行一些路由设置</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对socketio进行一些监听设置</span></span><br><span class="line"><span class="meta">@socketio.on(<span class="params"><span class="string">&#x27;request_for_response&#x27;</span>, namespace=<span class="string">&#x27;/testnamespace&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">give_response</span>(<span class="params">data</span>):</span><br><span class="line">    value = data.get(<span class="string">&#x27;param&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 进行一些对value的处理或者其他操作,在此期间可以随时会调用emit方法向前台发送消息</span></span><br><span class="line">    emit(<span class="string">&#x27;response&#x27;</span>, &#123;<span class="string">&#x27;code&#x27;</span>: <span class="string">&#x27;200&#x27;</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;start to process...&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">5</span>)</span><br><span class="line">    emit(<span class="string">&#x27;response&#x27;</span>, &#123;<span class="string">&#x27;code&#x27;</span>: <span class="string">&#x27;200&#x27;</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;processed&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    socketio.run(app, debug=<span class="literal">True</span>, host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br><span class="line">    <span class="comment"># 这里就不再用app.run而用socketio.run了。socketio.run的参数和app.run也都差不多</span></span><br></pre></td></tr></table></figure>

<h3 id="socketio-v4-5-1-js"><a href="#socketio-v4-5-1-js" class="headerlink" title="socketio_v4.5.1.js"></a>socketio_v4.5.1.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br><span class="line">2229</span><br><span class="line">2230</span><br><span class="line">2231</span><br><span class="line">2232</span><br><span class="line">2233</span><br><span class="line">2234</span><br><span class="line">2235</span><br><span class="line">2236</span><br><span class="line">2237</span><br><span class="line">2238</span><br><span class="line">2239</span><br><span class="line">2240</span><br><span class="line">2241</span><br><span class="line">2242</span><br><span class="line">2243</span><br><span class="line">2244</span><br><span class="line">2245</span><br><span class="line">2246</span><br><span class="line">2247</span><br><span class="line">2248</span><br><span class="line">2249</span><br><span class="line">2250</span><br><span class="line">2251</span><br><span class="line">2252</span><br><span class="line">2253</span><br><span class="line">2254</span><br><span class="line">2255</span><br><span class="line">2256</span><br><span class="line">2257</span><br><span class="line">2258</span><br><span class="line">2259</span><br><span class="line">2260</span><br><span class="line">2261</span><br><span class="line">2262</span><br><span class="line">2263</span><br><span class="line">2264</span><br><span class="line">2265</span><br><span class="line">2266</span><br><span class="line">2267</span><br><span class="line">2268</span><br><span class="line">2269</span><br><span class="line">2270</span><br><span class="line">2271</span><br><span class="line">2272</span><br><span class="line">2273</span><br><span class="line">2274</span><br><span class="line">2275</span><br><span class="line">2276</span><br><span class="line">2277</span><br><span class="line">2278</span><br><span class="line">2279</span><br><span class="line">2280</span><br><span class="line">2281</span><br><span class="line">2282</span><br><span class="line">2283</span><br><span class="line">2284</span><br><span class="line">2285</span><br><span class="line">2286</span><br><span class="line">2287</span><br><span class="line">2288</span><br><span class="line">2289</span><br><span class="line">2290</span><br><span class="line">2291</span><br><span class="line">2292</span><br><span class="line">2293</span><br><span class="line">2294</span><br><span class="line">2295</span><br><span class="line">2296</span><br><span class="line">2297</span><br><span class="line">2298</span><br><span class="line">2299</span><br><span class="line">2300</span><br><span class="line">2301</span><br><span class="line">2302</span><br><span class="line">2303</span><br><span class="line">2304</span><br><span class="line">2305</span><br><span class="line">2306</span><br><span class="line">2307</span><br><span class="line">2308</span><br><span class="line">2309</span><br><span class="line">2310</span><br><span class="line">2311</span><br><span class="line">2312</span><br><span class="line">2313</span><br><span class="line">2314</span><br><span class="line">2315</span><br><span class="line">2316</span><br><span class="line">2317</span><br><span class="line">2318</span><br><span class="line">2319</span><br><span class="line">2320</span><br><span class="line">2321</span><br><span class="line">2322</span><br><span class="line">2323</span><br><span class="line">2324</span><br><span class="line">2325</span><br><span class="line">2326</span><br><span class="line">2327</span><br><span class="line">2328</span><br><span class="line">2329</span><br><span class="line">2330</span><br><span class="line">2331</span><br><span class="line">2332</span><br><span class="line">2333</span><br><span class="line">2334</span><br><span class="line">2335</span><br><span class="line">2336</span><br><span class="line">2337</span><br><span class="line">2338</span><br><span class="line">2339</span><br><span class="line">2340</span><br><span class="line">2341</span><br><span class="line">2342</span><br><span class="line">2343</span><br><span class="line">2344</span><br><span class="line">2345</span><br><span class="line">2346</span><br><span class="line">2347</span><br><span class="line">2348</span><br><span class="line">2349</span><br><span class="line">2350</span><br><span class="line">2351</span><br><span class="line">2352</span><br><span class="line">2353</span><br><span class="line">2354</span><br><span class="line">2355</span><br><span class="line">2356</span><br><span class="line">2357</span><br><span class="line">2358</span><br><span class="line">2359</span><br><span class="line">2360</span><br><span class="line">2361</span><br><span class="line">2362</span><br><span class="line">2363</span><br><span class="line">2364</span><br><span class="line">2365</span><br><span class="line">2366</span><br><span class="line">2367</span><br><span class="line">2368</span><br><span class="line">2369</span><br><span class="line">2370</span><br><span class="line">2371</span><br><span class="line">2372</span><br><span class="line">2373</span><br><span class="line">2374</span><br><span class="line">2375</span><br><span class="line">2376</span><br><span class="line">2377</span><br><span class="line">2378</span><br><span class="line">2379</span><br><span class="line">2380</span><br><span class="line">2381</span><br><span class="line">2382</span><br><span class="line">2383</span><br><span class="line">2384</span><br><span class="line">2385</span><br><span class="line">2386</span><br><span class="line">2387</span><br><span class="line">2388</span><br><span class="line">2389</span><br><span class="line">2390</span><br><span class="line">2391</span><br><span class="line">2392</span><br><span class="line">2393</span><br><span class="line">2394</span><br><span class="line">2395</span><br><span class="line">2396</span><br><span class="line">2397</span><br><span class="line">2398</span><br><span class="line">2399</span><br><span class="line">2400</span><br><span class="line">2401</span><br><span class="line">2402</span><br><span class="line">2403</span><br><span class="line">2404</span><br><span class="line">2405</span><br><span class="line">2406</span><br><span class="line">2407</span><br><span class="line">2408</span><br><span class="line">2409</span><br><span class="line">2410</span><br><span class="line">2411</span><br><span class="line">2412</span><br><span class="line">2413</span><br><span class="line">2414</span><br><span class="line">2415</span><br><span class="line">2416</span><br><span class="line">2417</span><br><span class="line">2418</span><br><span class="line">2419</span><br><span class="line">2420</span><br><span class="line">2421</span><br><span class="line">2422</span><br><span class="line">2423</span><br><span class="line">2424</span><br><span class="line">2425</span><br><span class="line">2426</span><br><span class="line">2427</span><br><span class="line">2428</span><br><span class="line">2429</span><br><span class="line">2430</span><br><span class="line">2431</span><br><span class="line">2432</span><br><span class="line">2433</span><br><span class="line">2434</span><br><span class="line">2435</span><br><span class="line">2436</span><br><span class="line">2437</span><br><span class="line">2438</span><br><span class="line">2439</span><br><span class="line">2440</span><br><span class="line">2441</span><br><span class="line">2442</span><br><span class="line">2443</span><br><span class="line">2444</span><br><span class="line">2445</span><br><span class="line">2446</span><br><span class="line">2447</span><br><span class="line">2448</span><br><span class="line">2449</span><br><span class="line">2450</span><br><span class="line">2451</span><br><span class="line">2452</span><br><span class="line">2453</span><br><span class="line">2454</span><br><span class="line">2455</span><br><span class="line">2456</span><br><span class="line">2457</span><br><span class="line">2458</span><br><span class="line">2459</span><br><span class="line">2460</span><br><span class="line">2461</span><br><span class="line">2462</span><br><span class="line">2463</span><br><span class="line">2464</span><br><span class="line">2465</span><br><span class="line">2466</span><br><span class="line">2467</span><br><span class="line">2468</span><br><span class="line">2469</span><br><span class="line">2470</span><br><span class="line">2471</span><br><span class="line">2472</span><br><span class="line">2473</span><br><span class="line">2474</span><br><span class="line">2475</span><br><span class="line">2476</span><br><span class="line">2477</span><br><span class="line">2478</span><br><span class="line">2479</span><br><span class="line">2480</span><br><span class="line">2481</span><br><span class="line">2482</span><br><span class="line">2483</span><br><span class="line">2484</span><br><span class="line">2485</span><br><span class="line">2486</span><br><span class="line">2487</span><br><span class="line">2488</span><br><span class="line">2489</span><br><span class="line">2490</span><br><span class="line">2491</span><br><span class="line">2492</span><br><span class="line">2493</span><br><span class="line">2494</span><br><span class="line">2495</span><br><span class="line">2496</span><br><span class="line">2497</span><br><span class="line">2498</span><br><span class="line">2499</span><br><span class="line">2500</span><br><span class="line">2501</span><br><span class="line">2502</span><br><span class="line">2503</span><br><span class="line">2504</span><br><span class="line">2505</span><br><span class="line">2506</span><br><span class="line">2507</span><br><span class="line">2508</span><br><span class="line">2509</span><br><span class="line">2510</span><br><span class="line">2511</span><br><span class="line">2512</span><br><span class="line">2513</span><br><span class="line">2514</span><br><span class="line">2515</span><br><span class="line">2516</span><br><span class="line">2517</span><br><span class="line">2518</span><br><span class="line">2519</span><br><span class="line">2520</span><br><span class="line">2521</span><br><span class="line">2522</span><br><span class="line">2523</span><br><span class="line">2524</span><br><span class="line">2525</span><br><span class="line">2526</span><br><span class="line">2527</span><br><span class="line">2528</span><br><span class="line">2529</span><br><span class="line">2530</span><br><span class="line">2531</span><br><span class="line">2532</span><br><span class="line">2533</span><br><span class="line">2534</span><br><span class="line">2535</span><br><span class="line">2536</span><br><span class="line">2537</span><br><span class="line">2538</span><br><span class="line">2539</span><br><span class="line">2540</span><br><span class="line">2541</span><br><span class="line">2542</span><br><span class="line">2543</span><br><span class="line">2544</span><br><span class="line">2545</span><br><span class="line">2546</span><br><span class="line">2547</span><br><span class="line">2548</span><br><span class="line">2549</span><br><span class="line">2550</span><br><span class="line">2551</span><br><span class="line">2552</span><br><span class="line">2553</span><br><span class="line">2554</span><br><span class="line">2555</span><br><span class="line">2556</span><br><span class="line">2557</span><br><span class="line">2558</span><br><span class="line">2559</span><br><span class="line">2560</span><br><span class="line">2561</span><br><span class="line">2562</span><br><span class="line">2563</span><br><span class="line">2564</span><br><span class="line">2565</span><br><span class="line">2566</span><br><span class="line">2567</span><br><span class="line">2568</span><br><span class="line">2569</span><br><span class="line">2570</span><br><span class="line">2571</span><br><span class="line">2572</span><br><span class="line">2573</span><br><span class="line">2574</span><br><span class="line">2575</span><br><span class="line">2576</span><br><span class="line">2577</span><br><span class="line">2578</span><br><span class="line">2579</span><br><span class="line">2580</span><br><span class="line">2581</span><br><span class="line">2582</span><br><span class="line">2583</span><br><span class="line">2584</span><br><span class="line">2585</span><br><span class="line">2586</span><br><span class="line">2587</span><br><span class="line">2588</span><br><span class="line">2589</span><br><span class="line">2590</span><br><span class="line">2591</span><br><span class="line">2592</span><br><span class="line">2593</span><br><span class="line">2594</span><br><span class="line">2595</span><br><span class="line">2596</span><br><span class="line">2597</span><br><span class="line">2598</span><br><span class="line">2599</span><br><span class="line">2600</span><br><span class="line">2601</span><br><span class="line">2602</span><br><span class="line">2603</span><br><span class="line">2604</span><br><span class="line">2605</span><br><span class="line">2606</span><br><span class="line">2607</span><br><span class="line">2608</span><br><span class="line">2609</span><br><span class="line">2610</span><br><span class="line">2611</span><br><span class="line">2612</span><br><span class="line">2613</span><br><span class="line">2614</span><br><span class="line">2615</span><br><span class="line">2616</span><br><span class="line">2617</span><br><span class="line">2618</span><br><span class="line">2619</span><br><span class="line">2620</span><br><span class="line">2621</span><br><span class="line">2622</span><br><span class="line">2623</span><br><span class="line">2624</span><br><span class="line">2625</span><br><span class="line">2626</span><br><span class="line">2627</span><br><span class="line">2628</span><br><span class="line">2629</span><br><span class="line">2630</span><br><span class="line">2631</span><br><span class="line">2632</span><br><span class="line">2633</span><br><span class="line">2634</span><br><span class="line">2635</span><br><span class="line">2636</span><br><span class="line">2637</span><br><span class="line">2638</span><br><span class="line">2639</span><br><span class="line">2640</span><br><span class="line">2641</span><br><span class="line">2642</span><br><span class="line">2643</span><br><span class="line">2644</span><br><span class="line">2645</span><br><span class="line">2646</span><br><span class="line">2647</span><br><span class="line">2648</span><br><span class="line">2649</span><br><span class="line">2650</span><br><span class="line">2651</span><br><span class="line">2652</span><br><span class="line">2653</span><br><span class="line">2654</span><br><span class="line">2655</span><br><span class="line">2656</span><br><span class="line">2657</span><br><span class="line">2658</span><br><span class="line">2659</span><br><span class="line">2660</span><br><span class="line">2661</span><br><span class="line">2662</span><br><span class="line">2663</span><br><span class="line">2664</span><br><span class="line">2665</span><br><span class="line">2666</span><br><span class="line">2667</span><br><span class="line">2668</span><br><span class="line">2669</span><br><span class="line">2670</span><br><span class="line">2671</span><br><span class="line">2672</span><br><span class="line">2673</span><br><span class="line">2674</span><br><span class="line">2675</span><br><span class="line">2676</span><br><span class="line">2677</span><br><span class="line">2678</span><br><span class="line">2679</span><br><span class="line">2680</span><br><span class="line">2681</span><br><span class="line">2682</span><br><span class="line">2683</span><br><span class="line">2684</span><br><span class="line">2685</span><br><span class="line">2686</span><br><span class="line">2687</span><br><span class="line">2688</span><br><span class="line">2689</span><br><span class="line">2690</span><br><span class="line">2691</span><br><span class="line">2692</span><br><span class="line">2693</span><br><span class="line">2694</span><br><span class="line">2695</span><br><span class="line">2696</span><br><span class="line">2697</span><br><span class="line">2698</span><br><span class="line">2699</span><br><span class="line">2700</span><br><span class="line">2701</span><br><span class="line">2702</span><br><span class="line">2703</span><br><span class="line">2704</span><br><span class="line">2705</span><br><span class="line">2706</span><br><span class="line">2707</span><br><span class="line">2708</span><br><span class="line">2709</span><br><span class="line">2710</span><br><span class="line">2711</span><br><span class="line">2712</span><br><span class="line">2713</span><br><span class="line">2714</span><br><span class="line">2715</span><br><span class="line">2716</span><br><span class="line">2717</span><br><span class="line">2718</span><br><span class="line">2719</span><br><span class="line">2720</span><br><span class="line">2721</span><br><span class="line">2722</span><br><span class="line">2723</span><br><span class="line">2724</span><br><span class="line">2725</span><br><span class="line">2726</span><br><span class="line">2727</span><br><span class="line">2728</span><br><span class="line">2729</span><br><span class="line">2730</span><br><span class="line">2731</span><br><span class="line">2732</span><br><span class="line">2733</span><br><span class="line">2734</span><br><span class="line">2735</span><br><span class="line">2736</span><br><span class="line">2737</span><br><span class="line">2738</span><br><span class="line">2739</span><br><span class="line">2740</span><br><span class="line">2741</span><br><span class="line">2742</span><br><span class="line">2743</span><br><span class="line">2744</span><br><span class="line">2745</span><br><span class="line">2746</span><br><span class="line">2747</span><br><span class="line">2748</span><br><span class="line">2749</span><br><span class="line">2750</span><br><span class="line">2751</span><br><span class="line">2752</span><br><span class="line">2753</span><br><span class="line">2754</span><br><span class="line">2755</span><br><span class="line">2756</span><br><span class="line">2757</span><br><span class="line">2758</span><br><span class="line">2759</span><br><span class="line">2760</span><br><span class="line">2761</span><br><span class="line">2762</span><br><span class="line">2763</span><br><span class="line">2764</span><br><span class="line">2765</span><br><span class="line">2766</span><br><span class="line">2767</span><br><span class="line">2768</span><br><span class="line">2769</span><br><span class="line">2770</span><br><span class="line">2771</span><br><span class="line">2772</span><br><span class="line">2773</span><br><span class="line">2774</span><br><span class="line">2775</span><br><span class="line">2776</span><br><span class="line">2777</span><br><span class="line">2778</span><br><span class="line">2779</span><br><span class="line">2780</span><br><span class="line">2781</span><br><span class="line">2782</span><br><span class="line">2783</span><br><span class="line">2784</span><br><span class="line">2785</span><br><span class="line">2786</span><br><span class="line">2787</span><br><span class="line">2788</span><br><span class="line">2789</span><br><span class="line">2790</span><br><span class="line">2791</span><br><span class="line">2792</span><br><span class="line">2793</span><br><span class="line">2794</span><br><span class="line">2795</span><br><span class="line">2796</span><br><span class="line">2797</span><br><span class="line">2798</span><br><span class="line">2799</span><br><span class="line">2800</span><br><span class="line">2801</span><br><span class="line">2802</span><br><span class="line">2803</span><br><span class="line">2804</span><br><span class="line">2805</span><br><span class="line">2806</span><br><span class="line">2807</span><br><span class="line">2808</span><br><span class="line">2809</span><br><span class="line">2810</span><br><span class="line">2811</span><br><span class="line">2812</span><br><span class="line">2813</span><br><span class="line">2814</span><br><span class="line">2815</span><br><span class="line">2816</span><br><span class="line">2817</span><br><span class="line">2818</span><br><span class="line">2819</span><br><span class="line">2820</span><br><span class="line">2821</span><br><span class="line">2822</span><br><span class="line">2823</span><br><span class="line">2824</span><br><span class="line">2825</span><br><span class="line">2826</span><br><span class="line">2827</span><br><span class="line">2828</span><br><span class="line">2829</span><br><span class="line">2830</span><br><span class="line">2831</span><br><span class="line">2832</span><br><span class="line">2833</span><br><span class="line">2834</span><br><span class="line">2835</span><br><span class="line">2836</span><br><span class="line">2837</span><br><span class="line">2838</span><br><span class="line">2839</span><br><span class="line">2840</span><br><span class="line">2841</span><br><span class="line">2842</span><br><span class="line">2843</span><br><span class="line">2844</span><br><span class="line">2845</span><br><span class="line">2846</span><br><span class="line">2847</span><br><span class="line">2848</span><br><span class="line">2849</span><br><span class="line">2850</span><br><span class="line">2851</span><br><span class="line">2852</span><br><span class="line">2853</span><br><span class="line">2854</span><br><span class="line">2855</span><br><span class="line">2856</span><br><span class="line">2857</span><br><span class="line">2858</span><br><span class="line">2859</span><br><span class="line">2860</span><br><span class="line">2861</span><br><span class="line">2862</span><br><span class="line">2863</span><br><span class="line">2864</span><br><span class="line">2865</span><br><span class="line">2866</span><br><span class="line">2867</span><br><span class="line">2868</span><br><span class="line">2869</span><br><span class="line">2870</span><br><span class="line">2871</span><br><span class="line">2872</span><br><span class="line">2873</span><br><span class="line">2874</span><br><span class="line">2875</span><br><span class="line">2876</span><br><span class="line">2877</span><br><span class="line">2878</span><br><span class="line">2879</span><br><span class="line">2880</span><br><span class="line">2881</span><br><span class="line">2882</span><br><span class="line">2883</span><br><span class="line">2884</span><br><span class="line">2885</span><br><span class="line">2886</span><br><span class="line">2887</span><br><span class="line">2888</span><br><span class="line">2889</span><br><span class="line">2890</span><br><span class="line">2891</span><br><span class="line">2892</span><br><span class="line">2893</span><br><span class="line">2894</span><br><span class="line">2895</span><br><span class="line">2896</span><br><span class="line">2897</span><br><span class="line">2898</span><br><span class="line">2899</span><br><span class="line">2900</span><br><span class="line">2901</span><br><span class="line">2902</span><br><span class="line">2903</span><br><span class="line">2904</span><br><span class="line">2905</span><br><span class="line">2906</span><br><span class="line">2907</span><br><span class="line">2908</span><br><span class="line">2909</span><br><span class="line">2910</span><br><span class="line">2911</span><br><span class="line">2912</span><br><span class="line">2913</span><br><span class="line">2914</span><br><span class="line">2915</span><br><span class="line">2916</span><br><span class="line">2917</span><br><span class="line">2918</span><br><span class="line">2919</span><br><span class="line">2920</span><br><span class="line">2921</span><br><span class="line">2922</span><br><span class="line">2923</span><br><span class="line">2924</span><br><span class="line">2925</span><br><span class="line">2926</span><br><span class="line">2927</span><br><span class="line">2928</span><br><span class="line">2929</span><br><span class="line">2930</span><br><span class="line">2931</span><br><span class="line">2932</span><br><span class="line">2933</span><br><span class="line">2934</span><br><span class="line">2935</span><br><span class="line">2936</span><br><span class="line">2937</span><br><span class="line">2938</span><br><span class="line">2939</span><br><span class="line">2940</span><br><span class="line">2941</span><br><span class="line">2942</span><br><span class="line">2943</span><br><span class="line">2944</span><br><span class="line">2945</span><br><span class="line">2946</span><br><span class="line">2947</span><br><span class="line">2948</span><br><span class="line">2949</span><br><span class="line">2950</span><br><span class="line">2951</span><br><span class="line">2952</span><br><span class="line">2953</span><br><span class="line">2954</span><br><span class="line">2955</span><br><span class="line">2956</span><br><span class="line">2957</span><br><span class="line">2958</span><br><span class="line">2959</span><br><span class="line">2960</span><br><span class="line">2961</span><br><span class="line">2962</span><br><span class="line">2963</span><br><span class="line">2964</span><br><span class="line">2965</span><br><span class="line">2966</span><br><span class="line">2967</span><br><span class="line">2968</span><br><span class="line">2969</span><br><span class="line">2970</span><br><span class="line">2971</span><br><span class="line">2972</span><br><span class="line">2973</span><br><span class="line">2974</span><br><span class="line">2975</span><br><span class="line">2976</span><br><span class="line">2977</span><br><span class="line">2978</span><br><span class="line">2979</span><br><span class="line">2980</span><br><span class="line">2981</span><br><span class="line">2982</span><br><span class="line">2983</span><br><span class="line">2984</span><br><span class="line">2985</span><br><span class="line">2986</span><br><span class="line">2987</span><br><span class="line">2988</span><br><span class="line">2989</span><br><span class="line">2990</span><br><span class="line">2991</span><br><span class="line">2992</span><br><span class="line">2993</span><br><span class="line">2994</span><br><span class="line">2995</span><br><span class="line">2996</span><br><span class="line">2997</span><br><span class="line">2998</span><br><span class="line">2999</span><br><span class="line">3000</span><br><span class="line">3001</span><br><span class="line">3002</span><br><span class="line">3003</span><br><span class="line">3004</span><br><span class="line">3005</span><br><span class="line">3006</span><br><span class="line">3007</span><br><span class="line">3008</span><br><span class="line">3009</span><br><span class="line">3010</span><br><span class="line">3011</span><br><span class="line">3012</span><br><span class="line">3013</span><br><span class="line">3014</span><br><span class="line">3015</span><br><span class="line">3016</span><br><span class="line">3017</span><br><span class="line">3018</span><br><span class="line">3019</span><br><span class="line">3020</span><br><span class="line">3021</span><br><span class="line">3022</span><br><span class="line">3023</span><br><span class="line">3024</span><br><span class="line">3025</span><br><span class="line">3026</span><br><span class="line">3027</span><br><span class="line">3028</span><br><span class="line">3029</span><br><span class="line">3030</span><br><span class="line">3031</span><br><span class="line">3032</span><br><span class="line">3033</span><br><span class="line">3034</span><br><span class="line">3035</span><br><span class="line">3036</span><br><span class="line">3037</span><br><span class="line">3038</span><br><span class="line">3039</span><br><span class="line">3040</span><br><span class="line">3041</span><br><span class="line">3042</span><br><span class="line">3043</span><br><span class="line">3044</span><br><span class="line">3045</span><br><span class="line">3046</span><br><span class="line">3047</span><br><span class="line">3048</span><br><span class="line">3049</span><br><span class="line">3050</span><br><span class="line">3051</span><br><span class="line">3052</span><br><span class="line">3053</span><br><span class="line">3054</span><br><span class="line">3055</span><br><span class="line">3056</span><br><span class="line">3057</span><br><span class="line">3058</span><br><span class="line">3059</span><br><span class="line">3060</span><br><span class="line">3061</span><br><span class="line">3062</span><br><span class="line">3063</span><br><span class="line">3064</span><br><span class="line">3065</span><br><span class="line">3066</span><br><span class="line">3067</span><br><span class="line">3068</span><br><span class="line">3069</span><br><span class="line">3070</span><br><span class="line">3071</span><br><span class="line">3072</span><br><span class="line">3073</span><br><span class="line">3074</span><br><span class="line">3075</span><br><span class="line">3076</span><br><span class="line">3077</span><br><span class="line">3078</span><br><span class="line">3079</span><br><span class="line">3080</span><br><span class="line">3081</span><br><span class="line">3082</span><br><span class="line">3083</span><br><span class="line">3084</span><br><span class="line">3085</span><br><span class="line">3086</span><br><span class="line">3087</span><br><span class="line">3088</span><br><span class="line">3089</span><br><span class="line">3090</span><br><span class="line">3091</span><br><span class="line">3092</span><br><span class="line">3093</span><br><span class="line">3094</span><br><span class="line">3095</span><br><span class="line">3096</span><br><span class="line">3097</span><br><span class="line">3098</span><br><span class="line">3099</span><br><span class="line">3100</span><br><span class="line">3101</span><br><span class="line">3102</span><br><span class="line">3103</span><br><span class="line">3104</span><br><span class="line">3105</span><br><span class="line">3106</span><br><span class="line">3107</span><br><span class="line">3108</span><br><span class="line">3109</span><br><span class="line">3110</span><br><span class="line">3111</span><br><span class="line">3112</span><br><span class="line">3113</span><br><span class="line">3114</span><br><span class="line">3115</span><br><span class="line">3116</span><br><span class="line">3117</span><br><span class="line">3118</span><br><span class="line">3119</span><br><span class="line">3120</span><br><span class="line">3121</span><br><span class="line">3122</span><br><span class="line">3123</span><br><span class="line">3124</span><br><span class="line">3125</span><br><span class="line">3126</span><br><span class="line">3127</span><br><span class="line">3128</span><br><span class="line">3129</span><br><span class="line">3130</span><br><span class="line">3131</span><br><span class="line">3132</span><br><span class="line">3133</span><br><span class="line">3134</span><br><span class="line">3135</span><br><span class="line">3136</span><br><span class="line">3137</span><br><span class="line">3138</span><br><span class="line">3139</span><br><span class="line">3140</span><br><span class="line">3141</span><br><span class="line">3142</span><br><span class="line">3143</span><br><span class="line">3144</span><br><span class="line">3145</span><br><span class="line">3146</span><br><span class="line">3147</span><br><span class="line">3148</span><br><span class="line">3149</span><br><span class="line">3150</span><br><span class="line">3151</span><br><span class="line">3152</span><br><span class="line">3153</span><br><span class="line">3154</span><br><span class="line">3155</span><br><span class="line">3156</span><br><span class="line">3157</span><br><span class="line">3158</span><br><span class="line">3159</span><br><span class="line">3160</span><br><span class="line">3161</span><br><span class="line">3162</span><br><span class="line">3163</span><br><span class="line">3164</span><br><span class="line">3165</span><br><span class="line">3166</span><br><span class="line">3167</span><br><span class="line">3168</span><br><span class="line">3169</span><br><span class="line">3170</span><br><span class="line">3171</span><br><span class="line">3172</span><br><span class="line">3173</span><br><span class="line">3174</span><br><span class="line">3175</span><br><span class="line">3176</span><br><span class="line">3177</span><br><span class="line">3178</span><br><span class="line">3179</span><br><span class="line">3180</span><br><span class="line">3181</span><br><span class="line">3182</span><br><span class="line">3183</span><br><span class="line">3184</span><br><span class="line">3185</span><br><span class="line">3186</span><br><span class="line">3187</span><br><span class="line">3188</span><br><span class="line">3189</span><br><span class="line">3190</span><br><span class="line">3191</span><br><span class="line">3192</span><br><span class="line">3193</span><br><span class="line">3194</span><br><span class="line">3195</span><br><span class="line">3196</span><br><span class="line">3197</span><br><span class="line">3198</span><br><span class="line">3199</span><br><span class="line">3200</span><br><span class="line">3201</span><br><span class="line">3202</span><br><span class="line">3203</span><br><span class="line">3204</span><br><span class="line">3205</span><br><span class="line">3206</span><br><span class="line">3207</span><br><span class="line">3208</span><br><span class="line">3209</span><br><span class="line">3210</span><br><span class="line">3211</span><br><span class="line">3212</span><br><span class="line">3213</span><br><span class="line">3214</span><br><span class="line">3215</span><br><span class="line">3216</span><br><span class="line">3217</span><br><span class="line">3218</span><br><span class="line">3219</span><br><span class="line">3220</span><br><span class="line">3221</span><br><span class="line">3222</span><br><span class="line">3223</span><br><span class="line">3224</span><br><span class="line">3225</span><br><span class="line">3226</span><br><span class="line">3227</span><br><span class="line">3228</span><br><span class="line">3229</span><br><span class="line">3230</span><br><span class="line">3231</span><br><span class="line">3232</span><br><span class="line">3233</span><br><span class="line">3234</span><br><span class="line">3235</span><br><span class="line">3236</span><br><span class="line">3237</span><br><span class="line">3238</span><br><span class="line">3239</span><br><span class="line">3240</span><br><span class="line">3241</span><br><span class="line">3242</span><br><span class="line">3243</span><br><span class="line">3244</span><br><span class="line">3245</span><br><span class="line">3246</span><br><span class="line">3247</span><br><span class="line">3248</span><br><span class="line">3249</span><br><span class="line">3250</span><br><span class="line">3251</span><br><span class="line">3252</span><br><span class="line">3253</span><br><span class="line">3254</span><br><span class="line">3255</span><br><span class="line">3256</span><br><span class="line">3257</span><br><span class="line">3258</span><br><span class="line">3259</span><br><span class="line">3260</span><br><span class="line">3261</span><br><span class="line">3262</span><br><span class="line">3263</span><br><span class="line">3264</span><br><span class="line">3265</span><br><span class="line">3266</span><br><span class="line">3267</span><br><span class="line">3268</span><br><span class="line">3269</span><br><span class="line">3270</span><br><span class="line">3271</span><br><span class="line">3272</span><br><span class="line">3273</span><br><span class="line">3274</span><br><span class="line">3275</span><br><span class="line">3276</span><br><span class="line">3277</span><br><span class="line">3278</span><br><span class="line">3279</span><br><span class="line">3280</span><br><span class="line">3281</span><br><span class="line">3282</span><br><span class="line">3283</span><br><span class="line">3284</span><br><span class="line">3285</span><br><span class="line">3286</span><br><span class="line">3287</span><br><span class="line">3288</span><br><span class="line">3289</span><br><span class="line">3290</span><br><span class="line">3291</span><br><span class="line">3292</span><br><span class="line">3293</span><br><span class="line">3294</span><br><span class="line">3295</span><br><span class="line">3296</span><br><span class="line">3297</span><br><span class="line">3298</span><br><span class="line">3299</span><br><span class="line">3300</span><br><span class="line">3301</span><br><span class="line">3302</span><br><span class="line">3303</span><br><span class="line">3304</span><br><span class="line">3305</span><br><span class="line">3306</span><br><span class="line">3307</span><br><span class="line">3308</span><br><span class="line">3309</span><br><span class="line">3310</span><br><span class="line">3311</span><br><span class="line">3312</span><br><span class="line">3313</span><br><span class="line">3314</span><br><span class="line">3315</span><br><span class="line">3316</span><br><span class="line">3317</span><br><span class="line">3318</span><br><span class="line">3319</span><br><span class="line">3320</span><br><span class="line">3321</span><br><span class="line">3322</span><br><span class="line">3323</span><br><span class="line">3324</span><br><span class="line">3325</span><br><span class="line">3326</span><br><span class="line">3327</span><br><span class="line">3328</span><br><span class="line">3329</span><br><span class="line">3330</span><br><span class="line">3331</span><br><span class="line">3332</span><br><span class="line">3333</span><br><span class="line">3334</span><br><span class="line">3335</span><br><span class="line">3336</span><br><span class="line">3337</span><br><span class="line">3338</span><br><span class="line">3339</span><br><span class="line">3340</span><br><span class="line">3341</span><br><span class="line">3342</span><br><span class="line">3343</span><br><span class="line">3344</span><br><span class="line">3345</span><br><span class="line">3346</span><br><span class="line">3347</span><br><span class="line">3348</span><br><span class="line">3349</span><br><span class="line">3350</span><br><span class="line">3351</span><br><span class="line">3352</span><br><span class="line">3353</span><br><span class="line">3354</span><br><span class="line">3355</span><br><span class="line">3356</span><br><span class="line">3357</span><br><span class="line">3358</span><br><span class="line">3359</span><br><span class="line">3360</span><br><span class="line">3361</span><br><span class="line">3362</span><br><span class="line">3363</span><br><span class="line">3364</span><br><span class="line">3365</span><br><span class="line">3366</span><br><span class="line">3367</span><br><span class="line">3368</span><br><span class="line">3369</span><br><span class="line">3370</span><br><span class="line">3371</span><br><span class="line">3372</span><br><span class="line">3373</span><br><span class="line">3374</span><br><span class="line">3375</span><br><span class="line">3376</span><br><span class="line">3377</span><br><span class="line">3378</span><br><span class="line">3379</span><br><span class="line">3380</span><br><span class="line">3381</span><br><span class="line">3382</span><br><span class="line">3383</span><br><span class="line">3384</span><br><span class="line">3385</span><br><span class="line">3386</span><br><span class="line">3387</span><br><span class="line">3388</span><br><span class="line">3389</span><br><span class="line">3390</span><br><span class="line">3391</span><br><span class="line">3392</span><br><span class="line">3393</span><br><span class="line">3394</span><br><span class="line">3395</span><br><span class="line">3396</span><br><span class="line">3397</span><br><span class="line">3398</span><br><span class="line">3399</span><br><span class="line">3400</span><br><span class="line">3401</span><br><span class="line">3402</span><br><span class="line">3403</span><br><span class="line">3404</span><br><span class="line">3405</span><br><span class="line">3406</span><br><span class="line">3407</span><br><span class="line">3408</span><br><span class="line">3409</span><br><span class="line">3410</span><br><span class="line">3411</span><br><span class="line">3412</span><br><span class="line">3413</span><br><span class="line">3414</span><br><span class="line">3415</span><br><span class="line">3416</span><br><span class="line">3417</span><br><span class="line">3418</span><br><span class="line">3419</span><br><span class="line">3420</span><br><span class="line">3421</span><br><span class="line">3422</span><br><span class="line">3423</span><br><span class="line">3424</span><br><span class="line">3425</span><br><span class="line">3426</span><br><span class="line">3427</span><br><span class="line">3428</span><br><span class="line">3429</span><br><span class="line">3430</span><br><span class="line">3431</span><br><span class="line">3432</span><br><span class="line">3433</span><br><span class="line">3434</span><br><span class="line">3435</span><br><span class="line">3436</span><br><span class="line">3437</span><br><span class="line">3438</span><br><span class="line">3439</span><br><span class="line">3440</span><br><span class="line">3441</span><br><span class="line">3442</span><br><span class="line">3443</span><br><span class="line">3444</span><br><span class="line">3445</span><br><span class="line">3446</span><br><span class="line">3447</span><br><span class="line">3448</span><br><span class="line">3449</span><br><span class="line">3450</span><br><span class="line">3451</span><br><span class="line">3452</span><br><span class="line">3453</span><br><span class="line">3454</span><br><span class="line">3455</span><br><span class="line">3456</span><br><span class="line">3457</span><br><span class="line">3458</span><br><span class="line">3459</span><br><span class="line">3460</span><br><span class="line">3461</span><br><span class="line">3462</span><br><span class="line">3463</span><br><span class="line">3464</span><br><span class="line">3465</span><br><span class="line">3466</span><br><span class="line">3467</span><br><span class="line">3468</span><br><span class="line">3469</span><br><span class="line">3470</span><br><span class="line">3471</span><br><span class="line">3472</span><br><span class="line">3473</span><br><span class="line">3474</span><br><span class="line">3475</span><br><span class="line">3476</span><br><span class="line">3477</span><br><span class="line">3478</span><br><span class="line">3479</span><br><span class="line">3480</span><br><span class="line">3481</span><br><span class="line">3482</span><br><span class="line">3483</span><br><span class="line">3484</span><br><span class="line">3485</span><br><span class="line">3486</span><br><span class="line">3487</span><br><span class="line">3488</span><br><span class="line">3489</span><br><span class="line">3490</span><br><span class="line">3491</span><br><span class="line">3492</span><br><span class="line">3493</span><br><span class="line">3494</span><br><span class="line">3495</span><br><span class="line">3496</span><br><span class="line">3497</span><br><span class="line">3498</span><br><span class="line">3499</span><br><span class="line">3500</span><br><span class="line">3501</span><br><span class="line">3502</span><br><span class="line">3503</span><br><span class="line">3504</span><br><span class="line">3505</span><br><span class="line">3506</span><br><span class="line">3507</span><br><span class="line">3508</span><br><span class="line">3509</span><br><span class="line">3510</span><br><span class="line">3511</span><br><span class="line">3512</span><br><span class="line">3513</span><br><span class="line">3514</span><br><span class="line">3515</span><br><span class="line">3516</span><br><span class="line">3517</span><br><span class="line">3518</span><br><span class="line">3519</span><br><span class="line">3520</span><br><span class="line">3521</span><br><span class="line">3522</span><br><span class="line">3523</span><br><span class="line">3524</span><br><span class="line">3525</span><br><span class="line">3526</span><br><span class="line">3527</span><br><span class="line">3528</span><br><span class="line">3529</span><br><span class="line">3530</span><br><span class="line">3531</span><br><span class="line">3532</span><br><span class="line">3533</span><br><span class="line">3534</span><br><span class="line">3535</span><br><span class="line">3536</span><br><span class="line">3537</span><br><span class="line">3538</span><br><span class="line">3539</span><br><span class="line">3540</span><br><span class="line">3541</span><br><span class="line">3542</span><br><span class="line">3543</span><br><span class="line">3544</span><br><span class="line">3545</span><br><span class="line">3546</span><br><span class="line">3547</span><br><span class="line">3548</span><br><span class="line">3549</span><br><span class="line">3550</span><br><span class="line">3551</span><br><span class="line">3552</span><br><span class="line">3553</span><br><span class="line">3554</span><br><span class="line">3555</span><br><span class="line">3556</span><br><span class="line">3557</span><br><span class="line">3558</span><br><span class="line">3559</span><br><span class="line">3560</span><br><span class="line">3561</span><br><span class="line">3562</span><br><span class="line">3563</span><br><span class="line">3564</span><br><span class="line">3565</span><br><span class="line">3566</span><br><span class="line">3567</span><br><span class="line">3568</span><br><span class="line">3569</span><br><span class="line">3570</span><br><span class="line">3571</span><br><span class="line">3572</span><br><span class="line">3573</span><br><span class="line">3574</span><br><span class="line">3575</span><br><span class="line">3576</span><br><span class="line">3577</span><br><span class="line">3578</span><br><span class="line">3579</span><br><span class="line">3580</span><br><span class="line">3581</span><br><span class="line">3582</span><br><span class="line">3583</span><br><span class="line">3584</span><br><span class="line">3585</span><br><span class="line">3586</span><br><span class="line">3587</span><br><span class="line">3588</span><br><span class="line">3589</span><br><span class="line">3590</span><br><span class="line">3591</span><br><span class="line">3592</span><br><span class="line">3593</span><br><span class="line">3594</span><br><span class="line">3595</span><br><span class="line">3596</span><br><span class="line">3597</span><br><span class="line">3598</span><br><span class="line">3599</span><br><span class="line">3600</span><br><span class="line">3601</span><br><span class="line">3602</span><br><span class="line">3603</span><br><span class="line">3604</span><br><span class="line">3605</span><br><span class="line">3606</span><br><span class="line">3607</span><br><span class="line">3608</span><br><span class="line">3609</span><br><span class="line">3610</span><br><span class="line">3611</span><br><span class="line">3612</span><br><span class="line">3613</span><br><span class="line">3614</span><br><span class="line">3615</span><br><span class="line">3616</span><br><span class="line">3617</span><br><span class="line">3618</span><br><span class="line">3619</span><br><span class="line">3620</span><br><span class="line">3621</span><br><span class="line">3622</span><br><span class="line">3623</span><br><span class="line">3624</span><br><span class="line">3625</span><br><span class="line">3626</span><br><span class="line">3627</span><br><span class="line">3628</span><br><span class="line">3629</span><br><span class="line">3630</span><br><span class="line">3631</span><br><span class="line">3632</span><br><span class="line">3633</span><br><span class="line">3634</span><br><span class="line">3635</span><br><span class="line">3636</span><br><span class="line">3637</span><br><span class="line">3638</span><br><span class="line">3639</span><br><span class="line">3640</span><br><span class="line">3641</span><br><span class="line">3642</span><br><span class="line">3643</span><br><span class="line">3644</span><br><span class="line">3645</span><br><span class="line">3646</span><br><span class="line">3647</span><br><span class="line">3648</span><br><span class="line">3649</span><br><span class="line">3650</span><br><span class="line">3651</span><br><span class="line">3652</span><br><span class="line">3653</span><br><span class="line">3654</span><br><span class="line">3655</span><br><span class="line">3656</span><br><span class="line">3657</span><br><span class="line">3658</span><br><span class="line">3659</span><br><span class="line">3660</span><br><span class="line">3661</span><br><span class="line">3662</span><br><span class="line">3663</span><br><span class="line">3664</span><br><span class="line">3665</span><br><span class="line">3666</span><br><span class="line">3667</span><br><span class="line">3668</span><br><span class="line">3669</span><br><span class="line">3670</span><br><span class="line">3671</span><br><span class="line">3672</span><br><span class="line">3673</span><br><span class="line">3674</span><br><span class="line">3675</span><br><span class="line">3676</span><br><span class="line">3677</span><br><span class="line">3678</span><br><span class="line">3679</span><br><span class="line">3680</span><br><span class="line">3681</span><br><span class="line">3682</span><br><span class="line">3683</span><br><span class="line">3684</span><br><span class="line">3685</span><br><span class="line">3686</span><br><span class="line">3687</span><br><span class="line">3688</span><br><span class="line">3689</span><br><span class="line">3690</span><br><span class="line">3691</span><br><span class="line">3692</span><br><span class="line">3693</span><br><span class="line">3694</span><br><span class="line">3695</span><br><span class="line">3696</span><br><span class="line">3697</span><br><span class="line">3698</span><br><span class="line">3699</span><br><span class="line">3700</span><br><span class="line">3701</span><br><span class="line">3702</span><br><span class="line">3703</span><br><span class="line">3704</span><br><span class="line">3705</span><br><span class="line">3706</span><br><span class="line">3707</span><br><span class="line">3708</span><br><span class="line">3709</span><br><span class="line">3710</span><br><span class="line">3711</span><br><span class="line">3712</span><br><span class="line">3713</span><br><span class="line">3714</span><br><span class="line">3715</span><br><span class="line">3716</span><br><span class="line">3717</span><br><span class="line">3718</span><br><span class="line">3719</span><br><span class="line">3720</span><br><span class="line">3721</span><br><span class="line">3722</span><br><span class="line">3723</span><br><span class="line">3724</span><br><span class="line">3725</span><br><span class="line">3726</span><br><span class="line">3727</span><br><span class="line">3728</span><br><span class="line">3729</span><br><span class="line">3730</span><br><span class="line">3731</span><br><span class="line">3732</span><br><span class="line">3733</span><br><span class="line">3734</span><br><span class="line">3735</span><br><span class="line">3736</span><br><span class="line">3737</span><br><span class="line">3738</span><br><span class="line">3739</span><br><span class="line">3740</span><br><span class="line">3741</span><br><span class="line">3742</span><br><span class="line">3743</span><br><span class="line">3744</span><br><span class="line">3745</span><br><span class="line">3746</span><br><span class="line">3747</span><br><span class="line">3748</span><br><span class="line">3749</span><br><span class="line">3750</span><br><span class="line">3751</span><br><span class="line">3752</span><br><span class="line">3753</span><br><span class="line">3754</span><br><span class="line">3755</span><br><span class="line">3756</span><br><span class="line">3757</span><br><span class="line">3758</span><br><span class="line">3759</span><br><span class="line">3760</span><br><span class="line">3761</span><br><span class="line">3762</span><br><span class="line">3763</span><br><span class="line">3764</span><br><span class="line">3765</span><br><span class="line">3766</span><br><span class="line">3767</span><br><span class="line">3768</span><br><span class="line">3769</span><br><span class="line">3770</span><br><span class="line">3771</span><br><span class="line">3772</span><br><span class="line">3773</span><br><span class="line">3774</span><br><span class="line">3775</span><br><span class="line">3776</span><br><span class="line">3777</span><br><span class="line">3778</span><br><span class="line">3779</span><br><span class="line">3780</span><br><span class="line">3781</span><br><span class="line">3782</span><br><span class="line">3783</span><br><span class="line">3784</span><br><span class="line">3785</span><br><span class="line">3786</span><br><span class="line">3787</span><br><span class="line">3788</span><br><span class="line">3789</span><br><span class="line">3790</span><br><span class="line">3791</span><br><span class="line">3792</span><br><span class="line">3793</span><br><span class="line">3794</span><br><span class="line">3795</span><br><span class="line">3796</span><br><span class="line">3797</span><br><span class="line">3798</span><br><span class="line">3799</span><br><span class="line">3800</span><br><span class="line">3801</span><br><span class="line">3802</span><br><span class="line">3803</span><br><span class="line">3804</span><br><span class="line">3805</span><br><span class="line">3806</span><br><span class="line">3807</span><br><span class="line">3808</span><br><span class="line">3809</span><br><span class="line">3810</span><br><span class="line">3811</span><br><span class="line">3812</span><br><span class="line">3813</span><br><span class="line">3814</span><br><span class="line">3815</span><br><span class="line">3816</span><br><span class="line">3817</span><br><span class="line">3818</span><br><span class="line">3819</span><br><span class="line">3820</span><br><span class="line">3821</span><br><span class="line">3822</span><br><span class="line">3823</span><br><span class="line">3824</span><br><span class="line">3825</span><br><span class="line">3826</span><br><span class="line">3827</span><br><span class="line">3828</span><br><span class="line">3829</span><br><span class="line">3830</span><br><span class="line">3831</span><br><span class="line">3832</span><br><span class="line">3833</span><br><span class="line">3834</span><br><span class="line">3835</span><br><span class="line">3836</span><br><span class="line">3837</span><br><span class="line">3838</span><br><span class="line">3839</span><br><span class="line">3840</span><br><span class="line">3841</span><br><span class="line">3842</span><br><span class="line">3843</span><br><span class="line">3844</span><br><span class="line">3845</span><br><span class="line">3846</span><br><span class="line">3847</span><br><span class="line">3848</span><br><span class="line">3849</span><br><span class="line">3850</span><br><span class="line">3851</span><br><span class="line">3852</span><br><span class="line">3853</span><br><span class="line">3854</span><br><span class="line">3855</span><br><span class="line">3856</span><br><span class="line">3857</span><br><span class="line">3858</span><br><span class="line">3859</span><br><span class="line">3860</span><br><span class="line">3861</span><br><span class="line">3862</span><br><span class="line">3863</span><br><span class="line">3864</span><br><span class="line">3865</span><br><span class="line">3866</span><br><span class="line">3867</span><br><span class="line">3868</span><br><span class="line">3869</span><br><span class="line">3870</span><br><span class="line">3871</span><br><span class="line">3872</span><br><span class="line">3873</span><br><span class="line">3874</span><br><span class="line">3875</span><br><span class="line">3876</span><br><span class="line">3877</span><br><span class="line">3878</span><br><span class="line">3879</span><br><span class="line">3880</span><br><span class="line">3881</span><br><span class="line">3882</span><br><span class="line">3883</span><br><span class="line">3884</span><br><span class="line">3885</span><br><span class="line">3886</span><br><span class="line">3887</span><br><span class="line">3888</span><br><span class="line">3889</span><br><span class="line">3890</span><br><span class="line">3891</span><br><span class="line">3892</span><br><span class="line">3893</span><br><span class="line">3894</span><br><span class="line">3895</span><br><span class="line">3896</span><br><span class="line">3897</span><br><span class="line">3898</span><br><span class="line">3899</span><br><span class="line">3900</span><br><span class="line">3901</span><br><span class="line">3902</span><br><span class="line">3903</span><br><span class="line">3904</span><br><span class="line">3905</span><br><span class="line">3906</span><br><span class="line">3907</span><br><span class="line">3908</span><br><span class="line">3909</span><br><span class="line">3910</span><br><span class="line">3911</span><br><span class="line">3912</span><br><span class="line">3913</span><br><span class="line">3914</span><br><span class="line">3915</span><br><span class="line">3916</span><br><span class="line">3917</span><br><span class="line">3918</span><br><span class="line">3919</span><br><span class="line">3920</span><br><span class="line">3921</span><br><span class="line">3922</span><br><span class="line">3923</span><br><span class="line">3924</span><br><span class="line">3925</span><br><span class="line">3926</span><br><span class="line">3927</span><br><span class="line">3928</span><br><span class="line">3929</span><br><span class="line">3930</span><br><span class="line">3931</span><br><span class="line">3932</span><br><span class="line">3933</span><br><span class="line">3934</span><br><span class="line">3935</span><br><span class="line">3936</span><br><span class="line">3937</span><br><span class="line">3938</span><br><span class="line">3939</span><br><span class="line">3940</span><br><span class="line">3941</span><br><span class="line">3942</span><br><span class="line">3943</span><br><span class="line">3944</span><br><span class="line">3945</span><br><span class="line">3946</span><br><span class="line">3947</span><br><span class="line">3948</span><br><span class="line">3949</span><br><span class="line">3950</span><br><span class="line">3951</span><br><span class="line">3952</span><br><span class="line">3953</span><br><span class="line">3954</span><br><span class="line">3955</span><br><span class="line">3956</span><br><span class="line">3957</span><br><span class="line">3958</span><br><span class="line">3959</span><br><span class="line">3960</span><br><span class="line">3961</span><br><span class="line">3962</span><br><span class="line">3963</span><br><span class="line">3964</span><br><span class="line">3965</span><br><span class="line">3966</span><br><span class="line">3967</span><br><span class="line">3968</span><br><span class="line">3969</span><br><span class="line">3970</span><br><span class="line">3971</span><br><span class="line">3972</span><br><span class="line">3973</span><br><span class="line">3974</span><br><span class="line">3975</span><br><span class="line">3976</span><br><span class="line">3977</span><br><span class="line">3978</span><br><span class="line">3979</span><br><span class="line">3980</span><br><span class="line">3981</span><br><span class="line">3982</span><br><span class="line">3983</span><br><span class="line">3984</span><br><span class="line">3985</span><br><span class="line">3986</span><br><span class="line">3987</span><br><span class="line">3988</span><br><span class="line">3989</span><br><span class="line">3990</span><br><span class="line">3991</span><br><span class="line">3992</span><br><span class="line">3993</span><br><span class="line">3994</span><br><span class="line">3995</span><br><span class="line">3996</span><br><span class="line">3997</span><br><span class="line">3998</span><br><span class="line">3999</span><br><span class="line">4000</span><br><span class="line">4001</span><br><span class="line">4002</span><br><span class="line">4003</span><br><span class="line">4004</span><br><span class="line">4005</span><br><span class="line">4006</span><br><span class="line">4007</span><br><span class="line">4008</span><br><span class="line">4009</span><br><span class="line">4010</span><br><span class="line">4011</span><br><span class="line">4012</span><br><span class="line">4013</span><br><span class="line">4014</span><br><span class="line">4015</span><br><span class="line">4016</span><br><span class="line">4017</span><br><span class="line">4018</span><br><span class="line">4019</span><br><span class="line">4020</span><br><span class="line">4021</span><br><span class="line">4022</span><br><span class="line">4023</span><br><span class="line">4024</span><br><span class="line">4025</span><br><span class="line">4026</span><br><span class="line">4027</span><br><span class="line">4028</span><br><span class="line">4029</span><br><span class="line">4030</span><br><span class="line">4031</span><br><span class="line">4032</span><br><span class="line">4033</span><br><span class="line">4034</span><br><span class="line">4035</span><br><span class="line">4036</span><br><span class="line">4037</span><br><span class="line">4038</span><br><span class="line">4039</span><br><span class="line">4040</span><br><span class="line">4041</span><br><span class="line">4042</span><br><span class="line">4043</span><br><span class="line">4044</span><br><span class="line">4045</span><br><span class="line">4046</span><br><span class="line">4047</span><br><span class="line">4048</span><br><span class="line">4049</span><br><span class="line">4050</span><br><span class="line">4051</span><br><span class="line">4052</span><br><span class="line">4053</span><br><span class="line">4054</span><br><span class="line">4055</span><br><span class="line">4056</span><br><span class="line">4057</span><br><span class="line">4058</span><br><span class="line">4059</span><br><span class="line">4060</span><br><span class="line">4061</span><br><span class="line">4062</span><br><span class="line">4063</span><br><span class="line">4064</span><br><span class="line">4065</span><br><span class="line">4066</span><br><span class="line">4067</span><br><span class="line">4068</span><br><span class="line">4069</span><br><span class="line">4070</span><br><span class="line">4071</span><br><span class="line">4072</span><br><span class="line">4073</span><br><span class="line">4074</span><br><span class="line">4075</span><br><span class="line">4076</span><br><span class="line">4077</span><br><span class="line">4078</span><br><span class="line">4079</span><br><span class="line">4080</span><br><span class="line">4081</span><br><span class="line">4082</span><br><span class="line">4083</span><br><span class="line">4084</span><br><span class="line">4085</span><br><span class="line">4086</span><br><span class="line">4087</span><br><span class="line">4088</span><br><span class="line">4089</span><br><span class="line">4090</span><br><span class="line">4091</span><br><span class="line">4092</span><br><span class="line">4093</span><br><span class="line">4094</span><br><span class="line">4095</span><br><span class="line">4096</span><br><span class="line">4097</span><br><span class="line">4098</span><br><span class="line">4099</span><br><span class="line">4100</span><br><span class="line">4101</span><br><span class="line">4102</span><br><span class="line">4103</span><br><span class="line">4104</span><br><span class="line">4105</span><br><span class="line">4106</span><br><span class="line">4107</span><br><span class="line">4108</span><br><span class="line">4109</span><br><span class="line">4110</span><br><span class="line">4111</span><br><span class="line">4112</span><br><span class="line">4113</span><br><span class="line">4114</span><br><span class="line">4115</span><br><span class="line">4116</span><br><span class="line">4117</span><br><span class="line">4118</span><br><span class="line">4119</span><br><span class="line">4120</span><br><span class="line">4121</span><br><span class="line">4122</span><br><span class="line">4123</span><br><span class="line">4124</span><br><span class="line">4125</span><br><span class="line">4126</span><br><span class="line">4127</span><br><span class="line">4128</span><br><span class="line">4129</span><br><span class="line">4130</span><br><span class="line">4131</span><br><span class="line">4132</span><br><span class="line">4133</span><br><span class="line">4134</span><br><span class="line">4135</span><br><span class="line">4136</span><br><span class="line">4137</span><br><span class="line">4138</span><br><span class="line">4139</span><br><span class="line">4140</span><br><span class="line">4141</span><br><span class="line">4142</span><br><span class="line">4143</span><br><span class="line">4144</span><br><span class="line">4145</span><br><span class="line">4146</span><br><span class="line">4147</span><br><span class="line">4148</span><br><span class="line">4149</span><br><span class="line">4150</span><br><span class="line">4151</span><br><span class="line">4152</span><br><span class="line">4153</span><br><span class="line">4154</span><br><span class="line">4155</span><br><span class="line">4156</span><br><span class="line">4157</span><br><span class="line">4158</span><br><span class="line">4159</span><br><span class="line">4160</span><br><span class="line">4161</span><br><span class="line">4162</span><br><span class="line">4163</span><br><span class="line">4164</span><br><span class="line">4165</span><br><span class="line">4166</span><br><span class="line">4167</span><br><span class="line">4168</span><br><span class="line">4169</span><br><span class="line">4170</span><br><span class="line">4171</span><br><span class="line">4172</span><br><span class="line">4173</span><br><span class="line">4174</span><br><span class="line">4175</span><br><span class="line">4176</span><br><span class="line">4177</span><br><span class="line">4178</span><br><span class="line">4179</span><br><span class="line">4180</span><br><span class="line">4181</span><br><span class="line">4182</span><br><span class="line">4183</span><br><span class="line">4184</span><br><span class="line">4185</span><br><span class="line">4186</span><br><span class="line">4187</span><br><span class="line">4188</span><br><span class="line">4189</span><br><span class="line">4190</span><br><span class="line">4191</span><br><span class="line">4192</span><br><span class="line">4193</span><br><span class="line">4194</span><br><span class="line">4195</span><br><span class="line">4196</span><br><span class="line">4197</span><br><span class="line">4198</span><br><span class="line">4199</span><br><span class="line">4200</span><br><span class="line">4201</span><br><span class="line">4202</span><br><span class="line">4203</span><br><span class="line">4204</span><br><span class="line">4205</span><br><span class="line">4206</span><br><span class="line">4207</span><br><span class="line">4208</span><br><span class="line">4209</span><br><span class="line">4210</span><br><span class="line">4211</span><br><span class="line">4212</span><br><span class="line">4213</span><br><span class="line">4214</span><br><span class="line">4215</span><br><span class="line">4216</span><br><span class="line">4217</span><br><span class="line">4218</span><br><span class="line">4219</span><br><span class="line">4220</span><br><span class="line">4221</span><br><span class="line">4222</span><br><span class="line">4223</span><br><span class="line">4224</span><br><span class="line">4225</span><br><span class="line">4226</span><br><span class="line">4227</span><br><span class="line">4228</span><br><span class="line">4229</span><br><span class="line">4230</span><br><span class="line">4231</span><br><span class="line">4232</span><br><span class="line">4233</span><br><span class="line">4234</span><br><span class="line">4235</span><br><span class="line">4236</span><br><span class="line">4237</span><br><span class="line">4238</span><br><span class="line">4239</span><br><span class="line">4240</span><br><span class="line">4241</span><br><span class="line">4242</span><br><span class="line">4243</span><br><span class="line">4244</span><br><span class="line">4245</span><br><span class="line">4246</span><br><span class="line">4247</span><br><span class="line">4248</span><br><span class="line">4249</span><br><span class="line">4250</span><br><span class="line">4251</span><br><span class="line">4252</span><br><span class="line">4253</span><br><span class="line">4254</span><br><span class="line">4255</span><br><span class="line">4256</span><br><span class="line">4257</span><br><span class="line">4258</span><br><span class="line">4259</span><br><span class="line">4260</span><br><span class="line">4261</span><br><span class="line">4262</span><br><span class="line">4263</span><br><span class="line">4264</span><br><span class="line">4265</span><br><span class="line">4266</span><br><span class="line">4267</span><br><span class="line">4268</span><br><span class="line">4269</span><br><span class="line">4270</span><br><span class="line">4271</span><br><span class="line">4272</span><br><span class="line">4273</span><br><span class="line">4274</span><br><span class="line">4275</span><br><span class="line">4276</span><br><span class="line">4277</span><br><span class="line">4278</span><br><span class="line">4279</span><br><span class="line">4280</span><br><span class="line">4281</span><br><span class="line">4282</span><br><span class="line">4283</span><br><span class="line">4284</span><br><span class="line">4285</span><br><span class="line">4286</span><br><span class="line">4287</span><br><span class="line">4288</span><br><span class="line">4289</span><br><span class="line">4290</span><br><span class="line">4291</span><br><span class="line">4292</span><br><span class="line">4293</span><br><span class="line">4294</span><br><span class="line">4295</span><br><span class="line">4296</span><br><span class="line">4297</span><br><span class="line">4298</span><br><span class="line">4299</span><br><span class="line">4300</span><br><span class="line">4301</span><br><span class="line">4302</span><br><span class="line">4303</span><br><span class="line">4304</span><br><span class="line">4305</span><br><span class="line">4306</span><br><span class="line">4307</span><br><span class="line">4308</span><br><span class="line">4309</span><br><span class="line">4310</span><br><span class="line">4311</span><br><span class="line">4312</span><br><span class="line">4313</span><br><span class="line">4314</span><br><span class="line">4315</span><br><span class="line">4316</span><br><span class="line">4317</span><br><span class="line">4318</span><br><span class="line">4319</span><br><span class="line">4320</span><br><span class="line">4321</span><br><span class="line">4322</span><br><span class="line">4323</span><br><span class="line">4324</span><br><span class="line">4325</span><br><span class="line">4326</span><br><span class="line">4327</span><br><span class="line">4328</span><br><span class="line">4329</span><br><span class="line">4330</span><br><span class="line">4331</span><br><span class="line">4332</span><br><span class="line">4333</span><br><span class="line">4334</span><br><span class="line">4335</span><br><span class="line">4336</span><br><span class="line">4337</span><br><span class="line">4338</span><br><span class="line">4339</span><br><span class="line">4340</span><br><span class="line">4341</span><br><span class="line">4342</span><br><span class="line">4343</span><br><span class="line">4344</span><br><span class="line">4345</span><br><span class="line">4346</span><br><span class="line">4347</span><br><span class="line">4348</span><br><span class="line">4349</span><br><span class="line">4350</span><br><span class="line">4351</span><br><span class="line">4352</span><br><span class="line">4353</span><br><span class="line">4354</span><br><span class="line">4355</span><br><span class="line">4356</span><br><span class="line">4357</span><br><span class="line">4358</span><br><span class="line">4359</span><br><span class="line">4360</span><br><span class="line">4361</span><br><span class="line">4362</span><br><span class="line">4363</span><br><span class="line">4364</span><br><span class="line">4365</span><br><span class="line">4366</span><br><span class="line">4367</span><br><span class="line">4368</span><br><span class="line">4369</span><br><span class="line">4370</span><br><span class="line">4371</span><br><span class="line">4372</span><br><span class="line">4373</span><br><span class="line">4374</span><br><span class="line">4375</span><br><span class="line">4376</span><br><span class="line">4377</span><br><span class="line">4378</span><br><span class="line">4379</span><br><span class="line">4380</span><br><span class="line">4381</span><br><span class="line">4382</span><br><span class="line">4383</span><br><span class="line">4384</span><br><span class="line">4385</span><br><span class="line">4386</span><br><span class="line">4387</span><br><span class="line">4388</span><br><span class="line">4389</span><br><span class="line">4390</span><br><span class="line">4391</span><br><span class="line">4392</span><br><span class="line">4393</span><br><span class="line">4394</span><br><span class="line">4395</span><br><span class="line">4396</span><br><span class="line">4397</span><br><span class="line">4398</span><br><span class="line">4399</span><br><span class="line">4400</span><br><span class="line">4401</span><br><span class="line">4402</span><br><span class="line">4403</span><br><span class="line">4404</span><br><span class="line">4405</span><br><span class="line">4406</span><br><span class="line">4407</span><br><span class="line">4408</span><br><span class="line">4409</span><br><span class="line">4410</span><br><span class="line">4411</span><br><span class="line">4412</span><br><span class="line">4413</span><br><span class="line">4414</span><br><span class="line">4415</span><br><span class="line">4416</span><br><span class="line">4417</span><br><span class="line">4418</span><br><span class="line">4419</span><br><span class="line">4420</span><br><span class="line">4421</span><br><span class="line">4422</span><br><span class="line">4423</span><br><span class="line">4424</span><br><span class="line">4425</span><br><span class="line">4426</span><br><span class="line">4427</span><br><span class="line">4428</span><br><span class="line">4429</span><br><span class="line">4430</span><br><span class="line">4431</span><br><span class="line">4432</span><br><span class="line">4433</span><br><span class="line">4434</span><br><span class="line">4435</span><br><span class="line">4436</span><br><span class="line">4437</span><br><span class="line">4438</span><br><span class="line">4439</span><br><span class="line">4440</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment"> * Socket.IO v4.5.1</span></span><br><span class="line"><span class="comment"> * (c) 2014-2022 Guillermo Rauch</span></span><br><span class="line"><span class="comment"> * Released under the MIT License.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">(<span class="keyword">function</span> (<span class="params"><span class="variable language_">global</span>, factory</span>) &#123;</span><br><span class="line">  <span class="keyword">typeof</span> <span class="built_in">exports</span> === <span class="string">&#x27;object&#x27;</span> &amp;&amp; <span class="keyword">typeof</span> <span class="variable language_">module</span> !== <span class="string">&#x27;undefined&#x27;</span> ? <span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">factory</span>() :</span><br><span class="line">  <span class="keyword">typeof</span> define === <span class="string">&#x27;function&#x27;</span> &amp;&amp; define.<span class="property">amd</span> ? <span class="title function_">define</span>(factory) :</span><br><span class="line">  (<span class="variable language_">global</span> = <span class="keyword">typeof</span> globalThis !== <span class="string">&#x27;undefined&#x27;</span> ? globalThis : <span class="variable language_">global</span> || self, <span class="variable language_">global</span>.<span class="property">io</span> = <span class="title function_">factory</span>());</span><br><span class="line">&#125;)(<span class="variable language_">this</span>, (<span class="keyword">function</span> (<span class="params"></span>) &#123; <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_typeof</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="string">&quot;@babel/helpers - typeof&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="title class_">Symbol</span> === <span class="string">&quot;function&quot;</span> &amp;&amp; <span class="keyword">typeof</span> <span class="title class_">Symbol</span>.<span class="property">iterator</span> === <span class="string">&quot;symbol&quot;</span>) &#123;</span><br><span class="line">      _typeof = <span class="keyword">function</span> (<span class="params">obj</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">typeof</span> obj;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      _typeof = <span class="keyword">function</span> (<span class="params">obj</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> obj &amp;&amp; <span class="keyword">typeof</span> <span class="title class_">Symbol</span> === <span class="string">&quot;function&quot;</span> &amp;&amp; obj.<span class="property">constructor</span> === <span class="title class_">Symbol</span> &amp;&amp; obj !== <span class="title class_">Symbol</span>.<span class="property"><span class="keyword">prototype</span></span> ? <span class="string">&quot;symbol&quot;</span> : <span class="keyword">typeof</span> obj;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">_typeof</span>(obj);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_classCallCheck</span>(<span class="params">instance, Constructor</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!(instance <span class="keyword">instanceof</span> <span class="title class_">Constructor</span>)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&quot;Cannot call a class as a function&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_defineProperties</span>(<span class="params">target, props</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; props.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">var</span> descriptor = props[i];</span><br><span class="line">      descriptor.<span class="property">enumerable</span> = descriptor.<span class="property">enumerable</span> || <span class="literal">false</span>;</span><br><span class="line">      descriptor.<span class="property">configurable</span> = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="string">&quot;value&quot;</span> <span class="keyword">in</span> descriptor) descriptor.<span class="property">writable</span> = <span class="literal">true</span>;</span><br><span class="line">      <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(target, descriptor.<span class="property">key</span>, descriptor);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_createClass</span>(<span class="params">Constructor, protoProps, staticProps</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (protoProps) <span class="title function_">_defineProperties</span>(<span class="title class_">Constructor</span>.<span class="property"><span class="keyword">prototype</span></span>, protoProps);</span><br><span class="line">    <span class="keyword">if</span> (staticProps) <span class="title function_">_defineProperties</span>(<span class="title class_">Constructor</span>, staticProps);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Constructor</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_extends</span>(<span class="params"></span>) &#123;</span><br><span class="line">    _extends = <span class="title class_">Object</span>.<span class="property">assign</span> || <span class="keyword">function</span> (<span class="params">target</span>) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> source = <span class="variable language_">arguments</span>[i];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">          <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(source, key)) &#123;</span><br><span class="line">            target[key] = source[key];</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> target;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> _extends.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_inherits</span>(<span class="params">subClass, superClass</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> superClass !== <span class="string">&quot;function&quot;</span> &amp;&amp; superClass !== <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&quot;Super expression must either be null or a function&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    subClass.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(superClass &amp;&amp; superClass.<span class="property"><span class="keyword">prototype</span></span>, &#123;</span><br><span class="line">      <span class="attr">constructor</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: subClass,</span><br><span class="line">        <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">if</span> (superClass) <span class="title function_">_setPrototypeOf</span>(subClass, superClass);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_getPrototypeOf</span>(<span class="params">o</span>) &#123;</span><br><span class="line">    _getPrototypeOf = <span class="title class_">Object</span>.<span class="property">setPrototypeOf</span> ? <span class="title class_">Object</span>.<span class="property">getPrototypeOf</span> : <span class="keyword">function</span> <span class="title function_">_getPrototypeOf</span>(<span class="params">o</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> o.<span class="property">__proto__</span> || <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(o);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">_getPrototypeOf</span>(o);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_setPrototypeOf</span>(<span class="params">o, p</span>) &#123;</span><br><span class="line">    _setPrototypeOf = <span class="title class_">Object</span>.<span class="property">setPrototypeOf</span> || <span class="keyword">function</span> <span class="title function_">_setPrototypeOf</span>(<span class="params">o, p</span>) &#123;</span><br><span class="line">      o.<span class="property">__proto__</span> = p;</span><br><span class="line">      <span class="keyword">return</span> o;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">_setPrototypeOf</span>(o, p);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_isNativeReflectConstruct</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="title class_">Reflect</span> === <span class="string">&quot;undefined&quot;</span> || !<span class="title class_">Reflect</span>.<span class="property">construct</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Reflect</span>.<span class="property">construct</span>.<span class="property">sham</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="title class_">Proxy</span> === <span class="string">&quot;function&quot;</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="title class_">Boolean</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">valueOf</span>.<span class="title function_">call</span>(<span class="title class_">Reflect</span>.<span class="title function_">construct</span>(<span class="title class_">Boolean</span>, [], <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;));</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_construct</span>(<span class="params">Parent, args, Class</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">_isNativeReflectConstruct</span>()) &#123;</span><br><span class="line">      _construct = <span class="title class_">Reflect</span>.<span class="property">construct</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      _construct = <span class="keyword">function</span> <span class="title function_">_construct</span>(<span class="params">Parent, args, Class</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> a = [<span class="literal">null</span>];</span><br><span class="line">        a.<span class="property">push</span>.<span class="title function_">apply</span>(a, args);</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Constructor</span> = <span class="title class_">Function</span>.<span class="property">bind</span>.<span class="title function_">apply</span>(<span class="title class_">Parent</span>, a);</span><br><span class="line">        <span class="keyword">var</span> instance = <span class="keyword">new</span> <span class="title class_">Constructor</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Class</span>) <span class="title function_">_setPrototypeOf</span>(instance, <span class="title class_">Class</span>.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> _construct.<span class="title function_">apply</span>(<span class="literal">null</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_isNativeFunction</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Function</span>.<span class="property">toString</span>.<span class="title function_">call</span>(fn).<span class="title function_">indexOf</span>(<span class="string">&quot;[native code]&quot;</span>) !== -<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_wrapNativeSuper</span>(<span class="params">Class</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> _cache = <span class="keyword">typeof</span> <span class="title class_">Map</span> === <span class="string">&quot;function&quot;</span> ? <span class="keyword">new</span> <span class="title class_">Map</span>() : <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line">    _wrapNativeSuper = <span class="keyword">function</span> <span class="title function_">_wrapNativeSuper</span>(<span class="params">Class</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Class</span> === <span class="literal">null</span> || !<span class="title function_">_isNativeFunction</span>(<span class="title class_">Class</span>)) <span class="keyword">return</span> <span class="title class_">Class</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="title class_">Class</span> !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&quot;Super expression must either be null or a function&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> _cache !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (_cache.<span class="title function_">has</span>(<span class="title class_">Class</span>)) <span class="keyword">return</span> _cache.<span class="title function_">get</span>(<span class="title class_">Class</span>);</span><br><span class="line"></span><br><span class="line">        _cache.<span class="title function_">set</span>(<span class="title class_">Class</span>, <span class="title class_">Wrapper</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">Wrapper</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">_construct</span>(<span class="title class_">Class</span>, <span class="variable language_">arguments</span>, <span class="title function_">_getPrototypeOf</span>(<span class="variable language_">this</span>).<span class="property">constructor</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="title class_">Wrapper</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Class</span>.<span class="property"><span class="keyword">prototype</span></span>, &#123;</span><br><span class="line">        <span class="attr">constructor</span>: &#123;</span><br><span class="line">          <span class="attr">value</span>: <span class="title class_">Wrapper</span>,</span><br><span class="line">          <span class="attr">enumerable</span>: <span class="literal">false</span>,</span><br><span class="line">          <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">_setPrototypeOf</span>(<span class="title class_">Wrapper</span>, <span class="title class_">Class</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">_wrapNativeSuper</span>(<span class="title class_">Class</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_assertThisInitialized</span>(<span class="params">self</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (self === <span class="keyword">void</span> <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ReferenceError</span>(<span class="string">&quot;this hasn&#x27;t been initialised - super() hasn&#x27;t been called&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> self;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_possibleConstructorReturn</span>(<span class="params">self, call</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (call &amp;&amp; (<span class="keyword">typeof</span> call === <span class="string">&quot;object&quot;</span> || <span class="keyword">typeof</span> call === <span class="string">&quot;function&quot;</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span> call;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (call !== <span class="keyword">void</span> <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&quot;Derived constructors may only return object or undefined&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">_assertThisInitialized</span>(self);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_createSuper</span>(<span class="params">Derived</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> hasNativeReflectConstruct = <span class="title function_">_isNativeReflectConstruct</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">_createSuperInternal</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> <span class="title class_">Super</span> = <span class="title function_">_getPrototypeOf</span>(<span class="title class_">Derived</span>),</span><br><span class="line">          result;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (hasNativeReflectConstruct) &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">NewTarget</span> = <span class="title function_">_getPrototypeOf</span>(<span class="variable language_">this</span>).<span class="property">constructor</span>;</span><br><span class="line"></span><br><span class="line">        result = <span class="title class_">Reflect</span>.<span class="title function_">construct</span>(<span class="title class_">Super</span>, <span class="variable language_">arguments</span>, <span class="title class_">NewTarget</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        result = <span class="title class_">Super</span>.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">_possibleConstructorReturn</span>(<span class="variable language_">this</span>, result);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_superPropBase</span>(<span class="params">object, property</span>) &#123;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(object, property)) &#123;</span><br><span class="line">      object = <span class="title function_">_getPrototypeOf</span>(object);</span><br><span class="line">      <span class="keyword">if</span> (object === <span class="literal">null</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> object;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_get</span>(<span class="params">target, property, receiver</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="title class_">Reflect</span> !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; <span class="title class_">Reflect</span>.<span class="property">get</span>) &#123;</span><br><span class="line">      _get = <span class="title class_">Reflect</span>.<span class="property">get</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      _get = <span class="keyword">function</span> <span class="title function_">_get</span>(<span class="params">target, property, receiver</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> base = <span class="title function_">_superPropBase</span>(target, property);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!base) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">var</span> desc = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(base, property);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (desc.<span class="property">get</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> desc.<span class="property">get</span>.<span class="title function_">call</span>(receiver);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> desc.<span class="property">value</span>;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">_get</span>(target, property, receiver || target);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_unsupportedIterableToArray</span>(<span class="params">o, minLen</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!o) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> o === <span class="string">&quot;string&quot;</span>) <span class="keyword">return</span> <span class="title function_">_arrayLikeToArray</span>(o, minLen);</span><br><span class="line">    <span class="keyword">var</span> n = <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(o).<span class="title function_">slice</span>(<span class="number">8</span>, -<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (n === <span class="string">&quot;Object&quot;</span> &amp;&amp; o.<span class="property">constructor</span>) n = o.<span class="property">constructor</span>.<span class="property">name</span>;</span><br><span class="line">    <span class="keyword">if</span> (n === <span class="string">&quot;Map&quot;</span> || n === <span class="string">&quot;Set&quot;</span>) <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(o);</span><br><span class="line">    <span class="keyword">if</span> (n === <span class="string">&quot;Arguments&quot;</span> || <span class="regexp">/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/</span>.<span class="title function_">test</span>(n)) <span class="keyword">return</span> <span class="title function_">_arrayLikeToArray</span>(o, minLen);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_arrayLikeToArray</span>(<span class="params">arr, len</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="literal">null</span> || len &gt; arr.<span class="property">length</span>) len = arr.<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, arr2 = <span class="keyword">new</span> <span class="title class_">Array</span>(len); i &lt; len; i++) arr2[i] = arr[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> arr2;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_createForOfIteratorHelper</span>(<span class="params">o, allowArrayLike</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> it = <span class="keyword">typeof</span> <span class="title class_">Symbol</span> !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; o[<span class="title class_">Symbol</span>.<span class="property">iterator</span>] || o[<span class="string">&quot;@@iterator&quot;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!it) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(o) || (it = <span class="title function_">_unsupportedIterableToArray</span>(o)) || allowArrayLike &amp;&amp; o &amp;&amp; <span class="keyword">typeof</span> o.<span class="property">length</span> === <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (it) o = it;</span><br><span class="line">        <span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> F = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">s</span>: F,</span><br><span class="line">          <span class="attr">n</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= o.<span class="property">length</span>) <span class="keyword">return</span> &#123;</span><br><span class="line">              <span class="attr">done</span>: <span class="literal">true</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">              <span class="attr">done</span>: <span class="literal">false</span>,</span><br><span class="line">              <span class="attr">value</span>: o[i++]</span><br><span class="line">            &#125;;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">e</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">f</span>: F</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&quot;Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> normalCompletion = <span class="literal">true</span>,</span><br><span class="line">        didErr = <span class="literal">false</span>,</span><br><span class="line">        err;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">s</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        it = it.<span class="title function_">call</span>(o);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">n</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> step = it.<span class="title function_">next</span>();</span><br><span class="line">        normalCompletion = step.<span class="property">done</span>;</span><br><span class="line">        <span class="keyword">return</span> step;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">e</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">        didErr = <span class="literal">true</span>;</span><br><span class="line">        err = e;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">f</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (!normalCompletion &amp;&amp; it.<span class="property">return</span> != <span class="literal">null</span>) it.<span class="keyword">return</span>();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (didErr) <span class="keyword">throw</span> err;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="variable constant_">PACKET_TYPES</span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>); <span class="comment">// no Map = no polyfill</span></span><br><span class="line"></span><br><span class="line">  <span class="variable constant_">PACKET_TYPES</span>[<span class="string">&quot;open&quot;</span>] = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">  <span class="variable constant_">PACKET_TYPES</span>[<span class="string">&quot;close&quot;</span>] = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">  <span class="variable constant_">PACKET_TYPES</span>[<span class="string">&quot;ping&quot;</span>] = <span class="string">&quot;2&quot;</span>;</span><br><span class="line">  <span class="variable constant_">PACKET_TYPES</span>[<span class="string">&quot;pong&quot;</span>] = <span class="string">&quot;3&quot;</span>;</span><br><span class="line">  <span class="variable constant_">PACKET_TYPES</span>[<span class="string">&quot;message&quot;</span>] = <span class="string">&quot;4&quot;</span>;</span><br><span class="line">  <span class="variable constant_">PACKET_TYPES</span>[<span class="string">&quot;upgrade&quot;</span>] = <span class="string">&quot;5&quot;</span>;</span><br><span class="line">  <span class="variable constant_">PACKET_TYPES</span>[<span class="string">&quot;noop&quot;</span>] = <span class="string">&quot;6&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> <span class="variable constant_">PACKET_TYPES_REVERSE</span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="variable constant_">PACKET_TYPES</span>).<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">key</span>) &#123;</span><br><span class="line">    <span class="variable constant_">PACKET_TYPES_REVERSE</span>[<span class="variable constant_">PACKET_TYPES</span>[key]] = key;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">var</span> <span class="variable constant_">ERROR_PACKET</span> = &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: <span class="string">&quot;parser error&quot;</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> withNativeBlob$1 = <span class="keyword">typeof</span> <span class="title class_">Blob</span> === <span class="string">&quot;function&quot;</span> || <span class="keyword">typeof</span> <span class="title class_">Blob</span> !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="title class_">Blob</span>) === <span class="string">&quot;[object BlobConstructor]&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> withNativeArrayBuffer$2 = <span class="keyword">typeof</span> <span class="title class_">ArrayBuffer</span> === <span class="string">&quot;function&quot;</span>; <span class="comment">// ArrayBuffer.isView method is not defined in IE10</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> isView$1 = <span class="keyword">function</span> <span class="title function_">isView</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> <span class="title class_">ArrayBuffer</span>.<span class="property">isView</span> === <span class="string">&quot;function&quot;</span> ? <span class="title class_">ArrayBuffer</span>.<span class="title function_">isView</span>(obj) : obj &amp;&amp; obj.<span class="property">buffer</span> <span class="keyword">instanceof</span> <span class="title class_">ArrayBuffer</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> encodePacket = <span class="keyword">function</span> <span class="title function_">encodePacket</span>(<span class="params">_ref, supportsBinary, callback</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> type = _ref.<span class="property">type</span>,</span><br><span class="line">        data = _ref.<span class="property">data</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (withNativeBlob$1 &amp;&amp; data <span class="keyword">instanceof</span> <span class="title class_">Blob</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (supportsBinary) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">callback</span>(data);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">encodeBlobAsBase64</span>(data, callback);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (withNativeArrayBuffer$2 &amp;&amp; (data <span class="keyword">instanceof</span> <span class="title class_">ArrayBuffer</span> || <span class="title function_">isView$1</span>(data))) &#123;</span><br><span class="line">      <span class="keyword">if</span> (supportsBinary) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">callback</span>(data);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">encodeBlobAsBase64</span>(<span class="keyword">new</span> <span class="title class_">Blob</span>([data]), callback);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="comment">// plain string</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="variable constant_">PACKET_TYPES</span>[type] + (data || <span class="string">&quot;&quot;</span>));</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> encodeBlobAsBase64 = <span class="keyword">function</span> <span class="title function_">encodeBlobAsBase64</span>(<span class="params">data, callback</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> fileReader = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span><br><span class="line"></span><br><span class="line">    fileReader.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> content = fileReader.<span class="property">result</span>.<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>)[<span class="number">1</span>];</span><br><span class="line">      <span class="title function_">callback</span>(<span class="string">&quot;b&quot;</span> + content);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> fileReader.<span class="title function_">readAsDataURL</span>(data);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * base64-arraybuffer 1.0.1 &lt;https://github.com/niklasvh/base64-arraybuffer&gt;</span></span><br><span class="line"><span class="comment">   * Copyright (c) 2022 Niklas von Hertzen &lt;https://hertzen.com&gt;</span></span><br><span class="line"><span class="comment">   * Released under MIT License</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">var</span> chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span>; <span class="comment">// Use a lookup table to find the index.</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> lookup$1 = <span class="keyword">typeof</span> <span class="title class_">Uint8Array</span> === <span class="string">&#x27;undefined&#x27;</span> ? [] : <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(<span class="number">256</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i$1 = <span class="number">0</span>; i$1 &lt; chars.<span class="property">length</span>; i$1++) &#123;</span><br><span class="line">    lookup$1[chars.<span class="title function_">charCodeAt</span>(i$1)] = i$1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> decode$1 = <span class="keyword">function</span> <span class="title function_">decode</span>(<span class="params">base64</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> bufferLength = base64.<span class="property">length</span> * <span class="number">0.75</span>,</span><br><span class="line">        len = base64.<span class="property">length</span>,</span><br><span class="line">        i,</span><br><span class="line">        p = <span class="number">0</span>,</span><br><span class="line">        encoded1,</span><br><span class="line">        encoded2,</span><br><span class="line">        encoded3,</span><br><span class="line">        encoded4;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (base64[base64.<span class="property">length</span> - <span class="number">1</span>] === <span class="string">&#x27;=&#x27;</span>) &#123;</span><br><span class="line">      bufferLength--;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (base64[base64.<span class="property">length</span> - <span class="number">2</span>] === <span class="string">&#x27;=&#x27;</span>) &#123;</span><br><span class="line">        bufferLength--;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> arraybuffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(bufferLength),</span><br><span class="line">        bytes = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(arraybuffer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span>) &#123;</span><br><span class="line">      encoded1 = lookup$1[base64.<span class="title function_">charCodeAt</span>(i)];</span><br><span class="line">      encoded2 = lookup$1[base64.<span class="title function_">charCodeAt</span>(i + <span class="number">1</span>)];</span><br><span class="line">      encoded3 = lookup$1[base64.<span class="title function_">charCodeAt</span>(i + <span class="number">2</span>)];</span><br><span class="line">      encoded4 = lookup$1[base64.<span class="title function_">charCodeAt</span>(i + <span class="number">3</span>)];</span><br><span class="line">      bytes[p++] = encoded1 &lt;&lt; <span class="number">2</span> | encoded2 &gt;&gt; <span class="number">4</span>;</span><br><span class="line">      bytes[p++] = (encoded2 &amp; <span class="number">15</span>) &lt;&lt; <span class="number">4</span> | encoded3 &gt;&gt; <span class="number">2</span>;</span><br><span class="line">      bytes[p++] = (encoded3 &amp; <span class="number">3</span>) &lt;&lt; <span class="number">6</span> | encoded4 &amp; <span class="number">63</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> arraybuffer;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> withNativeArrayBuffer$1 = <span class="keyword">typeof</span> <span class="title class_">ArrayBuffer</span> === <span class="string">&quot;function&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> decodePacket = <span class="keyword">function</span> <span class="title function_">decodePacket</span>(<span class="params">encodedPacket, binaryType</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> encodedPacket !== <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;message&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: <span class="title function_">mapBinary</span>(encodedPacket, binaryType)</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> type = encodedPacket.<span class="title function_">charAt</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (type === <span class="string">&quot;b&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;message&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: <span class="title function_">decodeBase64Packet</span>(encodedPacket.<span class="title function_">substring</span>(<span class="number">1</span>), binaryType)</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> packetType = <span class="variable constant_">PACKET_TYPES_REVERSE</span>[type];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!packetType) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable constant_">ERROR_PACKET</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> encodedPacket.<span class="property">length</span> &gt; <span class="number">1</span> ? &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="variable constant_">PACKET_TYPES_REVERSE</span>[type],</span><br><span class="line">      <span class="attr">data</span>: encodedPacket.<span class="title function_">substring</span>(<span class="number">1</span>)</span><br><span class="line">    &#125; : &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="variable constant_">PACKET_TYPES_REVERSE</span>[type]</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> decodeBase64Packet = <span class="keyword">function</span> <span class="title function_">decodeBase64Packet</span>(<span class="params">data, binaryType</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (withNativeArrayBuffer$1) &#123;</span><br><span class="line">      <span class="keyword">var</span> decoded = <span class="title function_">decode$1</span>(data);</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">mapBinary</span>(decoded, binaryType);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">base64</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">data</span>: data</span><br><span class="line">      &#125;; <span class="comment">// fallback for old browsers</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> mapBinary = <span class="keyword">function</span> <span class="title function_">mapBinary</span>(<span class="params">data, binaryType</span>) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (binaryType) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;blob&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> data <span class="keyword">instanceof</span> <span class="title class_">ArrayBuffer</span> ? <span class="keyword">new</span> <span class="title class_">Blob</span>([data]) : data;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;arraybuffer&quot;</span>:</span><br><span class="line">      <span class="attr">default</span>:</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">      <span class="comment">// assuming the data is already an ArrayBuffer</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="variable constant_">SEPARATOR</span> = <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">30</span>); <span class="comment">// see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> encodePayload = <span class="keyword">function</span> <span class="title function_">encodePayload</span>(<span class="params">packets, callback</span>) &#123;</span><br><span class="line">    <span class="comment">// some packets may be added to the array while encoding, so the initial length must be saved</span></span><br><span class="line">    <span class="keyword">var</span> length = packets.<span class="property">length</span>;</span><br><span class="line">    <span class="keyword">var</span> encodedPackets = <span class="keyword">new</span> <span class="title class_">Array</span>(length);</span><br><span class="line">    <span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line">    packets.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">packet, i</span>) &#123;</span><br><span class="line">      <span class="comment">// force base64 encoding for binary packets</span></span><br><span class="line">      <span class="title function_">encodePacket</span>(packet, <span class="literal">false</span>, <span class="keyword">function</span> (<span class="params">encodedPacket</span>) &#123;</span><br><span class="line">        encodedPackets[i] = encodedPacket;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (++count === length) &#123;</span><br><span class="line">          <span class="title function_">callback</span>(encodedPackets.<span class="title function_">join</span>(<span class="variable constant_">SEPARATOR</span>));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> decodePayload = <span class="keyword">function</span> <span class="title function_">decodePayload</span>(<span class="params">encodedPayload, binaryType</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> encodedPackets = encodedPayload.<span class="title function_">split</span>(<span class="variable constant_">SEPARATOR</span>);</span><br><span class="line">    <span class="keyword">var</span> packets = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; encodedPackets.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">var</span> decodedPacket = <span class="title function_">decodePacket</span>(encodedPackets[i], binaryType);</span><br><span class="line">      packets.<span class="title function_">push</span>(decodedPacket);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (decodedPacket.<span class="property">type</span> === <span class="string">&quot;error&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> packets;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> protocol$1 = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Initialize a new `Emitter`.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">Emitter</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj) <span class="keyword">return</span> <span class="title function_">mixin</span>(obj);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Mixin the emitter properties.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">obj</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> &#123;<span class="type">Object</span>&#125;</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">mixin</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>) &#123;</span><br><span class="line">      obj[key] = <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>[key];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Listen on the given `event` with `fn`.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">event</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; <span class="variable">fn</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> &#123;<span class="type">Emitter</span>&#125;</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">on</span> = <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">addEventListener</span> = <span class="keyword">function</span> (<span class="params">event, fn</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_callbacks</span> = <span class="variable language_">this</span>.<span class="property">_callbacks</span> || &#123;&#125;;</span><br><span class="line">    (<span class="variable language_">this</span>.<span class="property">_callbacks</span>[<span class="string">&#x27;$&#x27;</span> + event] = <span class="variable language_">this</span>.<span class="property">_callbacks</span>[<span class="string">&#x27;$&#x27;</span> + event] || []).<span class="title function_">push</span>(fn);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Adds an `event` listener that will be invoked a single</span></span><br><span class="line"><span class="comment">   * time then automatically removed.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">event</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; <span class="variable">fn</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> &#123;<span class="type">Emitter</span>&#125;</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">once</span> = <span class="keyword">function</span> (<span class="params">event, fn</span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">on</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">off</span>(event, on);</span><br><span class="line">      fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    on.<span class="property">fn</span> = fn;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">on</span>(event, on);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Remove the given callback for `event` or all</span></span><br><span class="line"><span class="comment">   * registered callbacks.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">event</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; <span class="variable">fn</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> &#123;<span class="type">Emitter</span>&#125;</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">off</span> = <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">removeListener</span> = <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">removeAllListeners</span> = <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">removeEventListener</span> = <span class="keyword">function</span> (<span class="params">event, fn</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_callbacks</span> = <span class="variable language_">this</span>.<span class="property">_callbacks</span> || &#123;&#125;; <span class="comment">// all</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0</span> == <span class="variable language_">arguments</span>.<span class="property">length</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">_callbacks</span> = &#123;&#125;;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">    &#125; <span class="comment">// specific event</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> callbacks = <span class="variable language_">this</span>.<span class="property">_callbacks</span>[<span class="string">&#x27;$&#x27;</span> + event];</span><br><span class="line">    <span class="keyword">if</span> (!callbacks) <span class="keyword">return</span> <span class="variable language_">this</span>; <span class="comment">// remove all handlers</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="number">1</span> == <span class="variable language_">arguments</span>.<span class="property">length</span>) &#123;</span><br><span class="line">      <span class="keyword">delete</span> <span class="variable language_">this</span>.<span class="property">_callbacks</span>[<span class="string">&#x27;$&#x27;</span> + event];</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">    &#125; <span class="comment">// remove specific handler</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> cb;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; callbacks.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      cb = callbacks[i];</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (cb === fn || cb.<span class="property">fn</span> === fn) &#123;</span><br><span class="line">        callbacks.<span class="title function_">splice</span>(i, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="comment">// Remove event specific arrays for event types that no</span></span><br><span class="line">    <span class="comment">// one is subscribed for to avoid memory leak.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (callbacks.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">delete</span> <span class="variable language_">this</span>.<span class="property">_callbacks</span>[<span class="string">&#x27;$&#x27;</span> + event];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Emit `event` with the given args.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">event</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Mixed</span>&#125; ...</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> &#123;<span class="type">Emitter</span>&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">emit</span> = <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_callbacks</span> = <span class="variable language_">this</span>.<span class="property">_callbacks</span> || &#123;&#125;;</span><br><span class="line">    <span class="keyword">var</span> args = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="variable language_">arguments</span>.<span class="property">length</span> - <span class="number">1</span>),</span><br><span class="line">        callbacks = <span class="variable language_">this</span>.<span class="property">_callbacks</span>[<span class="string">&#x27;$&#x27;</span> + event];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      args[i - <span class="number">1</span>] = <span class="variable language_">arguments</span>[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (callbacks) &#123;</span><br><span class="line">      callbacks = callbacks.<span class="title function_">slice</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = callbacks.<span class="property">length</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        callbacks[i].<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;; <span class="comment">// alias used for reserved events (protected method)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">emitReserved</span> = <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">emit</span>;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Return array of callbacks for `event`.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">event</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> &#123;<span class="type">Array</span>&#125;</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">listeners</span> = <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_callbacks</span> = <span class="variable language_">this</span>.<span class="property">_callbacks</span> || &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_callbacks</span>[<span class="string">&#x27;$&#x27;</span> + event] || [];</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Check if this emitter has `event` handlers.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">event</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> &#123;<span class="type">Boolean</span>&#125;</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Emitter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasListeners</span> = <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> !!<span class="variable language_">this</span>.<span class="title function_">listeners</span>(event).<span class="property">length</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> globalThis = (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> self !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> self;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">window</span> !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">window</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Function</span>(<span class="string">&quot;return this&quot;</span>)();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">pick</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> _len = <span class="variable language_">arguments</span>.<span class="property">length</span>, attr = <span class="keyword">new</span> <span class="title class_">Array</span>(_len &gt; <span class="number">1</span> ? _len - <span class="number">1</span> : <span class="number">0</span>), _key = <span class="number">1</span>; _key &lt; _len; _key++) &#123;</span><br><span class="line">      attr[_key - <span class="number">1</span>] = <span class="variable language_">arguments</span>[_key];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> attr.<span class="title function_">reduce</span>(<span class="keyword">function</span> (<span class="params">acc, k</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (obj.<span class="title function_">hasOwnProperty</span>(k)) &#123;</span><br><span class="line">        acc[k] = obj[k];</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> acc;</span><br><span class="line">    &#125;, &#123;&#125;);</span><br><span class="line">  &#125; <span class="comment">// Keep a reference to the real timeout functions so they can be used when overridden</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="variable constant_">NATIVE_SET_TIMEOUT</span> = <span class="built_in">setTimeout</span>;</span><br><span class="line">  <span class="keyword">var</span> <span class="variable constant_">NATIVE_CLEAR_TIMEOUT</span> = <span class="built_in">clearTimeout</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">installTimerFunctions</span>(<span class="params">obj, opts</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (opts.<span class="property">useNativeTimers</span>) &#123;</span><br><span class="line">      obj.<span class="property">setTimeoutFn</span> = <span class="variable constant_">NATIVE_SET_TIMEOUT</span>.<span class="title function_">bind</span>(globalThis);</span><br><span class="line">      obj.<span class="property">clearTimeoutFn</span> = <span class="variable constant_">NATIVE_CLEAR_TIMEOUT</span>.<span class="title function_">bind</span>(globalThis);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      obj.<span class="property">setTimeoutFn</span> = <span class="built_in">setTimeout</span>.<span class="title function_">bind</span>(globalThis);</span><br><span class="line">      obj.<span class="property">clearTimeoutFn</span> = <span class="built_in">clearTimeout</span>.<span class="title function_">bind</span>(globalThis);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="comment">// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">BASE64</span>_OVERHEAD = <span class="number">1.33</span>; <span class="comment">// we could also have used `new Blob([obj]).size`, but it isn&#x27;t supported in IE9</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">byteLength</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> obj === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">utf8Length</span>(obj);</span><br><span class="line">    &#125; <span class="comment">// arraybuffer or blob</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">ceil</span>((obj.<span class="property">byteLength</span> || obj.<span class="property">size</span>) * <span class="title class_">BASE64</span>_OVERHEAD);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">utf8Length</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> c = <span class="number">0</span>,</span><br><span class="line">        length = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = str.<span class="property">length</span>; i &lt; l; i++) &#123;</span><br><span class="line">      c = str.<span class="title function_">charCodeAt</span>(i);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (c &lt; <span class="number">0x80</span>) &#123;</span><br><span class="line">        length += <span class="number">1</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c &lt; <span class="number">0x800</span>) &#123;</span><br><span class="line">        length += <span class="number">2</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c &lt; <span class="number">0xd800</span> || c &gt;= <span class="number">0xe000</span>) &#123;</span><br><span class="line">        length += <span class="number">3</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        i++;</span><br><span class="line">        length += <span class="number">4</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> length;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">TransportError</span> = <span class="comment">/*#__PURE__*/</span><span class="keyword">function</span> (<span class="params">_Error</span>) &#123;</span><br><span class="line">    <span class="title function_">_inherits</span>(<span class="title class_">TransportError</span>, _Error);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> _super = <span class="title function_">_createSuper</span>(<span class="title class_">TransportError</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">TransportError</span>(<span class="params">reason, description, context</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> _this;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">_classCallCheck</span>(<span class="variable language_">this</span>, <span class="title class_">TransportError</span>);</span><br><span class="line"></span><br><span class="line">      _this = _super.<span class="title function_">call</span>(<span class="variable language_">this</span>, reason);</span><br><span class="line">      _this.<span class="property">description</span> = description;</span><br><span class="line">      _this.<span class="property">context</span> = context;</span><br><span class="line">      _this.<span class="property">type</span> = <span class="string">&quot;TransportError&quot;</span>;</span><br><span class="line">      <span class="keyword">return</span> _this;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">TransportError</span>;</span><br><span class="line">  &#125;( <span class="comment">/*#__PURE__*/</span><span class="title function_">_wrapNativeSuper</span>(<span class="title class_">Error</span>));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">Transport</span> = <span class="comment">/*#__PURE__*/</span><span class="keyword">function</span> (<span class="params">_Emitter</span>) &#123;</span><br><span class="line">    <span class="title function_">_inherits</span>(<span class="title class_">Transport</span>, _Emitter);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> _super2 = <span class="title function_">_createSuper</span>(<span class="title class_">Transport</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Transport abstract constructor.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; options.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Transport</span>(<span class="params">opts</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> _this2;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">_classCallCheck</span>(<span class="variable language_">this</span>, <span class="title class_">Transport</span>);</span><br><span class="line"></span><br><span class="line">      _this2 = _super2.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">      _this2.<span class="property">writable</span> = <span class="literal">false</span>;</span><br><span class="line">      <span class="title function_">installTimerFunctions</span>(<span class="title function_">_assertThisInitialized</span>(_this2), opts);</span><br><span class="line">      _this2.<span class="property">opts</span> = opts;</span><br><span class="line">      _this2.<span class="property">query</span> = opts.<span class="property">query</span>;</span><br><span class="line">      _this2.<span class="property">readyState</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">      _this2.<span class="property">socket</span> = opts.<span class="property">socket</span>;</span><br><span class="line">      <span class="keyword">return</span> _this2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Emits an error.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">reason</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> <span class="variable">description</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> <span class="variable">context</span> - the error context</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="type">Transport</span>&#125; for chaining</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@api</span> <span class="variable">protected</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">_createClass</span>(<span class="title class_">Transport</span>, [&#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onError&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onError</span>(<span class="params">reason, description, context</span>) &#123;</span><br><span class="line">        <span class="title function_">_get</span>(<span class="title function_">_getPrototypeOf</span>(<span class="title class_">Transport</span>.<span class="property"><span class="keyword">prototype</span></span>), <span class="string">&quot;emitReserved&quot;</span>, <span class="variable language_">this</span>).<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="string">&quot;error&quot;</span>, <span class="keyword">new</span> <span class="title class_">TransportError</span>(reason, description, context));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Opens the transport.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;open&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">open</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;closed&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span> || <span class="string">&quot;&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">readyState</span> = <span class="string">&quot;opening&quot;</span>;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">doOpen</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Closes the transport.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;close&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">close</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;opening&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span> || <span class="string">&quot;open&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">doClose</span>();</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">onClose</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Sends multiple packets.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; <span class="variable">packets</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;send&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">send</span>(<span class="params">packets</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;open&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">write</span>(packets);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon open</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">protected</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onOpen&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onOpen</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">readyState</span> = <span class="string">&quot;open&quot;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">writable</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">_get</span>(<span class="title function_">_getPrototypeOf</span>(<span class="title class_">Transport</span>.<span class="property"><span class="keyword">prototype</span></span>), <span class="string">&quot;emitReserved&quot;</span>, <span class="variable language_">this</span>).<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="string">&quot;open&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called with data.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">data</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">protected</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onData&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onData</span>(<span class="params">data</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> packet = <span class="title function_">decodePacket</span>(data, <span class="variable language_">this</span>.<span class="property">socket</span>.<span class="property">binaryType</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">onPacket</span>(packet);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called with a decoded packet.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">protected</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onPacket&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onPacket</span>(<span class="params">packet</span>) &#123;</span><br><span class="line">        <span class="title function_">_get</span>(<span class="title function_">_getPrototypeOf</span>(<span class="title class_">Transport</span>.<span class="property"><span class="keyword">prototype</span></span>), <span class="string">&quot;emitReserved&quot;</span>, <span class="variable language_">this</span>).<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="string">&quot;packet&quot;</span>, packet);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon close.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">protected</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onClose&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onClose</span>(<span class="params">details</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">readyState</span> = <span class="string">&quot;closed&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">_get</span>(<span class="title function_">_getPrototypeOf</span>(<span class="title class_">Transport</span>.<span class="property"><span class="keyword">prototype</span></span>), <span class="string">&quot;emitReserved&quot;</span>, <span class="variable language_">this</span>).<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="string">&quot;close&quot;</span>, details);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Transport</span>;</span><br><span class="line">  &#125;(<span class="title class_">Emitter</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// imported from https://github.com/unshiftio/yeast</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> alphabet = <span class="string">&#x27;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_&#x27;</span>.<span class="title function_">split</span>(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">      length = <span class="number">64</span>,</span><br><span class="line">      map = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> seed = <span class="number">0</span>,</span><br><span class="line">      i = <span class="number">0</span>,</span><br><span class="line">      prev;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Return a string representing the specified number.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Number</span>&#125; num The number to convert.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> &#123;<span class="type">String</span>&#125; The string representation of the number.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">encode$1</span>(<span class="params">num</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> encoded = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">      encoded = alphabet[num % length] + encoded;</span><br><span class="line">      num = <span class="title class_">Math</span>.<span class="title function_">floor</span>(num / length);</span><br><span class="line">    &#125; <span class="keyword">while</span> (num &gt; <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> encoded;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Yeast: A tiny growing id generator.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> &#123;<span class="type">String</span>&#125; A unique id.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">yeast</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> now = <span class="title function_">encode$1</span>(+<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    <span class="keyword">if</span> (now !== prev) <span class="keyword">return</span> seed = <span class="number">0</span>, prev = now;</span><br><span class="line">    <span class="keyword">return</span> now + <span class="string">&#x27;.&#x27;</span> + <span class="title function_">encode$1</span>(seed++);</span><br><span class="line">  &#125; <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Map each character to its index.</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (; i &lt; length; i++) &#123;</span><br><span class="line">    map[alphabet[i]] = i;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// imported from https://github.com/galkn/querystring</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Compiles a querystring</span></span><br><span class="line"><span class="comment">   * Returns string representation of the object</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125;</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">encode</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> obj) &#123;</span><br><span class="line">      <span class="keyword">if</span> (obj.<span class="title function_">hasOwnProperty</span>(i)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (str.<span class="property">length</span>) str += <span class="string">&#x27;&amp;&#x27;</span>;</span><br><span class="line">        str += <span class="built_in">encodeURIComponent</span>(i) + <span class="string">&#x27;=&#x27;</span> + <span class="built_in">encodeURIComponent</span>(obj[i]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Parses a simple querystring into an object</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">qs</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">decode</span>(<span class="params">qs</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> qry = &#123;&#125;;</span><br><span class="line">    <span class="keyword">var</span> pairs = qs.<span class="title function_">split</span>(<span class="string">&#x27;&amp;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = pairs.<span class="property">length</span>; i &lt; l; i++) &#123;</span><br><span class="line">      <span class="keyword">var</span> pair = pairs[i].<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>);</span><br><span class="line">      qry[<span class="built_in">decodeURIComponent</span>(pair[<span class="number">0</span>])] = <span class="built_in">decodeURIComponent</span>(pair[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> qry;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// imported from https://github.com/component/has-cors</span></span><br><span class="line">  <span class="keyword">var</span> value = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    value = <span class="keyword">typeof</span> <span class="title class_">XMLHttpRequest</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="string">&#x27;withCredentials&#x27;</span> <span class="keyword">in</span> <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;<span class="comment">// if XMLHttp support is disabled in IE then it will throw</span></span><br><span class="line">    <span class="comment">// when trying to create</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> hasCORS = value;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// browser shim for xmlhttprequest module</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">XMLHttpRequest$1</span> (<span class="params">opts</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> xdomain = opts.<span class="property">xdomain</span>; <span class="comment">// XMLHttpRequest can be disabled on IE</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="string">&quot;undefined&quot;</span> !== <span class="keyword">typeof</span> <span class="title class_">XMLHttpRequest</span> &amp;&amp; (!xdomain || hasCORS)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!xdomain) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> globalThis[[<span class="string">&quot;Active&quot;</span>].<span class="title function_">concat</span>(<span class="string">&quot;Object&quot;</span>).<span class="title function_">join</span>(<span class="string">&quot;X&quot;</span>)](<span class="string">&quot;Microsoft.XMLHTTP&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">empty</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> hasXHR2 = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>$1(&#123;</span><br><span class="line">      <span class="attr">xdomain</span>: <span class="literal">false</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span> != xhr.<span class="property">responseType</span>;</span><br><span class="line">  &#125;();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">Polling</span> = <span class="comment">/*#__PURE__*/</span><span class="keyword">function</span> (<span class="params">_Transport</span>) &#123;</span><br><span class="line">    <span class="title function_">_inherits</span>(<span class="title class_">Polling</span>, _Transport);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> _super = <span class="title function_">_createSuper</span>(<span class="title class_">Polling</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * XHR Polling constructor.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">opts</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Polling</span>(<span class="params">opts</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> _this;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">_classCallCheck</span>(<span class="variable language_">this</span>, <span class="title class_">Polling</span>);</span><br><span class="line"></span><br><span class="line">      _this = _super.<span class="title function_">call</span>(<span class="variable language_">this</span>, opts);</span><br><span class="line">      _this.<span class="property">polling</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> location !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> isSSL = <span class="string">&quot;https:&quot;</span> === location.<span class="property">protocol</span>;</span><br><span class="line">        <span class="keyword">var</span> port = location.<span class="property">port</span>; <span class="comment">// some user agents have empty `location.port`</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!port) &#123;</span><br><span class="line">          port = isSSL ? <span class="string">&quot;443&quot;</span> : <span class="string">&quot;80&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        _this.<span class="property">xd</span> = <span class="keyword">typeof</span> location !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; opts.<span class="property">hostname</span> !== location.<span class="property">hostname</span> || port !== opts.<span class="property">port</span>;</span><br><span class="line">        _this.<span class="property">xs</span> = opts.<span class="property">secure</span> !== isSSL;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * XHR supports binary</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> forceBase64 = opts &amp;&amp; opts.<span class="property">forceBase64</span>;</span><br><span class="line">      _this.<span class="property">supportsBinary</span> = hasXHR2 &amp;&amp; !forceBase64;</span><br><span class="line">      <span class="keyword">return</span> _this;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Transport name.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">_createClass</span>(<span class="title class_">Polling</span>, [&#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;name&quot;</span>,</span><br><span class="line">      <span class="attr">get</span>: <span class="keyword">function</span> <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;polling&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Opens the socket (triggers polling). We write a PING message to determine</span></span><br><span class="line"><span class="comment">       * when the transport is open.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;doOpen&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">doOpen</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">poll</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Pauses polling.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; callback upon buffers are flushed and transport is paused</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;pause&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">pause</span>(<span class="params">onPause</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this2 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">readyState</span> = <span class="string">&quot;pausing&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> pause = <span class="keyword">function</span> <span class="title function_">pause</span>(<span class="params"></span>) &#123;</span><br><span class="line">          _this2.<span class="property">readyState</span> = <span class="string">&quot;paused&quot;</span>;</span><br><span class="line">          <span class="title function_">onPause</span>();</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">polling</span> || !<span class="variable language_">this</span>.<span class="property">writable</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> total = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">polling</span>) &#123;</span><br><span class="line">            total++;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">once</span>(<span class="string">&quot;pollComplete&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">              --total || <span class="title function_">pause</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">writable</span>) &#123;</span><br><span class="line">            total++;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">once</span>(<span class="string">&quot;drain&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">              --total || <span class="title function_">pause</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">pause</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Starts polling cycle.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;poll&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">poll</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">polling</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">doPoll</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;poll&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Overloads onData to detect payloads.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onData&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onData</span>(<span class="params">data</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this3 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> callback = <span class="keyword">function</span> <span class="title function_">callback</span>(<span class="params">packet</span>) &#123;</span><br><span class="line">          <span class="comment">// if its the first message we consider the transport open</span></span><br><span class="line">          <span class="keyword">if</span> (<span class="string">&quot;opening&quot;</span> === _this3.<span class="property">readyState</span> &amp;&amp; packet.<span class="property">type</span> === <span class="string">&quot;open&quot;</span>) &#123;</span><br><span class="line">            _this3.<span class="title function_">onOpen</span>();</span><br><span class="line">          &#125; <span class="comment">// if its a close packet, we close the ongoing requests</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (<span class="string">&quot;close&quot;</span> === packet.<span class="property">type</span>) &#123;</span><br><span class="line">            _this3.<span class="title function_">onClose</span>(&#123;</span><br><span class="line">              <span class="attr">description</span>: <span class="string">&quot;transport closed by the server&quot;</span></span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">          &#125; <span class="comment">// otherwise bypass onData and handle the message</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          _this3.<span class="title function_">onPacket</span>(packet);</span><br><span class="line">        &#125;; <span class="comment">// decode payload</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="title function_">decodePayload</span>(data, <span class="variable language_">this</span>.<span class="property">socket</span>.<span class="property">binaryType</span>).<span class="title function_">forEach</span>(callback); <span class="comment">// if an event did not trigger closing</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;closed&quot;</span> !== <span class="variable language_">this</span>.<span class="property">readyState</span>) &#123;</span><br><span class="line">          <span class="comment">// if we got data we&#x27;re not polling</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">polling</span> = <span class="literal">false</span>;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;pollComplete&quot;</span>);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (<span class="string">&quot;open&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">poll</span>();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * For polling, send a close packet.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;doClose&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">doClose</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this4 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> close = <span class="keyword">function</span> <span class="title function_">close</span>(<span class="params"></span>) &#123;</span><br><span class="line">          _this4.<span class="title function_">write</span>([&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;close&quot;</span></span><br><span class="line">          &#125;]);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;open&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span>) &#123;</span><br><span class="line">          <span class="title function_">close</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// in case we&#x27;re trying to close while</span></span><br><span class="line">          <span class="comment">// handshaking is in progress (GH-164)</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">once</span>(<span class="string">&quot;open&quot;</span>, close);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Writes a packets payload.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; data packets</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; drain callback</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;write&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">write</span>(<span class="params">packets</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this5 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">writable</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="title function_">encodePayload</span>(packets, <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">          _this5.<span class="title function_">doWrite</span>(data, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            _this5.<span class="property">writable</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">            _this5.<span class="title function_">emitReserved</span>(<span class="string">&quot;drain&quot;</span>);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Generates uri for connection.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;uri&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">uri</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> query = <span class="variable language_">this</span>.<span class="property">query</span> || &#123;&#125;;</span><br><span class="line">        <span class="keyword">var</span> schema = <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">secure</span> ? <span class="string">&quot;https&quot;</span> : <span class="string">&quot;http&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> port = <span class="string">&quot;&quot;</span>; <span class="comment">// cache busting is forced</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">false</span> !== <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">timestampRequests</span>) &#123;</span><br><span class="line">          query[<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">timestampParam</span>] = <span class="title function_">yeast</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">supportsBinary</span> &amp;&amp; !query.<span class="property">sid</span>) &#123;</span><br><span class="line">          query.<span class="property">b64</span> = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="comment">// avoid port if default for schema</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">port</span> &amp;&amp; (<span class="string">&quot;https&quot;</span> === schema &amp;&amp; <span class="title class_">Number</span>(<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">port</span>) !== <span class="number">443</span> || <span class="string">&quot;http&quot;</span> === schema &amp;&amp; <span class="title class_">Number</span>(<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">port</span>) !== <span class="number">80</span>)) &#123;</span><br><span class="line">          port = <span class="string">&quot;:&quot;</span> + <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">port</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> encodedQuery = <span class="title function_">encode</span>(query);</span><br><span class="line">        <span class="keyword">var</span> ipv6 = <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">hostname</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;:&quot;</span>) !== -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> schema + <span class="string">&quot;://&quot;</span> + (ipv6 ? <span class="string">&quot;[&quot;</span> + <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">hostname</span> + <span class="string">&quot;]&quot;</span> : <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">hostname</span>) + port + <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">path</span> + (encodedQuery.<span class="property">length</span> ? <span class="string">&quot;?&quot;</span> + encodedQuery : <span class="string">&quot;&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Creates a request.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">method</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;request&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">request</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> opts = <span class="variable language_">arguments</span>.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable language_">arguments</span>[<span class="number">0</span>] !== <span class="literal">undefined</span> ? <span class="variable language_">arguments</span>[<span class="number">0</span>] : &#123;&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">_extends</span>(opts, &#123;</span><br><span class="line">          <span class="attr">xd</span>: <span class="variable language_">this</span>.<span class="property">xd</span>,</span><br><span class="line">          <span class="attr">xs</span>: <span class="variable language_">this</span>.<span class="property">xs</span></span><br><span class="line">        &#125;, <span class="variable language_">this</span>.<span class="property">opts</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Request</span>(<span class="variable language_">this</span>.<span class="title function_">uri</span>(), opts);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Sends data.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; data to send.</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; called upon flush.</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;doWrite&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">doWrite</span>(<span class="params">data, fn</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this6 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> req = <span class="variable language_">this</span>.<span class="title function_">request</span>(&#123;</span><br><span class="line">          <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">          <span class="attr">data</span>: data</span><br><span class="line">        &#125;);</span><br><span class="line">        req.<span class="title function_">on</span>(<span class="string">&quot;success&quot;</span>, fn);</span><br><span class="line">        req.<span class="title function_">on</span>(<span class="string">&quot;error&quot;</span>, <span class="keyword">function</span> (<span class="params">xhrStatus, context</span>) &#123;</span><br><span class="line">          _this6.<span class="title function_">onError</span>(<span class="string">&quot;xhr post error&quot;</span>, xhrStatus, context);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Starts a poll cycle.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;doPoll&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">doPoll</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this7 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> req = <span class="variable language_">this</span>.<span class="title function_">request</span>();</span><br><span class="line">        req.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="variable language_">this</span>.<span class="property">onData</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>));</span><br><span class="line">        req.<span class="title function_">on</span>(<span class="string">&quot;error&quot;</span>, <span class="keyword">function</span> (<span class="params">xhrStatus, context</span>) &#123;</span><br><span class="line">          _this7.<span class="title function_">onError</span>(<span class="string">&quot;xhr poll error&quot;</span>, xhrStatus, context);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">pollXhr</span> = req;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Polling</span>;</span><br><span class="line">  &#125;(<span class="title class_">Transport</span>);</span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">Request</span> = <span class="comment">/*#__PURE__*/</span><span class="keyword">function</span> (<span class="params">_Emitter</span>) &#123;</span><br><span class="line">    <span class="title function_">_inherits</span>(<span class="title class_">Request</span>, _Emitter);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> _super2 = <span class="title function_">_createSuper</span>(<span class="title class_">Request</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Request constructor</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">options</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Request</span>(<span class="params">uri, opts</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> _this8;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">_classCallCheck</span>(<span class="variable language_">this</span>, <span class="title class_">Request</span>);</span><br><span class="line"></span><br><span class="line">      _this8 = _super2.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">      <span class="title function_">installTimerFunctions</span>(<span class="title function_">_assertThisInitialized</span>(_this8), opts);</span><br><span class="line">      _this8.<span class="property">opts</span> = opts;</span><br><span class="line">      _this8.<span class="property">method</span> = opts.<span class="property">method</span> || <span class="string">&quot;GET&quot;</span>;</span><br><span class="line">      _this8.<span class="property">uri</span> = uri;</span><br><span class="line">      _this8.<span class="property">async</span> = <span class="literal">false</span> !== opts.<span class="property">async</span>;</span><br><span class="line">      _this8.<span class="property">data</span> = <span class="literal">undefined</span> !== opts.<span class="property">data</span> ? opts.<span class="property">data</span> : <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">      _this8.<span class="title function_">create</span>();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> _this8;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Creates the XHR object and sends the request.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">_createClass</span>(<span class="title class_">Request</span>, [&#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;create&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">create</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this9 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> opts = <span class="title function_">pick</span>(<span class="variable language_">this</span>.<span class="property">opts</span>, <span class="string">&quot;agent&quot;</span>, <span class="string">&quot;pfx&quot;</span>, <span class="string">&quot;key&quot;</span>, <span class="string">&quot;passphrase&quot;</span>, <span class="string">&quot;cert&quot;</span>, <span class="string">&quot;ca&quot;</span>, <span class="string">&quot;ciphers&quot;</span>, <span class="string">&quot;rejectUnauthorized&quot;</span>, <span class="string">&quot;autoUnref&quot;</span>);</span><br><span class="line">        opts.<span class="property">xdomain</span> = !!<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">xd</span>;</span><br><span class="line">        opts.<span class="property">xscheme</span> = !!<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">xs</span>;</span><br><span class="line">        <span class="keyword">var</span> xhr = <span class="variable language_">this</span>.<span class="property">xhr</span> = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>$1(opts);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          xhr.<span class="title function_">open</span>(<span class="variable language_">this</span>.<span class="property">method</span>, <span class="variable language_">this</span>.<span class="property">uri</span>, <span class="variable language_">this</span>.<span class="property">async</span>);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">extraHeaders</span>) &#123;</span><br><span class="line">              xhr.<span class="property">setDisableHeaderCheck</span> &amp;&amp; xhr.<span class="title function_">setDisableHeaderCheck</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">extraHeaders</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">extraHeaders</span>.<span class="title function_">hasOwnProperty</span>(i)) &#123;</span><br><span class="line">                  xhr.<span class="title function_">setRequestHeader</span>(i, <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">extraHeaders</span>[i]);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (<span class="string">&quot;POST&quot;</span> === <span class="variable language_">this</span>.<span class="property">method</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">              xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-type&quot;</span>, <span class="string">&quot;text/plain;charset=UTF-8&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Accept&quot;</span>, <span class="string">&quot;*/*&quot;</span>);</span><br><span class="line">          &#125; <span class="keyword">catch</span> (e) &#123;&#125; <span class="comment">// ie6 check</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (<span class="string">&quot;withCredentials&quot;</span> <span class="keyword">in</span> xhr) &#123;</span><br><span class="line">            xhr.<span class="property">withCredentials</span> = <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">withCredentials</span>;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">requestTimeout</span>) &#123;</span><br><span class="line">            xhr.<span class="property">timeout</span> = <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">requestTimeout</span>;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">4</span> !== xhr.<span class="property">readyState</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="number">200</span> === xhr.<span class="property">status</span> || <span class="number">1223</span> === xhr.<span class="property">status</span>) &#123;</span><br><span class="line">              _this9.<span class="title function_">onLoad</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="comment">// make sure the `error` event handler that&#x27;s user-set</span></span><br><span class="line">              <span class="comment">// does not throw in the same tick and gets caught here</span></span><br><span class="line">              _this9.<span class="title function_">setTimeoutFn</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                _this9.<span class="title function_">onError</span>(<span class="keyword">typeof</span> xhr.<span class="property">status</span> === <span class="string">&quot;number&quot;</span> ? xhr.<span class="property">status</span> : <span class="number">0</span>);</span><br><span class="line">              &#125;, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;;</span><br><span class="line"></span><br><span class="line">          xhr.<span class="title function_">send</span>(<span class="variable language_">this</span>.<span class="property">data</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          <span class="comment">// Need to defer since .create() is called directly from the constructor</span></span><br><span class="line">          <span class="comment">// and thus the &#x27;error&#x27; event can only be only bound *after* this exception</span></span><br><span class="line">          <span class="comment">// occurs.  Therefore, also, we cannot throw here at all.</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">setTimeoutFn</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            _this9.<span class="title function_">onError</span>(e);</span><br><span class="line">          &#125;, <span class="number">0</span>);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">document</span> !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">index</span> = <span class="title class_">Request</span>.<span class="property">requestsCount</span>++;</span><br><span class="line">          <span class="title class_">Request</span>.<span class="property">requests</span>[<span class="variable language_">this</span>.<span class="property">index</span>] = <span class="variable language_">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon error.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onError&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onError</span>(<span class="params">err</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;error&quot;</span>, err, <span class="variable language_">this</span>.<span class="property">xhr</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">cleanup</span>(<span class="literal">true</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Cleans up house.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;cleanup&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">cleanup</span>(<span class="params">fromError</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;undefined&quot;</span> === <span class="keyword">typeof</span> <span class="variable language_">this</span>.<span class="property">xhr</span> || <span class="literal">null</span> === <span class="variable language_">this</span>.<span class="property">xhr</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">xhr</span>.<span class="property">onreadystatechange</span> = empty;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (fromError) &#123;</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">xhr</span>.<span class="title function_">abort</span>();</span><br><span class="line">          &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">document</span> !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">          <span class="keyword">delete</span> <span class="title class_">Request</span>.<span class="property">requests</span>[<span class="variable language_">this</span>.<span class="property">index</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">xhr</span> = <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon load.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onLoad&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onLoad</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> data = <span class="variable language_">this</span>.<span class="property">xhr</span>.<span class="property">responseText</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (data !== <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;data&quot;</span>, data);</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">cleanup</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Aborts the request.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;abort&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">abort</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">cleanup</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Request</span>;</span><br><span class="line">  &#125;(<span class="title class_">Emitter</span>);</span><br><span class="line">  <span class="title class_">Request</span>.<span class="property">requestsCount</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="title class_">Request</span>.<span class="property">requests</span> = &#123;&#125;;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Aborts pending requests when unloading the window. This is needed to prevent</span></span><br><span class="line"><span class="comment">   * memory leaks (e.g. when using IE) and to ensure that no spurious error is</span></span><br><span class="line"><span class="comment">   * emitted.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">document</span> !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">    <span class="comment">// @ts-ignore</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> attachEvent === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">      <span class="comment">// @ts-ignore</span></span><br><span class="line">      <span class="title function_">attachEvent</span>(<span class="string">&quot;onunload&quot;</span>, unloadHandler);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> addEventListener === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> terminationEvent = <span class="string">&quot;onpagehide&quot;</span> <span class="keyword">in</span> globalThis ? <span class="string">&quot;pagehide&quot;</span> : <span class="string">&quot;unload&quot;</span>;</span><br><span class="line">      <span class="title function_">addEventListener</span>(terminationEvent, unloadHandler, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">unloadHandler</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> <span class="title class_">Request</span>.<span class="property">requests</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Request</span>.<span class="property">requests</span>.<span class="title function_">hasOwnProperty</span>(i)) &#123;</span><br><span class="line">        <span class="title class_">Request</span>.<span class="property">requests</span>[i].<span class="title function_">abort</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> nextTick = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> isPromiseAvailable = <span class="keyword">typeof</span> <span class="title class_">Promise</span> === <span class="string">&quot;function&quot;</span> &amp;&amp; <span class="keyword">typeof</span> <span class="title class_">Promise</span>.<span class="property">resolve</span> === <span class="string">&quot;function&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isPromiseAvailable) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">cb</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(cb);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">cb, setTimeoutFn</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">setTimeoutFn</span>(cb, <span class="number">0</span>);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;();</span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">WebSocket</span> = globalThis.<span class="property">WebSocket</span> || globalThis.<span class="property">MozWebSocket</span>;</span><br><span class="line">  <span class="keyword">var</span> usingBrowserWebSocket = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">var</span> defaultBinaryType = <span class="string">&quot;arraybuffer&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> isReactNative = <span class="keyword">typeof</span> navigator !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; <span class="keyword">typeof</span> navigator.<span class="property">product</span> === <span class="string">&quot;string&quot;</span> &amp;&amp; navigator.<span class="property">product</span>.<span class="title function_">toLowerCase</span>() === <span class="string">&quot;reactnative&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> <span class="variable constant_">WS</span> = <span class="comment">/*#__PURE__*/</span><span class="keyword">function</span> (<span class="params">_Transport</span>) &#123;</span><br><span class="line">    <span class="title function_">_inherits</span>(<span class="variable constant_">WS</span>, _Transport);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> _super = <span class="title function_">_createSuper</span>(<span class="variable constant_">WS</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * WebSocket transport constructor.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@api</span> &#123;<span class="type">Object</span>&#125; connection options</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">WS</span>(<span class="params">opts</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> _this;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">_classCallCheck</span>(<span class="variable language_">this</span>, <span class="variable constant_">WS</span>);</span><br><span class="line"></span><br><span class="line">      _this = _super.<span class="title function_">call</span>(<span class="variable language_">this</span>, opts);</span><br><span class="line">      _this.<span class="property">supportsBinary</span> = !opts.<span class="property">forceBase64</span>;</span><br><span class="line">      <span class="keyword">return</span> _this;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Transport name.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">_createClass</span>(<span class="variable constant_">WS</span>, [&#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;name&quot;</span>,</span><br><span class="line">      <span class="attr">get</span>: <span class="keyword">function</span> <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;websocket&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Opens socket.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;doOpen&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">doOpen</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="title function_">check</span>()) &#123;</span><br><span class="line">          <span class="comment">// let probe timeout</span></span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> uri = <span class="variable language_">this</span>.<span class="title function_">uri</span>();</span><br><span class="line">        <span class="keyword">var</span> protocols = <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">protocols</span>; <span class="comment">// React Native only supports the &#x27;headers&#x27; option, and will print a warning if anything else is passed</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> opts = isReactNative ? &#123;&#125; : <span class="title function_">pick</span>(<span class="variable language_">this</span>.<span class="property">opts</span>, <span class="string">&quot;agent&quot;</span>, <span class="string">&quot;perMessageDeflate&quot;</span>, <span class="string">&quot;pfx&quot;</span>, <span class="string">&quot;key&quot;</span>, <span class="string">&quot;passphrase&quot;</span>, <span class="string">&quot;cert&quot;</span>, <span class="string">&quot;ca&quot;</span>, <span class="string">&quot;ciphers&quot;</span>, <span class="string">&quot;rejectUnauthorized&quot;</span>, <span class="string">&quot;localAddress&quot;</span>, <span class="string">&quot;protocolVersion&quot;</span>, <span class="string">&quot;origin&quot;</span>, <span class="string">&quot;maxPayload&quot;</span>, <span class="string">&quot;family&quot;</span>, <span class="string">&quot;checkServerIdentity&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">extraHeaders</span>) &#123;</span><br><span class="line">          opts.<span class="property">headers</span> = <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">extraHeaders</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">ws</span> = usingBrowserWebSocket &amp;&amp; !isReactNative ? protocols ? <span class="keyword">new</span> <span class="title class_">WebSocket</span>(uri, protocols) : <span class="keyword">new</span> <span class="title class_">WebSocket</span>(uri) : <span class="keyword">new</span> <span class="title class_">WebSocket</span>(uri, protocols, opts);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;error&quot;</span>, err);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">ws</span>.<span class="property">binaryType</span> = <span class="variable language_">this</span>.<span class="property">socket</span>.<span class="property">binaryType</span> || defaultBinaryType;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">addEventListeners</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Adds event listeners to the socket</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;addEventListeners&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">addEventListeners</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this2 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">ws</span>.<span class="property">onopen</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (_this2.<span class="property">opts</span>.<span class="property">autoUnref</span>) &#123;</span><br><span class="line">            _this2.<span class="property">ws</span>.<span class="property">_socket</span>.<span class="title function_">unref</span>();</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          _this2.<span class="title function_">onOpen</span>();</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">ws</span>.<span class="property">onclose</span> = <span class="keyword">function</span> (<span class="params">closeEvent</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> _this2.<span class="title function_">onClose</span>(&#123;</span><br><span class="line">            <span class="attr">description</span>: <span class="string">&quot;websocket connection closed&quot;</span>,</span><br><span class="line">            <span class="attr">context</span>: closeEvent</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">ws</span>.<span class="property">onmessage</span> = <span class="keyword">function</span> (<span class="params">ev</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> _this2.<span class="title function_">onData</span>(ev.<span class="property">data</span>);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">ws</span>.<span class="property">onerror</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> _this2.<span class="title function_">onError</span>(<span class="string">&quot;websocket error&quot;</span>, e);</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Writes data to socket.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; array of packets.</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;write&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">write</span>(<span class="params">packets</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this3 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">writable</span> = <span class="literal">false</span>; <span class="comment">// encodePacket efficient as it uses WS framing</span></span><br><span class="line">        <span class="comment">// no need for encodePayload</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> _loop = <span class="keyword">function</span> <span class="title function_">_loop</span>(<span class="params">i</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> packet = packets[i];</span><br><span class="line">          <span class="keyword">var</span> lastPacket = i === packets.<span class="property">length</span> - <span class="number">1</span>;</span><br><span class="line">          <span class="title function_">encodePacket</span>(packet, _this3.<span class="property">supportsBinary</span>, <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">            <span class="comment">// always create a new object (GH-437)</span></span><br><span class="line">            <span class="keyword">var</span> opts = &#123;&#125;;</span><br><span class="line">            <span class="comment">// have a chance of informing us about it yet, in that case send will</span></span><br><span class="line">            <span class="comment">// throw an error</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">              <span class="keyword">if</span> (usingBrowserWebSocket) &#123;</span><br><span class="line">                <span class="comment">// TypeError is thrown when passing the second argument on Safari</span></span><br><span class="line">                _this3.<span class="property">ws</span>.<span class="title function_">send</span>(data);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (lastPacket) &#123;</span><br><span class="line">              <span class="comment">// fake drain</span></span><br><span class="line">              <span class="comment">// defer to next tick to allow Socket to clear writeBuffer</span></span><br><span class="line">              <span class="title function_">nextTick</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                _this3.<span class="property">writable</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">                _this3.<span class="title function_">emitReserved</span>(<span class="string">&quot;drain&quot;</span>);</span><br><span class="line">              &#125;, _this3.<span class="property">setTimeoutFn</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; packets.<span class="property">length</span>; i++) &#123;</span><br><span class="line">          <span class="title function_">_loop</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Closes socket.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;doClose&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">doClose</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">this</span>.<span class="property">ws</span> !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">ws</span>.<span class="title function_">close</span>();</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">ws</span> = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Generates uri for connection.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;uri&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">uri</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> query = <span class="variable language_">this</span>.<span class="property">query</span> || &#123;&#125;;</span><br><span class="line">        <span class="keyword">var</span> schema = <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">secure</span> ? <span class="string">&quot;wss&quot;</span> : <span class="string">&quot;ws&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> port = <span class="string">&quot;&quot;</span>; <span class="comment">// avoid port if default for schema</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">port</span> &amp;&amp; (<span class="string">&quot;wss&quot;</span> === schema &amp;&amp; <span class="title class_">Number</span>(<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">port</span>) !== <span class="number">443</span> || <span class="string">&quot;ws&quot;</span> === schema &amp;&amp; <span class="title class_">Number</span>(<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">port</span>) !== <span class="number">80</span>)) &#123;</span><br><span class="line">          port = <span class="string">&quot;:&quot;</span> + <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">port</span>;</span><br><span class="line">        &#125; <span class="comment">// append timestamp to URI</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">timestampRequests</span>) &#123;</span><br><span class="line">          query[<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">timestampParam</span>] = <span class="title function_">yeast</span>();</span><br><span class="line">        &#125; <span class="comment">// communicate binary support capabilities</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">supportsBinary</span>) &#123;</span><br><span class="line">          query.<span class="property">b64</span> = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> encodedQuery = <span class="title function_">encode</span>(query);</span><br><span class="line">        <span class="keyword">var</span> ipv6 = <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">hostname</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;:&quot;</span>) !== -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> schema + <span class="string">&quot;://&quot;</span> + (ipv6 ? <span class="string">&quot;[&quot;</span> + <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">hostname</span> + <span class="string">&quot;]&quot;</span> : <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">hostname</span>) + port + <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">path</span> + (encodedQuery.<span class="property">length</span> ? <span class="string">&quot;?&quot;</span> + encodedQuery : <span class="string">&quot;&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Feature detection for WebSocket.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@return</span> &#123;<span class="type">Boolean</span>&#125; whether this transport is available.</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;check&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">check</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> !!<span class="title class_">WebSocket</span> &amp;&amp; !(<span class="string">&quot;__initialize&quot;</span> <span class="keyword">in</span> <span class="title class_">WebSocket</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">name</span> === <span class="variable constant_">WS</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">name</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable constant_">WS</span>;</span><br><span class="line">  &#125;(<span class="title class_">Transport</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> transports = &#123;</span><br><span class="line">    <span class="attr">websocket</span>: <span class="variable constant_">WS</span>,</span><br><span class="line">    <span class="attr">polling</span>: <span class="title class_">Polling</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// imported from https://github.com/galkn/parseuri</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Parses an URI</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@author</span> Steven Levithan &lt;stevenlevithan.com&gt; (MIT license)</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">var</span> re = <span class="regexp">/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]&#123;0,4&#125;:)&#123;2,7&#125;[a-f0-9]&#123;0,4&#125;|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/</span>;</span><br><span class="line">  <span class="keyword">var</span> parts = [<span class="string">&#x27;source&#x27;</span>, <span class="string">&#x27;protocol&#x27;</span>, <span class="string">&#x27;authority&#x27;</span>, <span class="string">&#x27;userInfo&#x27;</span>, <span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;host&#x27;</span>, <span class="string">&#x27;port&#x27;</span>, <span class="string">&#x27;relative&#x27;</span>, <span class="string">&#x27;path&#x27;</span>, <span class="string">&#x27;directory&#x27;</span>, <span class="string">&#x27;file&#x27;</span>, <span class="string">&#x27;query&#x27;</span>, <span class="string">&#x27;anchor&#x27;</span>];</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">parse</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> src = str,</span><br><span class="line">        b = str.<span class="title function_">indexOf</span>(<span class="string">&#x27;[&#x27;</span>),</span><br><span class="line">        e = str.<span class="title function_">indexOf</span>(<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (b != -<span class="number">1</span> &amp;&amp; e != -<span class="number">1</span>) &#123;</span><br><span class="line">      str = str.<span class="title function_">substring</span>(<span class="number">0</span>, b) + str.<span class="title function_">substring</span>(b, e).<span class="title function_">replace</span>(<span class="regexp">/:/g</span>, <span class="string">&#x27;;&#x27;</span>) + str.<span class="title function_">substring</span>(e, str.<span class="property">length</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> m = re.<span class="title function_">exec</span>(str || <span class="string">&#x27;&#x27;</span>),</span><br><span class="line">        uri = &#123;&#125;,</span><br><span class="line">        i = <span class="number">14</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (i--) &#123;</span><br><span class="line">      uri[parts[i]] = m[i] || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (b != -<span class="number">1</span> &amp;&amp; e != -<span class="number">1</span>) &#123;</span><br><span class="line">      uri.<span class="property">source</span> = src;</span><br><span class="line">      uri.<span class="property">host</span> = uri.<span class="property">host</span>.<span class="title function_">substring</span>(<span class="number">1</span>, uri.<span class="property">host</span>.<span class="property">length</span> - <span class="number">1</span>).<span class="title function_">replace</span>(<span class="regexp">/;/g</span>, <span class="string">&#x27;:&#x27;</span>);</span><br><span class="line">      uri.<span class="property">authority</span> = uri.<span class="property">authority</span>.<span class="title function_">replace</span>(<span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;&#x27;</span>).<span class="title function_">replace</span>(<span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;&#x27;</span>).<span class="title function_">replace</span>(<span class="regexp">/;/g</span>, <span class="string">&#x27;:&#x27;</span>);</span><br><span class="line">      uri.<span class="property">ipv6uri</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    uri.<span class="property">pathNames</span> = <span class="title function_">pathNames</span>(uri, uri[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">    uri.<span class="property">queryKey</span> = <span class="title function_">queryKey</span>(uri, uri[<span class="string">&#x27;query&#x27;</span>]);</span><br><span class="line">    <span class="keyword">return</span> uri;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">pathNames</span>(<span class="params">obj, path</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> regx = <span class="regexp">/\/&#123;2,9&#125;/g</span>,</span><br><span class="line">        names = path.<span class="title function_">replace</span>(regx, <span class="string">&quot;/&quot;</span>).<span class="title function_">split</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (path.<span class="title function_">substr</span>(<span class="number">0</span>, <span class="number">1</span>) == <span class="string">&#x27;/&#x27;</span> || path.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      names.<span class="title function_">splice</span>(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (path.<span class="title function_">substr</span>(path.<span class="property">length</span> - <span class="number">1</span>, <span class="number">1</span>) == <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line">      names.<span class="title function_">splice</span>(names.<span class="property">length</span> - <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> names;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">queryKey</span>(<span class="params">uri, query</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> data = &#123;&#125;;</span><br><span class="line">    query.<span class="title function_">replace</span>(<span class="regexp">/(?:^|&amp;)([^&amp;=]*)=?([^&amp;]*)/g</span>, <span class="keyword">function</span> (<span class="params">$0, $1, $2</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> ($1) &#123;</span><br><span class="line">        data[$1] = $2;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">Socket</span>$1 = <span class="comment">/*#__PURE__*/</span><span class="keyword">function</span> (<span class="params">_Emitter</span>) &#123;</span><br><span class="line">    <span class="title function_">_inherits</span>(<span class="title class_">Socket</span>, _Emitter);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> _super = <span class="title function_">_createSuper</span>(<span class="title class_">Socket</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Socket constructor.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">String|Object</span>&#125; uri or options</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">opts</span> - options</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Socket</span>(<span class="params">uri</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> _this;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> opts = <span class="variable language_">arguments</span>.<span class="property">length</span> &gt; <span class="number">1</span> &amp;&amp; <span class="variable language_">arguments</span>[<span class="number">1</span>] !== <span class="literal">undefined</span> ? <span class="variable language_">arguments</span>[<span class="number">1</span>] : &#123;&#125;;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">_classCallCheck</span>(<span class="variable language_">this</span>, <span class="title class_">Socket</span>);</span><br><span class="line"></span><br><span class="line">      _this = _super.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (uri &amp;&amp; <span class="string">&quot;object&quot;</span> === <span class="title function_">_typeof</span>(uri)) &#123;</span><br><span class="line">        opts = uri;</span><br><span class="line">        uri = <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (uri) &#123;</span><br><span class="line">        uri = <span class="title function_">parse</span>(uri);</span><br><span class="line">        opts.<span class="property">hostname</span> = uri.<span class="property">host</span>;</span><br><span class="line">        opts.<span class="property">secure</span> = uri.<span class="property">protocol</span> === <span class="string">&quot;https&quot;</span> || uri.<span class="property">protocol</span> === <span class="string">&quot;wss&quot;</span>;</span><br><span class="line">        opts.<span class="property">port</span> = uri.<span class="property">port</span>;</span><br><span class="line">        <span class="keyword">if</span> (uri.<span class="property">query</span>) opts.<span class="property">query</span> = uri.<span class="property">query</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opts.<span class="property">host</span>) &#123;</span><br><span class="line">        opts.<span class="property">hostname</span> = <span class="title function_">parse</span>(opts.<span class="property">host</span>).<span class="property">host</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">installTimerFunctions</span>(<span class="title function_">_assertThisInitialized</span>(_this), opts);</span><br><span class="line">      _this.<span class="property">secure</span> = <span class="literal">null</span> != opts.<span class="property">secure</span> ? opts.<span class="property">secure</span> : <span class="keyword">typeof</span> location !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; <span class="string">&quot;https:&quot;</span> === location.<span class="property">protocol</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (opts.<span class="property">hostname</span> &amp;&amp; !opts.<span class="property">port</span>) &#123;</span><br><span class="line">        <span class="comment">// if no port is specified manually, use the protocol default</span></span><br><span class="line">        opts.<span class="property">port</span> = _this.<span class="property">secure</span> ? <span class="string">&quot;443&quot;</span> : <span class="string">&quot;80&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      _this.<span class="property">hostname</span> = opts.<span class="property">hostname</span> || (<span class="keyword">typeof</span> location !== <span class="string">&quot;undefined&quot;</span> ? location.<span class="property">hostname</span> : <span class="string">&quot;localhost&quot;</span>);</span><br><span class="line">      _this.<span class="property">port</span> = opts.<span class="property">port</span> || (<span class="keyword">typeof</span> location !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; location.<span class="property">port</span> ? location.<span class="property">port</span> : _this.<span class="property">secure</span> ? <span class="string">&quot;443&quot;</span> : <span class="string">&quot;80&quot;</span>);</span><br><span class="line">      _this.<span class="property">transports</span> = opts.<span class="property">transports</span> || [<span class="string">&quot;polling&quot;</span>, <span class="string">&quot;websocket&quot;</span>];</span><br><span class="line">      _this.<span class="property">readyState</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">      _this.<span class="property">writeBuffer</span> = [];</span><br><span class="line">      _this.<span class="property">prevBufferLen</span> = <span class="number">0</span>;</span><br><span class="line">      _this.<span class="property">opts</span> = <span class="title function_">_extends</span>(&#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;/engine.io&quot;</span>,</span><br><span class="line">        <span class="attr">agent</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">withCredentials</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">upgrade</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">timestampParam</span>: <span class="string">&quot;t&quot;</span>,</span><br><span class="line">        <span class="attr">rememberUpgrade</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">rejectUnauthorized</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">perMessageDeflate</span>: &#123;</span><br><span class="line">          <span class="attr">threshold</span>: <span class="number">1024</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">transportOptions</span>: &#123;&#125;,</span><br><span class="line">        <span class="attr">closeOnBeforeunload</span>: <span class="literal">true</span></span><br><span class="line">      &#125;, opts);</span><br><span class="line">      _this.<span class="property">opts</span>.<span class="property">path</span> = _this.<span class="property">opts</span>.<span class="property">path</span>.<span class="title function_">replace</span>(<span class="regexp">/\/$/</span>, <span class="string">&quot;&quot;</span>) + <span class="string">&quot;/&quot;</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> _this.<span class="property">opts</span>.<span class="property">query</span> === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">        _this.<span class="property">opts</span>.<span class="property">query</span> = <span class="title function_">decode</span>(_this.<span class="property">opts</span>.<span class="property">query</span>);</span><br><span class="line">      &#125; <span class="comment">// set on handshake</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      _this.<span class="property">id</span> = <span class="literal">null</span>;</span><br><span class="line">      _this.<span class="property">upgrades</span> = <span class="literal">null</span>;</span><br><span class="line">      _this.<span class="property">pingInterval</span> = <span class="literal">null</span>;</span><br><span class="line">      _this.<span class="property">pingTimeout</span> = <span class="literal">null</span>; <span class="comment">// set on heartbeat</span></span><br><span class="line"></span><br><span class="line">      _this.<span class="property">pingTimeoutTimer</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> addEventListener === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (_this.<span class="property">opts</span>.<span class="property">closeOnBeforeunload</span>) &#123;</span><br><span class="line">          <span class="comment">// Firefox closes the connection when the &quot;beforeunload&quot; event is emitted but not Chrome. This event listener</span></span><br><span class="line">          <span class="comment">// ensures every browser behaves the same (no &quot;disconnect&quot; event at the Socket.IO level when the page is</span></span><br><span class="line">          <span class="comment">// closed/reloaded)</span></span><br><span class="line">          <span class="title function_">addEventListener</span>(<span class="string">&quot;beforeunload&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (_this.<span class="property">transport</span>) &#123;</span><br><span class="line">              <span class="comment">// silently close the transport</span></span><br><span class="line">              _this.<span class="property">transport</span>.<span class="title function_">removeAllListeners</span>();</span><br><span class="line"></span><br><span class="line">              _this.<span class="property">transport</span>.<span class="title function_">close</span>();</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (_this.<span class="property">hostname</span> !== <span class="string">&quot;localhost&quot;</span>) &#123;</span><br><span class="line">          _this.<span class="property">offlineEventListener</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            _this.<span class="title function_">onClose</span>(<span class="string">&quot;transport close&quot;</span>, &#123;</span><br><span class="line">              <span class="attr">description</span>: <span class="string">&quot;network connection lost&quot;</span></span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;;</span><br><span class="line"></span><br><span class="line">          <span class="title function_">addEventListener</span>(<span class="string">&quot;offline&quot;</span>, _this.<span class="property">offlineEventListener</span>, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      _this.<span class="title function_">open</span>();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> _this;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Creates transport of the given type.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; transport name</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="type">Transport</span>&#125;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">_createClass</span>(<span class="title class_">Socket</span>, [&#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;createTransport&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">createTransport</span>(<span class="params">name</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> query = <span class="title function_">_extends</span>(&#123;&#125;, <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">query</span>); <span class="comment">// append engine.io protocol identifier</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        query.<span class="property">EIO</span> = protocol$1; <span class="comment">// transport name</span></span><br><span class="line"></span><br><span class="line">        query.<span class="property">transport</span> = name; <span class="comment">// session id if we already have one</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">id</span>) query.<span class="property">sid</span> = <span class="variable language_">this</span>.<span class="property">id</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> opts = <span class="title function_">_extends</span>(&#123;&#125;, <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">transportOptions</span>[name], <span class="variable language_">this</span>.<span class="property">opts</span>, &#123;</span><br><span class="line">          <span class="attr">query</span>: query,</span><br><span class="line">          <span class="attr">socket</span>: <span class="variable language_">this</span>,</span><br><span class="line">          <span class="attr">hostname</span>: <span class="variable language_">this</span>.<span class="property">hostname</span>,</span><br><span class="line">          <span class="attr">secure</span>: <span class="variable language_">this</span>.<span class="property">secure</span>,</span><br><span class="line">          <span class="attr">port</span>: <span class="variable language_">this</span>.<span class="property">port</span></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> transports[name](opts);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Initializes transport to use and starts probe.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;open&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">open</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this2 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> transport;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">rememberUpgrade</span> &amp;&amp; <span class="title class_">Socket</span>.<span class="property">priorWebsocketSuccess</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">transports</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;websocket&quot;</span>) !== -<span class="number">1</span>) &#123;</span><br><span class="line">          transport = <span class="string">&quot;websocket&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="number">0</span> === <span class="variable language_">this</span>.<span class="property">transports</span>.<span class="property">length</span>) &#123;</span><br><span class="line">          <span class="comment">// Emit error on next tick so it can be listened to</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">setTimeoutFn</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            _this2.<span class="title function_">emitReserved</span>(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;No transports available&quot;</span>);</span><br><span class="line">          &#125;, <span class="number">0</span>);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          transport = <span class="variable language_">this</span>.<span class="property">transports</span>[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">readyState</span> = <span class="string">&quot;opening&quot;</span>; <span class="comment">// Retry with the next transport if the transport is disabled (jsonp: false)</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          transport = <span class="variable language_">this</span>.<span class="title function_">createTransport</span>(transport);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">transports</span>.<span class="title function_">shift</span>();</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">open</span>();</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        transport.<span class="title function_">open</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setTransport</span>(transport);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Sets the current transport. Disables the existing one (if any).</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;setTransport&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">setTransport</span>(<span class="params">transport</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this3 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">transport</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">transport</span>.<span class="title function_">removeAllListeners</span>();</span><br><span class="line">        &#125; <span class="comment">// set up transport</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">transport</span> = transport; <span class="comment">// set up transport listeners</span></span><br><span class="line"></span><br><span class="line">        transport.<span class="title function_">on</span>(<span class="string">&quot;drain&quot;</span>, <span class="variable language_">this</span>.<span class="property">onDrain</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)).<span class="title function_">on</span>(<span class="string">&quot;packet&quot;</span>, <span class="variable language_">this</span>.<span class="property">onPacket</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)).<span class="title function_">on</span>(<span class="string">&quot;error&quot;</span>, <span class="variable language_">this</span>.<span class="property">onError</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)).<span class="title function_">on</span>(<span class="string">&quot;close&quot;</span>, <span class="keyword">function</span> (<span class="params">reason</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> _this3.<span class="title function_">onClose</span>(<span class="string">&quot;transport close&quot;</span>, reason);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Probes a transport.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; transport name</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;probe&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">probe</span>(<span class="params">name</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this4 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> transport = <span class="variable language_">this</span>.<span class="title function_">createTransport</span>(name);</span><br><span class="line">        <span class="keyword">var</span> failed = <span class="literal">false</span>;</span><br><span class="line">        <span class="title class_">Socket</span>.<span class="property">priorWebsocketSuccess</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> onTransportOpen = <span class="keyword">function</span> <span class="title function_">onTransportOpen</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (failed) <span class="keyword">return</span>;</span><br><span class="line">          transport.<span class="title function_">send</span>([&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;ping&quot;</span>,</span><br><span class="line">            <span class="attr">data</span>: <span class="string">&quot;probe&quot;</span></span><br><span class="line">          &#125;]);</span><br><span class="line">          transport.<span class="title function_">once</span>(<span class="string">&quot;packet&quot;</span>, <span class="keyword">function</span> (<span class="params">msg</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (failed) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;pong&quot;</span> === msg.<span class="property">type</span> &amp;&amp; <span class="string">&quot;probe&quot;</span> === msg.<span class="property">data</span>) &#123;</span><br><span class="line">              _this4.<span class="property">upgrading</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">              _this4.<span class="title function_">emitReserved</span>(<span class="string">&quot;upgrading&quot;</span>, transport);</span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span> (!transport) <span class="keyword">return</span>;</span><br><span class="line">              <span class="title class_">Socket</span>.<span class="property">priorWebsocketSuccess</span> = <span class="string">&quot;websocket&quot;</span> === transport.<span class="property">name</span>;</span><br><span class="line"></span><br><span class="line">              _this4.<span class="property">transport</span>.<span class="title function_">pause</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (failed) <span class="keyword">return</span>;</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">&quot;closed&quot;</span> === _this4.<span class="property">readyState</span>) <span class="keyword">return</span>;</span><br><span class="line">                <span class="title function_">cleanup</span>();</span><br><span class="line"></span><br><span class="line">                _this4.<span class="title function_">setTransport</span>(transport);</span><br><span class="line"></span><br><span class="line">                transport.<span class="title function_">send</span>([&#123;</span><br><span class="line">                  <span class="attr">type</span>: <span class="string">&quot;upgrade&quot;</span></span><br><span class="line">                &#125;]);</span><br><span class="line"></span><br><span class="line">                _this4.<span class="title function_">emitReserved</span>(<span class="string">&quot;upgrade&quot;</span>, transport);</span><br><span class="line"></span><br><span class="line">                transport = <span class="literal">null</span>;</span><br><span class="line">                _this4.<span class="property">upgrading</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">                _this4.<span class="title function_">flush</span>();</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="keyword">var</span> err = <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;probe error&quot;</span>); <span class="comment">// @ts-ignore</span></span><br><span class="line"></span><br><span class="line">              err.<span class="property">transport</span> = transport.<span class="property">name</span>;</span><br><span class="line"></span><br><span class="line">              _this4.<span class="title function_">emitReserved</span>(<span class="string">&quot;upgradeError&quot;</span>, err);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">freezeTransport</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (failed) <span class="keyword">return</span>; <span class="comment">// Any callback called by transport should be ignored since now</span></span><br><span class="line"></span><br><span class="line">          failed = <span class="literal">true</span>;</span><br><span class="line">          <span class="title function_">cleanup</span>();</span><br><span class="line">          transport.<span class="title function_">close</span>();</span><br><span class="line">          transport = <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="comment">// Handle any error that happens while probing</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> onerror = <span class="keyword">function</span> <span class="title function_">onerror</span>(<span class="params">err</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> error = <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;probe error: &quot;</span> + err); <span class="comment">// @ts-ignore</span></span><br><span class="line"></span><br><span class="line">          error.<span class="property">transport</span> = transport.<span class="property">name</span>;</span><br><span class="line">          <span class="title function_">freezeTransport</span>();</span><br><span class="line"></span><br><span class="line">          _this4.<span class="title function_">emitReserved</span>(<span class="string">&quot;upgradeError&quot;</span>, error);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">onTransportClose</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="title function_">onerror</span>(<span class="string">&quot;transport closed&quot;</span>);</span><br><span class="line">        &#125; <span class="comment">// When the socket is closed while we&#x27;re probing</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">onclose</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="title function_">onerror</span>(<span class="string">&quot;socket closed&quot;</span>);</span><br><span class="line">        &#125; <span class="comment">// When the socket is upgraded while we&#x27;re probing</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">onupgrade</span>(<span class="params">to</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (transport &amp;&amp; to.<span class="property">name</span> !== transport.<span class="property">name</span>) &#123;</span><br><span class="line">            <span class="title function_">freezeTransport</span>();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="comment">// Remove all listeners on the transport and on self</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> cleanup = <span class="keyword">function</span> <span class="title function_">cleanup</span>(<span class="params"></span>) &#123;</span><br><span class="line">          transport.<span class="title function_">removeListener</span>(<span class="string">&quot;open&quot;</span>, onTransportOpen);</span><br><span class="line">          transport.<span class="title function_">removeListener</span>(<span class="string">&quot;error&quot;</span>, onerror);</span><br><span class="line">          transport.<span class="title function_">removeListener</span>(<span class="string">&quot;close&quot;</span>, onTransportClose);</span><br><span class="line"></span><br><span class="line">          _this4.<span class="title function_">off</span>(<span class="string">&quot;close&quot;</span>, onclose);</span><br><span class="line"></span><br><span class="line">          _this4.<span class="title function_">off</span>(<span class="string">&quot;upgrading&quot;</span>, onupgrade);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        transport.<span class="title function_">once</span>(<span class="string">&quot;open&quot;</span>, onTransportOpen);</span><br><span class="line">        transport.<span class="title function_">once</span>(<span class="string">&quot;error&quot;</span>, onerror);</span><br><span class="line">        transport.<span class="title function_">once</span>(<span class="string">&quot;close&quot;</span>, onTransportClose);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">once</span>(<span class="string">&quot;close&quot;</span>, onclose);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">once</span>(<span class="string">&quot;upgrading&quot;</span>, onupgrade);</span><br><span class="line">        transport.<span class="title function_">open</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called when connection is deemed open.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onOpen&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onOpen</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">readyState</span> = <span class="string">&quot;open&quot;</span>;</span><br><span class="line">        <span class="title class_">Socket</span>.<span class="property">priorWebsocketSuccess</span> = <span class="string">&quot;websocket&quot;</span> === <span class="variable language_">this</span>.<span class="property">transport</span>.<span class="property">name</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">flush</span>(); <span class="comment">// we check for `readyState` in case an `open`</span></span><br><span class="line">        <span class="comment">// listener already closed the socket</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;open&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">upgrade</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">transport</span>.<span class="property">pause</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">var</span> l = <span class="variable language_">this</span>.<span class="property">upgrades</span>.<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">for</span> (; i &lt; l; i++) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">probe</span>(<span class="variable language_">this</span>.<span class="property">upgrades</span>[i]);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Handles a packet.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onPacket&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onPacket</span>(<span class="params">packet</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;opening&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span> || <span class="string">&quot;open&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span> || <span class="string">&quot;closing&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;packet&quot;</span>, packet); <span class="comment">// Socket is live - any packet counts</span></span><br><span class="line"></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;heartbeat&quot;</span>);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">switch</span> (packet.<span class="property">type</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;open&quot;</span>:</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">onHandshake</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(packet.<span class="property">data</span>));</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;ping&quot;</span>:</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">resetPingTimeout</span>();</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">sendPacket</span>(<span class="string">&quot;pong&quot;</span>);</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;ping&quot;</span>);</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;pong&quot;</span>);</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;error&quot;</span>:</span><br><span class="line">              <span class="keyword">var</span> err = <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;server error&quot;</span>); <span class="comment">// @ts-ignore</span></span><br><span class="line"></span><br><span class="line">              err.<span class="property">code</span> = packet.<span class="property">data</span>;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">onError</span>(err);</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;message&quot;</span>:</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;data&quot;</span>, packet.<span class="property">data</span>);</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;message&quot;</span>, packet.<span class="property">data</span>);</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon handshake completion.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">data</span> - handshake obj</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onHandshake&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onHandshake</span>(<span class="params">data</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;handshake&quot;</span>, data);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">id</span> = data.<span class="property">sid</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">transport</span>.<span class="property">query</span>.<span class="property">sid</span> = data.<span class="property">sid</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">upgrades</span> = <span class="variable language_">this</span>.<span class="title function_">filterUpgrades</span>(data.<span class="property">upgrades</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">pingInterval</span> = data.<span class="property">pingInterval</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">pingTimeout</span> = data.<span class="property">pingTimeout</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">maxPayload</span> = data.<span class="property">maxPayload</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">onOpen</span>(); <span class="comment">// In case open handler closes socket</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;closed&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">resetPingTimeout</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Sets and resets ping timeout timer based on server pings.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;resetPingTimeout&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">resetPingTimeout</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this5 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">clearTimeoutFn</span>(<span class="variable language_">this</span>.<span class="property">pingTimeoutTimer</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">pingTimeoutTimer</span> = <span class="variable language_">this</span>.<span class="title function_">setTimeoutFn</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          _this5.<span class="title function_">onClose</span>(<span class="string">&quot;ping timeout&quot;</span>);</span><br><span class="line">        &#125;, <span class="variable language_">this</span>.<span class="property">pingInterval</span> + <span class="variable language_">this</span>.<span class="property">pingTimeout</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">autoUnref</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">pingTimeoutTimer</span>.<span class="title function_">unref</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called on `drain` event</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onDrain&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onDrain</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">writeBuffer</span>.<span class="title function_">splice</span>(<span class="number">0</span>, <span class="variable language_">this</span>.<span class="property">prevBufferLen</span>); <span class="comment">// setting prevBufferLen = 0 is very important</span></span><br><span class="line">        <span class="comment">// for example, when upgrading, upgrade packet is sent over,</span></span><br><span class="line">        <span class="comment">// and a nonzero prevBufferLen could cause problems on `drain`</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">prevBufferLen</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="number">0</span> === <span class="variable language_">this</span>.<span class="property">writeBuffer</span>.<span class="property">length</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;drain&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">flush</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Flush write buffers.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;flush&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">flush</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;closed&quot;</span> !== <span class="variable language_">this</span>.<span class="property">readyState</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">transport</span>.<span class="property">writable</span> &amp;&amp; !<span class="variable language_">this</span>.<span class="property">upgrading</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">writeBuffer</span>.<span class="property">length</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> packets = <span class="variable language_">this</span>.<span class="title function_">getWritablePackets</span>();</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">transport</span>.<span class="title function_">send</span>(packets); <span class="comment">// keep track of current length of writeBuffer</span></span><br><span class="line">          <span class="comment">// splice writeBuffer and callbackBuffer on `drain`</span></span><br><span class="line"></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">prevBufferLen</span> = packets.<span class="property">length</span>;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;flush&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP</span></span><br><span class="line"><span class="comment">       * long-polling)</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;getWritablePackets&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">getWritablePackets</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> shouldCheckPayloadSize = <span class="variable language_">this</span>.<span class="property">maxPayload</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">transport</span>.<span class="property">name</span> === <span class="string">&quot;polling&quot;</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">writeBuffer</span>.<span class="property">length</span> &gt; <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!shouldCheckPayloadSize) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">writeBuffer</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> payloadSize = <span class="number">1</span>; <span class="comment">// first packet type</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">writeBuffer</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">          <span class="keyword">var</span> data = <span class="variable language_">this</span>.<span class="property">writeBuffer</span>[i].<span class="property">data</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (data) &#123;</span><br><span class="line">            payloadSize += <span class="title function_">byteLength</span>(data);</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; payloadSize &gt; <span class="variable language_">this</span>.<span class="property">maxPayload</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">writeBuffer</span>.<span class="title function_">slice</span>(<span class="number">0</span>, i);</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          payloadSize += <span class="number">2</span>; <span class="comment">// separator + packet type</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">writeBuffer</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Sends a message.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; message.</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; callback function.</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; options.</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@return</span> &#123;<span class="type">Socket</span>&#125; for chaining.</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;write&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">write</span>(<span class="params">msg, options, fn</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">sendPacket</span>(<span class="string">&quot;message&quot;</span>, msg, options, fn);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;send&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">send</span>(<span class="params">msg, options, fn</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">sendPacket</span>(<span class="string">&quot;message&quot;</span>, msg, options, fn);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Sends a packet.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; packet type.</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; data.</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; options.</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; callback function.</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;sendPacket&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">sendPacket</span>(<span class="params">type, data, options, fn</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;function&quot;</span> === <span class="keyword">typeof</span> data) &#123;</span><br><span class="line">          fn = data;</span><br><span class="line">          data = <span class="literal">undefined</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;function&quot;</span> === <span class="keyword">typeof</span> options) &#123;</span><br><span class="line">          fn = options;</span><br><span class="line">          options = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;closing&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span> || <span class="string">&quot;closed&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        options = options || &#123;&#125;;</span><br><span class="line">        options.<span class="property">compress</span> = <span class="literal">false</span> !== options.<span class="property">compress</span>;</span><br><span class="line">        <span class="keyword">var</span> packet = &#123;</span><br><span class="line">          <span class="attr">type</span>: type,</span><br><span class="line">          <span class="attr">data</span>: data,</span><br><span class="line">          <span class="attr">options</span>: options</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;packetCreate&quot;</span>, packet);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">writeBuffer</span>.<span class="title function_">push</span>(packet);</span><br><span class="line">        <span class="keyword">if</span> (fn) <span class="variable language_">this</span>.<span class="title function_">once</span>(<span class="string">&quot;flush&quot;</span>, fn);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">flush</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Closes the connection.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;close&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">close</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this6 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> close = <span class="keyword">function</span> <span class="title function_">close</span>(<span class="params"></span>) &#123;</span><br><span class="line">          _this6.<span class="title function_">onClose</span>(<span class="string">&quot;forced close&quot;</span>);</span><br><span class="line"></span><br><span class="line">          _this6.<span class="property">transport</span>.<span class="title function_">close</span>();</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> cleanupAndClose = <span class="keyword">function</span> <span class="title function_">cleanupAndClose</span>(<span class="params"></span>) &#123;</span><br><span class="line">          _this6.<span class="title function_">off</span>(<span class="string">&quot;upgrade&quot;</span>, cleanupAndClose);</span><br><span class="line"></span><br><span class="line">          _this6.<span class="title function_">off</span>(<span class="string">&quot;upgradeError&quot;</span>, cleanupAndClose);</span><br><span class="line"></span><br><span class="line">          <span class="title function_">close</span>();</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> waitForUpgrade = <span class="keyword">function</span> <span class="title function_">waitForUpgrade</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="comment">// wait for upgrade to finish since we can&#x27;t send packets while pausing a transport</span></span><br><span class="line">          _this6.<span class="title function_">once</span>(<span class="string">&quot;upgrade&quot;</span>, cleanupAndClose);</span><br><span class="line"></span><br><span class="line">          _this6.<span class="title function_">once</span>(<span class="string">&quot;upgradeError&quot;</span>, cleanupAndClose);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;opening&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span> || <span class="string">&quot;open&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">readyState</span> = <span class="string">&quot;closing&quot;</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">writeBuffer</span>.<span class="property">length</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">once</span>(<span class="string">&quot;drain&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">              <span class="keyword">if</span> (_this6.<span class="property">upgrading</span>) &#123;</span><br><span class="line">                <span class="title function_">waitForUpgrade</span>();</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="title function_">close</span>();</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">upgrading</span>) &#123;</span><br><span class="line">            <span class="title function_">waitForUpgrade</span>();</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_">close</span>();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon transport error</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onError&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onError</span>(<span class="params">err</span>) &#123;</span><br><span class="line">        <span class="title class_">Socket</span>.<span class="property">priorWebsocketSuccess</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;error&quot;</span>, err);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">onClose</span>(<span class="string">&quot;transport error&quot;</span>, err);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon transport close.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onClose&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onClose</span>(<span class="params">reason, description</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;opening&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span> || <span class="string">&quot;open&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span> || <span class="string">&quot;closing&quot;</span> === <span class="variable language_">this</span>.<span class="property">readyState</span>) &#123;</span><br><span class="line">          <span class="comment">// clear timers</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">clearTimeoutFn</span>(<span class="variable language_">this</span>.<span class="property">pingTimeoutTimer</span>); <span class="comment">// stop event from firing again for transport</span></span><br><span class="line"></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">transport</span>.<span class="title function_">removeAllListeners</span>(<span class="string">&quot;close&quot;</span>); <span class="comment">// ensure transport won&#x27;t stay open</span></span><br><span class="line"></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">transport</span>.<span class="title function_">close</span>(); <span class="comment">// ignore further transport communication</span></span><br><span class="line"></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">transport</span>.<span class="title function_">removeAllListeners</span>();</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (<span class="keyword">typeof</span> removeEventListener === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">            <span class="title function_">removeEventListener</span>(<span class="string">&quot;offline&quot;</span>, <span class="variable language_">this</span>.<span class="property">offlineEventListener</span>, <span class="literal">false</span>);</span><br><span class="line">          &#125; <span class="comment">// set ready state</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">readyState</span> = <span class="string">&quot;closed&quot;</span>; <span class="comment">// clear session id</span></span><br><span class="line"></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">id</span> = <span class="literal">null</span>; <span class="comment">// emit close event</span></span><br><span class="line"></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;close&quot;</span>, reason, description); <span class="comment">// clean buffers after, so users can still</span></span><br><span class="line">          <span class="comment">// grab the buffers on `close` event</span></span><br><span class="line"></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">writeBuffer</span> = [];</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">prevBufferLen</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Filters upgrades, returning only those matching client transports.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; server upgrades</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@api</span> <span class="variable">private</span></span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;filterUpgrades&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">filterUpgrades</span>(<span class="params">upgrades</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> filteredUpgrades = [];</span><br><span class="line">        <span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">var</span> j = upgrades.<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (; i &lt; j; i++) &#123;</span><br><span class="line">          <span class="keyword">if</span> (~<span class="variable language_">this</span>.<span class="property">transports</span>.<span class="title function_">indexOf</span>(upgrades[i])) filteredUpgrades.<span class="title function_">push</span>(upgrades[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> filteredUpgrades;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Socket</span>;</span><br><span class="line">  &#125;(<span class="title class_">Emitter</span>);</span><br><span class="line">  <span class="title class_">Socket</span>$1.<span class="property">protocol</span> = protocol$1;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * URL parser.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> <span class="variable">uri</span> - url</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> <span class="variable">path</span> - the request path of the connection</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> <span class="variable">loc</span> - An object meant to mimic window.location.</span></span><br><span class="line"><span class="comment">   *        Defaults to window.location.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">url</span>(<span class="params">uri</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> path = <span class="variable language_">arguments</span>.<span class="property">length</span> &gt; <span class="number">1</span> &amp;&amp; <span class="variable language_">arguments</span>[<span class="number">1</span>] !== <span class="literal">undefined</span> ? <span class="variable language_">arguments</span>[<span class="number">1</span>] : <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> loc = <span class="variable language_">arguments</span>.<span class="property">length</span> &gt; <span class="number">2</span> ? <span class="variable language_">arguments</span>[<span class="number">2</span>] : <span class="literal">undefined</span>;</span><br><span class="line">    <span class="keyword">var</span> obj = uri; <span class="comment">// default to window.location</span></span><br><span class="line"></span><br><span class="line">    loc = loc || <span class="keyword">typeof</span> location !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; location;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> == uri) uri = loc.<span class="property">protocol</span> + <span class="string">&quot;//&quot;</span> + loc.<span class="property">host</span>; <span class="comment">// relative path support</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> uri === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="string">&quot;/&quot;</span> === uri.<span class="title function_">charAt</span>(<span class="number">0</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;/&quot;</span> === uri.<span class="title function_">charAt</span>(<span class="number">1</span>)) &#123;</span><br><span class="line">          uri = loc.<span class="property">protocol</span> + uri;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          uri = loc.<span class="property">host</span> + uri;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (!<span class="regexp">/^(https?|wss?):\/\//</span>.<span class="title function_">test</span>(uri)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;undefined&quot;</span> !== <span class="keyword">typeof</span> loc) &#123;</span><br><span class="line">          uri = loc.<span class="property">protocol</span> + <span class="string">&quot;//&quot;</span> + uri;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          uri = <span class="string">&quot;https://&quot;</span> + uri;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="comment">// parse</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      obj = <span class="title function_">parse</span>(uri);</span><br><span class="line">    &#125; <span class="comment">// make sure we treat `localhost:80` and `localhost` equally</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!obj.<span class="property">port</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="regexp">/^(http|ws)$/</span>.<span class="title function_">test</span>(obj.<span class="property">protocol</span>)) &#123;</span><br><span class="line">        obj.<span class="property">port</span> = <span class="string">&quot;80&quot;</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="regexp">/^(http|ws)s$/</span>.<span class="title function_">test</span>(obj.<span class="property">protocol</span>)) &#123;</span><br><span class="line">        obj.<span class="property">port</span> = <span class="string">&quot;443&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    obj.<span class="property">path</span> = obj.<span class="property">path</span> || <span class="string">&quot;/&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> ipv6 = obj.<span class="property">host</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;:&quot;</span>) !== -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> host = ipv6 ? <span class="string">&quot;[&quot;</span> + obj.<span class="property">host</span> + <span class="string">&quot;]&quot;</span> : obj.<span class="property">host</span>; <span class="comment">// define unique id</span></span><br><span class="line"></span><br><span class="line">    obj.<span class="property">id</span> = obj.<span class="property">protocol</span> + <span class="string">&quot;://&quot;</span> + host + <span class="string">&quot;:&quot;</span> + obj.<span class="property">port</span> + path; <span class="comment">// define href</span></span><br><span class="line"></span><br><span class="line">    obj.<span class="property">href</span> = obj.<span class="property">protocol</span> + <span class="string">&quot;://&quot;</span> + host + (loc &amp;&amp; loc.<span class="property">port</span> === obj.<span class="property">port</span> ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;:&quot;</span> + obj.<span class="property">port</span>);</span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> withNativeArrayBuffer = <span class="keyword">typeof</span> <span class="title class_">ArrayBuffer</span> === <span class="string">&quot;function&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> isView = <span class="keyword">function</span> <span class="title function_">isView</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> <span class="title class_">ArrayBuffer</span>.<span class="property">isView</span> === <span class="string">&quot;function&quot;</span> ? <span class="title class_">ArrayBuffer</span>.<span class="title function_">isView</span>(obj) : obj.<span class="property">buffer</span> <span class="keyword">instanceof</span> <span class="title class_">ArrayBuffer</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> toString = <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>;</span><br><span class="line">  <span class="keyword">var</span> withNativeBlob = <span class="keyword">typeof</span> <span class="title class_">Blob</span> === <span class="string">&quot;function&quot;</span> || <span class="keyword">typeof</span> <span class="title class_">Blob</span> !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; toString.<span class="title function_">call</span>(<span class="title class_">Blob</span>) === <span class="string">&quot;[object BlobConstructor]&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> withNativeFile = <span class="keyword">typeof</span> <span class="title class_">File</span> === <span class="string">&quot;function&quot;</span> || <span class="keyword">typeof</span> <span class="title class_">File</span> !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; toString.<span class="title function_">call</span>(<span class="title class_">File</span>) === <span class="string">&quot;[object FileConstructor]&quot;</span>;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">isBinary</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> withNativeArrayBuffer &amp;&amp; (obj <span class="keyword">instanceof</span> <span class="title class_">ArrayBuffer</span> || <span class="title function_">isView</span>(obj)) || withNativeBlob &amp;&amp; obj <span class="keyword">instanceof</span> <span class="title class_">Blob</span> || withNativeFile &amp;&amp; obj <span class="keyword">instanceof</span> <span class="title class_">File</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">hasBinary</span>(<span class="params">obj, toJSON</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!obj || <span class="title function_">_typeof</span>(obj) !== <span class="string">&quot;object&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(obj)) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = obj.<span class="property">length</span>; i &lt; l; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">hasBinary</span>(obj[i])) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isBinary</span>(obj)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (obj.<span class="property">toJSON</span> &amp;&amp; <span class="keyword">typeof</span> obj.<span class="property">toJSON</span> === <span class="string">&quot;function&quot;</span> &amp;&amp; <span class="variable language_">arguments</span>.<span class="property">length</span> === <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">hasBinary</span>(obj.<span class="title function_">toJSON</span>(), <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(obj, key) &amp;&amp; <span class="title function_">hasBinary</span>(obj[key])) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">packet</span> - socket.io event packet</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> &#123;<span class="type">Object</span>&#125; with deconstructed packet and list of buffers</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">deconstructPacket</span>(<span class="params">packet</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> buffers = [];</span><br><span class="line">    <span class="keyword">var</span> packetData = packet.<span class="property">data</span>;</span><br><span class="line">    <span class="keyword">var</span> pack = packet;</span><br><span class="line">    pack.<span class="property">data</span> = <span class="title function_">_deconstructPacket</span>(packetData, buffers);</span><br><span class="line">    pack.<span class="property">attachments</span> = buffers.<span class="property">length</span>; <span class="comment">// number of binary &#x27;attachments&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">packet</span>: pack,</span><br><span class="line">      <span class="attr">buffers</span>: buffers</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_deconstructPacket</span>(<span class="params">data, buffers</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!data) <span class="keyword">return</span> data;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isBinary</span>(data)) &#123;</span><br><span class="line">      <span class="keyword">var</span> placeholder = &#123;</span><br><span class="line">        <span class="attr">_placeholder</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">num</span>: buffers.<span class="property">length</span></span><br><span class="line">      &#125;;</span><br><span class="line">      buffers.<span class="title function_">push</span>(data);</span><br><span class="line">      <span class="keyword">return</span> placeholder;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(data)) &#123;</span><br><span class="line">      <span class="keyword">var</span> newData = <span class="keyword">new</span> <span class="title class_">Array</span>(data.<span class="property">length</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        newData[i] = <span class="title function_">_deconstructPacket</span>(data[i], buffers);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> newData;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title function_">_typeof</span>(data) === <span class="string">&quot;object&quot;</span> &amp;&amp; !(data <span class="keyword">instanceof</span> <span class="title class_">Date</span>)) &#123;</span><br><span class="line">      <span class="keyword">var</span> _newData = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(data, key)) &#123;</span><br><span class="line">          _newData[key] = <span class="title function_">_deconstructPacket</span>(data[key], buffers);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> _newData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Reconstructs a binary packet from its placeholder packet and buffers</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">packet</span> - event packet with placeholders</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; <span class="variable">buffers</span> - binary buffers to put in placeholder positions</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> &#123;<span class="type">Object</span>&#125; reconstructed packet</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">reconstructPacket</span>(<span class="params">packet, buffers</span>) &#123;</span><br><span class="line">    packet.<span class="property">data</span> = <span class="title function_">_reconstructPacket</span>(packet.<span class="property">data</span>, buffers);</span><br><span class="line">    packet.<span class="property">attachments</span> = <span class="literal">undefined</span>; <span class="comment">// no longer useful</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> packet;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">_reconstructPacket</span>(<span class="params">data, buffers</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!data) <span class="keyword">return</span> data;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (data &amp;&amp; data.<span class="property">_placeholder</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> buffers[data.<span class="property">num</span>]; <span class="comment">// appropriate buffer (should be natural order anyway)</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(data)) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        data[i] = <span class="title function_">_reconstructPacket</span>(data[i], buffers);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title function_">_typeof</span>(data) === <span class="string">&quot;object&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(data, key)) &#123;</span><br><span class="line">          data[key] = <span class="title function_">_reconstructPacket</span>(data[key], buffers);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Protocol version.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> protocol = <span class="number">5</span>;</span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">PacketType</span>;</span><br><span class="line"></span><br><span class="line">  (<span class="keyword">function</span> (<span class="params">PacketType</span>) &#123;</span><br><span class="line">    <span class="title class_">PacketType</span>[<span class="title class_">PacketType</span>[<span class="string">&quot;CONNECT&quot;</span>] = <span class="number">0</span>] = <span class="string">&quot;CONNECT&quot;</span>;</span><br><span class="line">    <span class="title class_">PacketType</span>[<span class="title class_">PacketType</span>[<span class="string">&quot;DISCONNECT&quot;</span>] = <span class="number">1</span>] = <span class="string">&quot;DISCONNECT&quot;</span>;</span><br><span class="line">    <span class="title class_">PacketType</span>[<span class="title class_">PacketType</span>[<span class="string">&quot;EVENT&quot;</span>] = <span class="number">2</span>] = <span class="string">&quot;EVENT&quot;</span>;</span><br><span class="line">    <span class="title class_">PacketType</span>[<span class="title class_">PacketType</span>[<span class="string">&quot;ACK&quot;</span>] = <span class="number">3</span>] = <span class="string">&quot;ACK&quot;</span>;</span><br><span class="line">    <span class="title class_">PacketType</span>[<span class="title class_">PacketType</span>[<span class="string">&quot;CONNECT_ERROR&quot;</span>] = <span class="number">4</span>] = <span class="string">&quot;CONNECT_ERROR&quot;</span>;</span><br><span class="line">    <span class="title class_">PacketType</span>[<span class="title class_">PacketType</span>[<span class="string">&quot;BINARY_EVENT&quot;</span>] = <span class="number">5</span>] = <span class="string">&quot;BINARY_EVENT&quot;</span>;</span><br><span class="line">    <span class="title class_">PacketType</span>[<span class="title class_">PacketType</span>[<span class="string">&quot;BINARY_ACK&quot;</span>] = <span class="number">6</span>] = <span class="string">&quot;BINARY_ACK&quot;</span>;</span><br><span class="line">  &#125;)(<span class="title class_">PacketType</span> || (<span class="title class_">PacketType</span> = &#123;&#125;));</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * A socket.io Encoder instance</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">Encoder</span> = <span class="comment">/*#__PURE__*/</span><span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Encoder constructor</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">function</span>&#125; <span class="variable">replacer</span> - custom replacer to pass down to JSON.parse</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Encoder</span>(<span class="params">replacer</span>) &#123;</span><br><span class="line">      <span class="title function_">_classCallCheck</span>(<span class="variable language_">this</span>, <span class="title class_">Encoder</span>);</span><br><span class="line"></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">replacer</span> = replacer;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Encode a packet as a single string if non-binary, or as a</span></span><br><span class="line"><span class="comment">     * buffer sequence, depending on packet type.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">obj</span> - packet object</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">_createClass</span>(<span class="title class_">Encoder</span>, [&#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;encode&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">encode</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (obj.<span class="property">type</span> === <span class="title class_">PacketType</span>.<span class="property">EVENT</span> || obj.<span class="property">type</span> === <span class="title class_">PacketType</span>.<span class="property">ACK</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (<span class="title function_">hasBinary</span>(obj)) &#123;</span><br><span class="line">            obj.<span class="property">type</span> = obj.<span class="property">type</span> === <span class="title class_">PacketType</span>.<span class="property">EVENT</span> ? <span class="title class_">PacketType</span>.<span class="property">BINARY_EVENT</span> : <span class="title class_">PacketType</span>.<span class="property">BINARY_ACK</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">encodeAsBinary</span>(obj);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [<span class="variable language_">this</span>.<span class="title function_">encodeAsString</span>(obj)];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Encode packet as string.</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;encodeAsString&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">encodeAsString</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">        <span class="comment">// first is type</span></span><br><span class="line">        <span class="keyword">var</span> str = <span class="string">&quot;&quot;</span> + obj.<span class="property">type</span>; <span class="comment">// attachments if we have them</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (obj.<span class="property">type</span> === <span class="title class_">PacketType</span>.<span class="property">BINARY_EVENT</span> || obj.<span class="property">type</span> === <span class="title class_">PacketType</span>.<span class="property">BINARY_ACK</span>) &#123;</span><br><span class="line">          str += obj.<span class="property">attachments</span> + <span class="string">&quot;-&quot;</span>;</span><br><span class="line">        &#125; <span class="comment">// if we have a namespace other than `/`</span></span><br><span class="line">        <span class="comment">// we append it followed by a comma `,`</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (obj.<span class="property">nsp</span> &amp;&amp; <span class="string">&quot;/&quot;</span> !== obj.<span class="property">nsp</span>) &#123;</span><br><span class="line">          str += obj.<span class="property">nsp</span> + <span class="string">&quot;,&quot;</span>;</span><br><span class="line">        &#125; <span class="comment">// immediately followed by the id</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != obj.<span class="property">id</span>) &#123;</span><br><span class="line">          str += obj.<span class="property">id</span>;</span><br><span class="line">        &#125; <span class="comment">// json data</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != obj.<span class="property">data</span>) &#123;</span><br><span class="line">          str += <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj.<span class="property">data</span>, <span class="variable language_">this</span>.<span class="property">replacer</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Encode packet as &#x27;buffer sequence&#x27; by removing blobs, and</span></span><br><span class="line"><span class="comment">       * deconstructing packet into object with placeholders and</span></span><br><span class="line"><span class="comment">       * a list of buffers.</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;encodeAsBinary&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">encodeAsBinary</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> deconstruction = <span class="title function_">deconstructPacket</span>(obj);</span><br><span class="line">        <span class="keyword">var</span> pack = <span class="variable language_">this</span>.<span class="title function_">encodeAsString</span>(deconstruction.<span class="property">packet</span>);</span><br><span class="line">        <span class="keyword">var</span> buffers = deconstruction.<span class="property">buffers</span>;</span><br><span class="line">        buffers.<span class="title function_">unshift</span>(pack); <span class="comment">// add packet info to beginning of data list</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> buffers; <span class="comment">// write all the buffers</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Encoder</span>;</span><br><span class="line">  &#125;();</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * A socket.io Decoder instance</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> &#123;<span class="type">Object</span>&#125; <span class="variable">decoder</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">Decoder</span> = <span class="comment">/*#__PURE__*/</span><span class="keyword">function</span> (<span class="params">_Emitter</span>) &#123;</span><br><span class="line">    <span class="title function_">_inherits</span>(<span class="title class_">Decoder</span>, _Emitter);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> _super = <span class="title function_">_createSuper</span>(<span class="title class_">Decoder</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Decoder constructor</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">function</span>&#125; <span class="variable">reviver</span> - custom reviver to pass down to JSON.stringify</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Decoder</span>(<span class="params">reviver</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> _this;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">_classCallCheck</span>(<span class="variable language_">this</span>, <span class="title class_">Decoder</span>);</span><br><span class="line"></span><br><span class="line">      _this = _super.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">      _this.<span class="property">reviver</span> = reviver;</span><br><span class="line">      <span class="keyword">return</span> _this;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Decodes an encoded packet string into packet JSON.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">obj</span> - encoded packet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">_createClass</span>(<span class="title class_">Decoder</span>, [&#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;add&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> packet;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> obj === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">          packet = <span class="variable language_">this</span>.<span class="title function_">decodeString</span>(obj);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (packet.<span class="property">type</span> === <span class="title class_">PacketType</span>.<span class="property">BINARY_EVENT</span> || packet.<span class="property">type</span> === <span class="title class_">PacketType</span>.<span class="property">BINARY_ACK</span>) &#123;</span><br><span class="line">            <span class="comment">// binary packet&#x27;s json</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">reconstructor</span> = <span class="keyword">new</span> <span class="title class_">BinaryReconstructor</span>(packet); <span class="comment">// no attachments, labeled binary but no binary data to follow</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (packet.<span class="property">attachments</span> === <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="title function_">_get</span>(<span class="title function_">_getPrototypeOf</span>(<span class="title class_">Decoder</span>.<span class="property"><span class="keyword">prototype</span></span>), <span class="string">&quot;emitReserved&quot;</span>, <span class="variable language_">this</span>).<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="string">&quot;decoded&quot;</span>, packet);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// non-binary full packet</span></span><br><span class="line">            <span class="title function_">_get</span>(<span class="title function_">_getPrototypeOf</span>(<span class="title class_">Decoder</span>.<span class="property"><span class="keyword">prototype</span></span>), <span class="string">&quot;emitReserved&quot;</span>, <span class="variable language_">this</span>).<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="string">&quot;decoded&quot;</span>, packet);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title function_">isBinary</span>(obj) || obj.<span class="property">base64</span>) &#123;</span><br><span class="line">          <span class="comment">// raw binary data</span></span><br><span class="line">          <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">reconstructor</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;got binary data when not reconstructing a packet&quot;</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            packet = <span class="variable language_">this</span>.<span class="property">reconstructor</span>.<span class="title function_">takeBinaryData</span>(obj);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (packet) &#123;</span><br><span class="line">              <span class="comment">// received final buffer</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">reconstructor</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">              <span class="title function_">_get</span>(<span class="title function_">_getPrototypeOf</span>(<span class="title class_">Decoder</span>.<span class="property"><span class="keyword">prototype</span></span>), <span class="string">&quot;emitReserved&quot;</span>, <span class="variable language_">this</span>).<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="string">&quot;decoded&quot;</span>, packet);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Unknown type: &quot;</span> + obj);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Decode a packet String (JSON data)</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">str</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@return</span> &#123;<span class="type">Object</span>&#125; <span class="variable">packet</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;decodeString&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">decodeString</span>(<span class="params">str</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> i = <span class="number">0</span>; <span class="comment">// look up type</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> p = &#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="title class_">Number</span>(str.<span class="title function_">charAt</span>(<span class="number">0</span>))</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">PacketType</span>[p.<span class="property">type</span>] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;unknown packet type &quot;</span> + p.<span class="property">type</span>);</span><br><span class="line">        &#125; <span class="comment">// look up attachments if type binary</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (p.<span class="property">type</span> === <span class="title class_">PacketType</span>.<span class="property">BINARY_EVENT</span> || p.<span class="property">type</span> === <span class="title class_">PacketType</span>.<span class="property">BINARY_ACK</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> start = i + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">while</span> (str.<span class="title function_">charAt</span>(++i) !== <span class="string">&quot;-&quot;</span> &amp;&amp; i != str.<span class="property">length</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">var</span> buf = str.<span class="title function_">substring</span>(start, i);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (buf != <span class="title class_">Number</span>(buf) || str.<span class="title function_">charAt</span>(i) !== <span class="string">&quot;-&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Illegal attachments&quot;</span>);</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          p.<span class="property">attachments</span> = <span class="title class_">Number</span>(buf);</span><br><span class="line">        &#125; <span class="comment">// look up namespace (if any)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;/&quot;</span> === str.<span class="title function_">charAt</span>(i + <span class="number">1</span>)) &#123;</span><br><span class="line">          <span class="keyword">var</span> _start = i + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">while</span> (++i) &#123;</span><br><span class="line">            <span class="keyword">var</span> c = str.<span class="title function_">charAt</span>(i);</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;,&quot;</span> === c) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span> (i === str.<span class="property">length</span>) <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          p.<span class="property">nsp</span> = str.<span class="title function_">substring</span>(_start, i);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          p.<span class="property">nsp</span> = <span class="string">&quot;/&quot;</span>;</span><br><span class="line">        &#125; <span class="comment">// look up id</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> next = str.<span class="title function_">charAt</span>(i + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;&quot;</span> !== next &amp;&amp; <span class="title class_">Number</span>(next) == next) &#123;</span><br><span class="line">          <span class="keyword">var</span> _start2 = i + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">while</span> (++i) &#123;</span><br><span class="line">            <span class="keyword">var</span> _c = str.<span class="title function_">charAt</span>(i);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> == _c || <span class="title class_">Number</span>(_c) != _c) &#123;</span><br><span class="line">              --i;</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (i === str.<span class="property">length</span>) <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          p.<span class="property">id</span> = <span class="title class_">Number</span>(str.<span class="title function_">substring</span>(_start2, i + <span class="number">1</span>));</span><br><span class="line">        &#125; <span class="comment">// look up json data</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (str.<span class="title function_">charAt</span>(++i)) &#123;</span><br><span class="line">          <span class="keyword">var</span> payload = <span class="variable language_">this</span>.<span class="title function_">tryParse</span>(str.<span class="title function_">substr</span>(i));</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (<span class="title class_">Decoder</span>.<span class="title function_">isPayloadValid</span>(p.<span class="property">type</span>, payload)) &#123;</span><br><span class="line">            p.<span class="property">data</span> = payload;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;invalid payload&quot;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;tryParse&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">tryParse</span>(<span class="params">str</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>(str, <span class="variable language_">this</span>.<span class="property">reviver</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;destroy&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>:</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Deallocates a parser&#x27;s resources</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">destroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">reconstructor</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">reconstructor</span>.<span class="title function_">finishedReconstruction</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;], [&#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;isPayloadValid&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">isPayloadValid</span>(<span class="params">type, payload</span>) &#123;</span><br><span class="line">        <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">CONNECT</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">_typeof</span>(payload) === <span class="string">&quot;object&quot;</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">DISCONNECT</span>:</span><br><span class="line">            <span class="keyword">return</span> payload === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">CONNECT_ERROR</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">typeof</span> payload === <span class="string">&quot;string&quot;</span> || <span class="title function_">_typeof</span>(payload) === <span class="string">&quot;object&quot;</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">EVENT</span>:</span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">BINARY_EVENT</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">isArray</span>(payload) &amp;&amp; payload.<span class="property">length</span> &gt; <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">ACK</span>:</span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">BINARY_ACK</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">isArray</span>(payload);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Decoder</span>;</span><br><span class="line">  &#125;(<span class="title class_">Emitter</span>);</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * A manager of a binary event&#x27;s &#x27;buffer sequence&#x27;. Should</span></span><br><span class="line"><span class="comment">   * be constructed whenever a packet of type BINARY_EVENT is</span></span><br><span class="line"><span class="comment">   * decoded.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">packet</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> &#123;<span class="type">BinaryReconstructor</span>&#125; initialized reconstructor</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">BinaryReconstructor</span> = <span class="comment">/*#__PURE__*/</span><span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">BinaryReconstructor</span>(<span class="params">packet</span>) &#123;</span><br><span class="line">      <span class="title function_">_classCallCheck</span>(<span class="variable language_">this</span>, <span class="title class_">BinaryReconstructor</span>);</span><br><span class="line"></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">packet</span> = packet;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">buffers</span> = [];</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">reconPack</span> = packet;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Method to be called when binary data received from connection</span></span><br><span class="line"><span class="comment">     * after a BINARY_EVENT packet.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Buffer | ArrayBuffer</span>&#125; <span class="variable">binData</span> - the raw binary data received</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="type">null | Object</span>&#125; returns null if more binary data is expected or</span></span><br><span class="line"><span class="comment">     *   a reconstructed packet object if all buffers have been received.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">_createClass</span>(<span class="title class_">BinaryReconstructor</span>, [&#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;takeBinaryData&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">takeBinaryData</span>(<span class="params">binData</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">buffers</span>.<span class="title function_">push</span>(binData);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">buffers</span>.<span class="property">length</span> === <span class="variable language_">this</span>.<span class="property">reconPack</span>.<span class="property">attachments</span>) &#123;</span><br><span class="line">          <span class="comment">// done with buffer list</span></span><br><span class="line">          <span class="keyword">var</span> packet = <span class="title function_">reconstructPacket</span>(<span class="variable language_">this</span>.<span class="property">reconPack</span>, <span class="variable language_">this</span>.<span class="property">buffers</span>);</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">finishedReconstruction</span>();</span><br><span class="line">          <span class="keyword">return</span> packet;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Cleans up binary packet reconstruction variables.</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;finishedReconstruction&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">finishedReconstruction</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">reconPack</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">buffers</span> = [];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">BinaryReconstructor</span>;</span><br><span class="line">  &#125;();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> parser = <span class="comment">/*#__PURE__*/</span><span class="title class_">Object</span>.<span class="title function_">freeze</span>(&#123;</span><br><span class="line">    <span class="attr">__proto__</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">protocol</span>: protocol,</span><br><span class="line">    get <span class="title class_">PacketType</span> () &#123; <span class="keyword">return</span> <span class="title class_">PacketType</span>; &#125;,</span><br><span class="line">    <span class="title class_">Encoder</span>: <span class="title class_">Encoder</span>,</span><br><span class="line">    <span class="title class_">Decoder</span>: <span class="title class_">Decoder</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">on</span>(<span class="params">obj, ev, fn</span>) &#123;</span><br><span class="line">    obj.<span class="title function_">on</span>(ev, fn);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">subDestroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">      obj.<span class="title function_">off</span>(ev, fn);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Internal events.</span></span><br><span class="line"><span class="comment">   * These events can&#x27;t be emitted by the user.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="variable constant_">RESERVED_EVENTS</span> = <span class="title class_">Object</span>.<span class="title function_">freeze</span>(&#123;</span><br><span class="line">    <span class="attr">connect</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">connect_error</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">disconnect</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">disconnecting</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="comment">// EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener</span></span><br><span class="line">    <span class="attr">newListener</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">removeListener</span>: <span class="number">1</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">Socket</span> = <span class="comment">/*#__PURE__*/</span><span class="keyword">function</span> (<span class="params">_Emitter</span>) &#123;</span><br><span class="line">    <span class="title function_">_inherits</span>(<span class="title class_">Socket</span>, _Emitter);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> _super = <span class="title function_">_createSuper</span>(<span class="title class_">Socket</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * `Socket` constructor.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Socket</span>(<span class="params">io, nsp, opts</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> _this;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">_classCallCheck</span>(<span class="variable language_">this</span>, <span class="title class_">Socket</span>);</span><br><span class="line"></span><br><span class="line">      _this = _super.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">      _this.<span class="property">connected</span> = <span class="literal">false</span>;</span><br><span class="line">      _this.<span class="property">receiveBuffer</span> = [];</span><br><span class="line">      _this.<span class="property">sendBuffer</span> = [];</span><br><span class="line">      _this.<span class="property">ids</span> = <span class="number">0</span>;</span><br><span class="line">      _this.<span class="property">acks</span> = &#123;&#125;;</span><br><span class="line">      _this.<span class="property">flags</span> = &#123;&#125;;</span><br><span class="line">      _this.<span class="property">io</span> = io;</span><br><span class="line">      _this.<span class="property">nsp</span> = nsp;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (opts &amp;&amp; opts.<span class="property">auth</span>) &#123;</span><br><span class="line">        _this.<span class="property">auth</span> = opts.<span class="property">auth</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (_this.<span class="property">io</span>.<span class="property">_autoConnect</span>) _this.<span class="title function_">open</span>();</span><br><span class="line">      <span class="keyword">return</span> _this;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Whether the socket is currently disconnected</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">_createClass</span>(<span class="title class_">Socket</span>, [&#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;disconnected&quot;</span>,</span><br><span class="line">      <span class="attr">get</span>: <span class="keyword">function</span> <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> !<span class="variable language_">this</span>.<span class="property">connected</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Subscribe to open, close and packet events</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;subEvents&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">subEvents</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">subs</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">var</span> io = <span class="variable language_">this</span>.<span class="property">io</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">subs</span> = [<span class="title function_">on</span>(io, <span class="string">&quot;open&quot;</span>, <span class="variable language_">this</span>.<span class="property">onopen</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)), <span class="title function_">on</span>(io, <span class="string">&quot;packet&quot;</span>, <span class="variable language_">this</span>.<span class="property">onpacket</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)), <span class="title function_">on</span>(io, <span class="string">&quot;error&quot;</span>, <span class="variable language_">this</span>.<span class="property">onerror</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)), <span class="title function_">on</span>(io, <span class="string">&quot;close&quot;</span>, <span class="variable language_">this</span>.<span class="property">onclose</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>))];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Whether the Socket will try to reconnect when its Manager connects or reconnects</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;active&quot;</span>,</span><br><span class="line">      <span class="attr">get</span>: <span class="keyword">function</span> <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> !!<span class="variable language_">this</span>.<span class="property">subs</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * &quot;Opens&quot; the socket.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;connect&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">connect</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">connected</span>) <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">subEvents</span>();</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">io</span>[<span class="string">&quot;_reconnecting&quot;</span>]) <span class="variable language_">this</span>.<span class="property">io</span>.<span class="title function_">open</span>(); <span class="comment">// ensure open</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;open&quot;</span> === <span class="variable language_">this</span>.<span class="property">io</span>.<span class="property">_readyState</span>) <span class="variable language_">this</span>.<span class="title function_">onopen</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Alias for connect()</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;open&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">open</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">connect</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Sends a `message` event.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@return</span> <span class="variable">self</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;send&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">send</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> _len = <span class="variable language_">arguments</span>.<span class="property">length</span>, args = <span class="keyword">new</span> <span class="title class_">Array</span>(_len), _key = <span class="number">0</span>; _key &lt; _len; _key++) &#123;</span><br><span class="line">          args[_key] = <span class="variable language_">arguments</span>[_key];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        args.<span class="title function_">unshift</span>(<span class="string">&quot;message&quot;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">emit</span>.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Override `emit`.</span></span><br><span class="line"><span class="comment">       * If the event is in `events`, it&#x27;s emitted normally.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@return</span> <span class="variable">self</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;emit&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">emit</span>(<span class="params">ev</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable constant_">RESERVED_EVENTS</span>.<span class="title function_">hasOwnProperty</span>(ev)) &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;&quot;&#x27;</span> + ev + <span class="string">&#x27;&quot; is a reserved event name&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> _len2 = <span class="variable language_">arguments</span>.<span class="property">length</span>, args = <span class="keyword">new</span> <span class="title class_">Array</span>(_len2 &gt; <span class="number">1</span> ? _len2 - <span class="number">1</span> : <span class="number">0</span>), _key2 = <span class="number">1</span>; _key2 &lt; _len2; _key2++) &#123;</span><br><span class="line">          args[_key2 - <span class="number">1</span>] = <span class="variable language_">arguments</span>[_key2];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        args.<span class="title function_">unshift</span>(ev);</span><br><span class="line">        <span class="keyword">var</span> packet = &#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="title class_">PacketType</span>.<span class="property">EVENT</span>,</span><br><span class="line">          <span class="attr">data</span>: args</span><br><span class="line">        &#125;;</span><br><span class="line">        packet.<span class="property">options</span> = &#123;&#125;;</span><br><span class="line">        packet.<span class="property">options</span>.<span class="property">compress</span> = <span class="variable language_">this</span>.<span class="property">flags</span>.<span class="property">compress</span> !== <span class="literal">false</span>; <span class="comment">// event ack callback</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;function&quot;</span> === <span class="keyword">typeof</span> args[args.<span class="property">length</span> - <span class="number">1</span>]) &#123;</span><br><span class="line">          <span class="keyword">var</span> id = <span class="variable language_">this</span>.<span class="property">ids</span>++;</span><br><span class="line">          <span class="keyword">var</span> ack = args.<span class="title function_">pop</span>();</span><br><span class="line"></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">_registerAckCallback</span>(id, ack);</span><br><span class="line"></span><br><span class="line">          packet.<span class="property">id</span> = id;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> isTransportWritable = <span class="variable language_">this</span>.<span class="property">io</span>.<span class="property">engine</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">io</span>.<span class="property">engine</span>.<span class="property">transport</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">io</span>.<span class="property">engine</span>.<span class="property">transport</span>.<span class="property">writable</span>;</span><br><span class="line">        <span class="keyword">var</span> discardPacket = <span class="variable language_">this</span>.<span class="property">flags</span>[<span class="string">&quot;volatile&quot;</span>] &amp;&amp; (!isTransportWritable || !<span class="variable language_">this</span>.<span class="property">connected</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (discardPacket) ; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">connected</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">notifyOutgoingListeners</span>(packet);</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">packet</span>(packet);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">sendBuffer</span>.<span class="title function_">push</span>(packet);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">flags</span> = &#123;&#125;;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;_registerAckCallback&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">_registerAckCallback</span>(<span class="params">id, ack</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this2 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> timeout = <span class="variable language_">this</span>.<span class="property">flags</span>.<span class="property">timeout</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (timeout === <span class="literal">undefined</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">acks</span>[id] = ack;</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125; <span class="comment">// @ts-ignore</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> timer = <span class="variable language_">this</span>.<span class="property">io</span>.<span class="title function_">setTimeoutFn</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">delete</span> _this2.<span class="property">acks</span>[id];</span><br><span class="line"></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; _this2.<span class="property">sendBuffer</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (_this2.<span class="property">sendBuffer</span>[i].<span class="property">id</span> === id) &#123;</span><br><span class="line">              _this2.<span class="property">sendBuffer</span>.<span class="title function_">splice</span>(i, <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          ack.<span class="title function_">call</span>(_this2, <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;operation has timed out&quot;</span>));</span><br><span class="line">        &#125;, timeout);</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">acks</span>[id] = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="comment">// @ts-ignore</span></span><br><span class="line">          _this2.<span class="property">io</span>.<span class="title function_">clearTimeoutFn</span>(timer);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> _len3 = <span class="variable language_">arguments</span>.<span class="property">length</span>, args = <span class="keyword">new</span> <span class="title class_">Array</span>(_len3), _key3 = <span class="number">0</span>; _key3 &lt; _len3; _key3++) &#123;</span><br><span class="line">            args[_key3] = <span class="variable language_">arguments</span>[_key3];</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          ack.<span class="title function_">apply</span>(_this2, [<span class="literal">null</span>].<span class="title function_">concat</span>(args));</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Sends a packet.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">packet</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;packet&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">packet</span>(<span class="params">_packet</span>) &#123;</span><br><span class="line">        _packet.<span class="property">nsp</span> = <span class="variable language_">this</span>.<span class="property">nsp</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">io</span>.<span class="title function_">_packet</span>(_packet);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon engine `open`.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onopen&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onopen</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this3 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">this</span>.<span class="property">auth</span> == <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">auth</span>(<span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">            _this3.<span class="title function_">packet</span>(&#123;</span><br><span class="line">              <span class="attr">type</span>: <span class="title class_">PacketType</span>.<span class="property">CONNECT</span>,</span><br><span class="line">              <span class="attr">data</span>: data</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">packet</span>(&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">PacketType</span>.<span class="property">CONNECT</span>,</span><br><span class="line">            <span class="attr">data</span>: <span class="variable language_">this</span>.<span class="property">auth</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon engine or manager `error`.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">err</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onerror&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onerror</span>(<span class="params">err</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">connected</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;connect_error&quot;</span>, err);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon engine `close`.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">reason</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">description</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onclose&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onclose</span>(<span class="params">reason, description</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">connected</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">delete</span> <span class="variable language_">this</span>.<span class="property">id</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;disconnect&quot;</span>, reason, description);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called with socket packet.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">packet</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onpacket&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onpacket</span>(<span class="params">packet</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> sameNamespace = packet.<span class="property">nsp</span> === <span class="variable language_">this</span>.<span class="property">nsp</span>;</span><br><span class="line">        <span class="keyword">if</span> (!sameNamespace) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (packet.<span class="property">type</span>) &#123;</span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">CONNECT</span>:</span><br><span class="line">            <span class="keyword">if</span> (packet.<span class="property">data</span> &amp;&amp; packet.<span class="property">data</span>.<span class="property">sid</span>) &#123;</span><br><span class="line">              <span class="keyword">var</span> id = packet.<span class="property">data</span>.<span class="property">sid</span>;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">onconnect</span>(id);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;connect_error&quot;</span>, <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">EVENT</span>:</span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">BINARY_EVENT</span>:</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">onevent</span>(packet);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">ACK</span>:</span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">BINARY_ACK</span>:</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">onack</span>(packet);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">DISCONNECT</span>:</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">ondisconnect</span>();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">case</span> <span class="title class_">PacketType</span>.<span class="property">CONNECT_ERROR</span>:</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">destroy</span>();</span><br><span class="line">            <span class="keyword">var</span> err = <span class="keyword">new</span> <span class="title class_">Error</span>(packet.<span class="property">data</span>.<span class="property">message</span>); <span class="comment">// @ts-ignore</span></span><br><span class="line"></span><br><span class="line">            err.<span class="property">data</span> = packet.<span class="property">data</span>.<span class="property">data</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;connect_error&quot;</span>, err);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon a server event.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">packet</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onevent&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onevent</span>(<span class="params">packet</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> args = packet.<span class="property">data</span> || [];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != packet.<span class="property">id</span>) &#123;</span><br><span class="line">          args.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="title function_">ack</span>(packet.<span class="property">id</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">connected</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">emitEvent</span>(args);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">receiveBuffer</span>.<span class="title function_">push</span>(<span class="title class_">Object</span>.<span class="title function_">freeze</span>(args));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;emitEvent&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">emitEvent</span>(<span class="params">args</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_anyListeners</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">_anyListeners</span>.<span class="property">length</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> listeners = <span class="variable language_">this</span>.<span class="property">_anyListeners</span>.<span class="title function_">slice</span>();</span><br><span class="line"></span><br><span class="line">          <span class="keyword">var</span> _iterator = <span class="title function_">_createForOfIteratorHelper</span>(listeners),</span><br><span class="line">              _step;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (_iterator.<span class="title function_">s</span>(); !(_step = _iterator.<span class="title function_">n</span>()).<span class="property">done</span>;) &#123;</span><br><span class="line">              <span class="keyword">var</span> listener = _step.<span class="property">value</span>;</span><br><span class="line">              listener.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            _iterator.<span class="title function_">e</span>(err);</span><br><span class="line">          &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            _iterator.<span class="title function_">f</span>();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">_get</span>(<span class="title function_">_getPrototypeOf</span>(<span class="title class_">Socket</span>.<span class="property"><span class="keyword">prototype</span></span>), <span class="string">&quot;emit&quot;</span>, <span class="variable language_">this</span>).<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Produces an ack callback to emit with an event.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;ack&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">ack</span>(<span class="params">id</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> self = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">var</span> sent = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="comment">// prevent double callbacks</span></span><br><span class="line">          <span class="keyword">if</span> (sent) <span class="keyword">return</span>;</span><br><span class="line">          sent = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> _len4 = <span class="variable language_">arguments</span>.<span class="property">length</span>, args = <span class="keyword">new</span> <span class="title class_">Array</span>(_len4), _key4 = <span class="number">0</span>; _key4 &lt; _len4; _key4++) &#123;</span><br><span class="line">            args[_key4] = <span class="variable language_">arguments</span>[_key4];</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          self.<span class="title function_">packet</span>(&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">PacketType</span>.<span class="property">ACK</span>,</span><br><span class="line">            <span class="attr">id</span>: id,</span><br><span class="line">            <span class="attr">data</span>: args</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon a server acknowlegement.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">packet</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onack&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onack</span>(<span class="params">packet</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> ack = <span class="variable language_">this</span>.<span class="property">acks</span>[packet.<span class="property">id</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;function&quot;</span> === <span class="keyword">typeof</span> ack) &#123;</span><br><span class="line">          ack.<span class="title function_">apply</span>(<span class="variable language_">this</span>, packet.<span class="property">data</span>);</span><br><span class="line">          <span class="keyword">delete</span> <span class="variable language_">this</span>.<span class="property">acks</span>[packet.<span class="property">id</span>];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon server connect.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onconnect&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onconnect</span>(<span class="params">id</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">id</span> = id;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">connected</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitBuffered</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;connect&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Emit buffered events (received and emitted).</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;emitBuffered&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">emitBuffered</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this4 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">receiveBuffer</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> _this4.<span class="title function_">emitEvent</span>(args);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">receiveBuffer</span> = [];</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">sendBuffer</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">packet</span>) &#123;</span><br><span class="line">          _this4.<span class="title function_">notifyOutgoingListeners</span>(packet);</span><br><span class="line"></span><br><span class="line">          _this4.<span class="title function_">packet</span>(packet);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">sendBuffer</span> = [];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon server disconnect.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;ondisconnect&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">ondisconnect</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">destroy</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">onclose</span>(<span class="string">&quot;io server disconnect&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon forced client/server side disconnections,</span></span><br><span class="line"><span class="comment">       * this method ensures the manager stops tracking us and</span></span><br><span class="line"><span class="comment">       * that reconnections don&#x27;t get triggered for this.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;destroy&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">destroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">subs</span>) &#123;</span><br><span class="line">          <span class="comment">// clean subscriptions to avoid reconnections</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">subs</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">subDestroy</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">subDestroy</span>();</span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">subs</span> = <span class="literal">undefined</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">io</span>[<span class="string">&quot;_destroy&quot;</span>](<span class="variable language_">this</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Disconnects the socket manually.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@return</span> <span class="variable">self</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;disconnect&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">disconnect</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">connected</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">packet</span>(&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">PacketType</span>.<span class="property">DISCONNECT</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; <span class="comment">// remove socket from pool</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">destroy</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">connected</span>) &#123;</span><br><span class="line">          <span class="comment">// fire events</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">onclose</span>(<span class="string">&quot;io client disconnect&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Alias for disconnect()</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@return</span> <span class="variable">self</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;close&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">close</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">disconnect</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Sets the compress flag.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">compress</span> - if `true`, compresses the sending data</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@return</span> <span class="variable">self</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;compress&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">compress</span>(<span class="params">_compress</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">flags</span>.<span class="property">compress</span> = _compress;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not</span></span><br><span class="line"><span class="comment">       * ready to send messages.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@returns</span> <span class="variable">self</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;volatile&quot;</span>,</span><br><span class="line">      <span class="attr">get</span>: <span class="keyword">function</span> <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">flags</span>[<span class="string">&quot;volatile&quot;</span>] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Sets a modifier for a subsequent event emission that the callback will be called with an error when the</span></span><br><span class="line"><span class="comment">       * given number of milliseconds have elapsed without an acknowledgement from the server:</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * ```</span></span><br><span class="line"><span class="comment">       * socket.timeout(5000).emit(&quot;my-event&quot;, (err) =&gt; &#123;</span></span><br><span class="line"><span class="comment">       *   if (err) &#123;</span></span><br><span class="line"><span class="comment">       *     // the server did not acknowledge the event in the given delay</span></span><br><span class="line"><span class="comment">       *   &#125;</span></span><br><span class="line"><span class="comment">       * &#125;);</span></span><br><span class="line"><span class="comment">       * ```</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@returns</span> <span class="variable">self</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;timeout&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">timeout</span>(<span class="params">_timeout</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">flags</span>.<span class="property">timeout</span> = _timeout;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the</span></span><br><span class="line"><span class="comment">       * callback.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">listener</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onAny&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onAny</span>(<span class="params">listener</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_anyListeners</span> = <span class="variable language_">this</span>.<span class="property">_anyListeners</span> || [];</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_anyListeners</span>.<span class="title function_">push</span>(listener);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the</span></span><br><span class="line"><span class="comment">       * callback. The listener is added to the beginning of the listeners array.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">listener</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;prependAny&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">prependAny</span>(<span class="params">listener</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_anyListeners</span> = <span class="variable language_">this</span>.<span class="property">_anyListeners</span> || [];</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_anyListeners</span>.<span class="title function_">unshift</span>(listener);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Removes the listener that will be fired when any event is emitted.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">listener</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;offAny&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">offAny</span>(<span class="params">listener</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">_anyListeners</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (listener) &#123;</span><br><span class="line">          <span class="keyword">var</span> listeners = <span class="variable language_">this</span>.<span class="property">_anyListeners</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; listeners.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (listener === listeners[i]) &#123;</span><br><span class="line">              listeners.<span class="title function_">splice</span>(i, <span class="number">1</span>);</span><br><span class="line">              <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">_anyListeners</span> = [];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,</span></span><br><span class="line"><span class="comment">       * e.g. to remove listeners.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;listenersAny&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">listenersAny</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_anyListeners</span> || [];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the</span></span><br><span class="line"><span class="comment">       * callback.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">listener</span></span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * &lt;pre&gt;&lt;code&gt;</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * socket.onAnyOutgoing((event, ...args) =&gt; &#123;</span></span><br><span class="line"><span class="comment">       *   console.log(event);</span></span><br><span class="line"><span class="comment">       * &#125;);</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * &lt;/pre&gt;&lt;/code&gt;</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onAnyOutgoing&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onAnyOutgoing</span>(<span class="params">listener</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_anyOutgoingListeners</span> = <span class="variable language_">this</span>.<span class="property">_anyOutgoingListeners</span> || [];</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_anyOutgoingListeners</span>.<span class="title function_">push</span>(listener);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the</span></span><br><span class="line"><span class="comment">       * callback. The listener is added to the beginning of the listeners array.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">listener</span></span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * &lt;pre&gt;&lt;code&gt;</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * socket.prependAnyOutgoing((event, ...args) =&gt; &#123;</span></span><br><span class="line"><span class="comment">       *   console.log(event);</span></span><br><span class="line"><span class="comment">       * &#125;);</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * &lt;/pre&gt;&lt;/code&gt;</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;prependAnyOutgoing&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">prependAnyOutgoing</span>(<span class="params">listener</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_anyOutgoingListeners</span> = <span class="variable language_">this</span>.<span class="property">_anyOutgoingListeners</span> || [];</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_anyOutgoingListeners</span>.<span class="title function_">unshift</span>(listener);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Removes the listener that will be fired when any event is emitted.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">listener</span></span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * &lt;pre&gt;&lt;code&gt;</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * const handler = (event, ...args) =&gt; &#123;</span></span><br><span class="line"><span class="comment">       *   console.log(event);</span></span><br><span class="line"><span class="comment">       * &#125;</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * socket.onAnyOutgoing(handler);</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * // then later</span></span><br><span class="line"><span class="comment">       * socket.offAnyOutgoing(handler);</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * &lt;/pre&gt;&lt;/code&gt;</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;offAnyOutgoing&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">offAnyOutgoing</span>(<span class="params">listener</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">_anyOutgoingListeners</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (listener) &#123;</span><br><span class="line">          <span class="keyword">var</span> listeners = <span class="variable language_">this</span>.<span class="property">_anyOutgoingListeners</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; listeners.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (listener === listeners[i]) &#123;</span><br><span class="line">              listeners.<span class="title function_">splice</span>(i, <span class="number">1</span>);</span><br><span class="line">              <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">_anyOutgoingListeners</span> = [];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,</span></span><br><span class="line"><span class="comment">       * e.g. to remove listeners.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;listenersAnyOutgoing&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">listenersAnyOutgoing</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_anyOutgoingListeners</span> || [];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Notify the listeners for each packet sent</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">packet</span></span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;notifyOutgoingListeners&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">notifyOutgoingListeners</span>(<span class="params">packet</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_anyOutgoingListeners</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">_anyOutgoingListeners</span>.<span class="property">length</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> listeners = <span class="variable language_">this</span>.<span class="property">_anyOutgoingListeners</span>.<span class="title function_">slice</span>();</span><br><span class="line"></span><br><span class="line">          <span class="keyword">var</span> _iterator2 = <span class="title function_">_createForOfIteratorHelper</span>(listeners),</span><br><span class="line">              _step2;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (_iterator2.<span class="title function_">s</span>(); !(_step2 = _iterator2.<span class="title function_">n</span>()).<span class="property">done</span>;) &#123;</span><br><span class="line">              <span class="keyword">var</span> listener = _step2.<span class="property">value</span>;</span><br><span class="line">              listener.<span class="title function_">apply</span>(<span class="variable language_">this</span>, packet.<span class="property">data</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            _iterator2.<span class="title function_">e</span>(err);</span><br><span class="line">          &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            _iterator2.<span class="title function_">f</span>();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Socket</span>;</span><br><span class="line">  &#125;(<span class="title class_">Emitter</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Initialize backoff timer with `opts`.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * - `min` initial timeout in milliseconds [100]</span></span><br><span class="line"><span class="comment">   * - `max` max timeout [10000]</span></span><br><span class="line"><span class="comment">   * - `jitter` [0]</span></span><br><span class="line"><span class="comment">   * - `factor` [2]</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">opts</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">Backoff</span>(<span class="params">opts</span>) &#123;</span><br><span class="line">    opts = opts || &#123;&#125;;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">ms</span> = opts.<span class="property">min</span> || <span class="number">100</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">max</span> = opts.<span class="property">max</span> || <span class="number">10000</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">factor</span> = opts.<span class="property">factor</span> || <span class="number">2</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">jitter</span> = opts.<span class="property">jitter</span> &gt; <span class="number">0</span> &amp;&amp; opts.<span class="property">jitter</span> &lt;= <span class="number">1</span> ? opts.<span class="property">jitter</span> : <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">attempts</span> = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Return the backoff duration.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> &#123;<span class="type">Number</span>&#125;</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Backoff</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">duration</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ms = <span class="variable language_">this</span>.<span class="property">ms</span> * <span class="title class_">Math</span>.<span class="title function_">pow</span>(<span class="variable language_">this</span>.<span class="property">factor</span>, <span class="variable language_">this</span>.<span class="property">attempts</span>++);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">jitter</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> rand = <span class="title class_">Math</span>.<span class="title function_">random</span>();</span><br><span class="line">      <span class="keyword">var</span> deviation = <span class="title class_">Math</span>.<span class="title function_">floor</span>(rand * <span class="variable language_">this</span>.<span class="property">jitter</span> * ms);</span><br><span class="line">      ms = (<span class="title class_">Math</span>.<span class="title function_">floor</span>(rand * <span class="number">10</span>) &amp; <span class="number">1</span>) == <span class="number">0</span> ? ms - deviation : ms + deviation;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">min</span>(ms, <span class="variable language_">this</span>.<span class="property">max</span>) | <span class="number">0</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Reset the number of attempts.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Backoff</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">reset</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">attempts</span> = <span class="number">0</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Set the minimum duration</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Backoff</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">setMin</span> = <span class="keyword">function</span> (<span class="params">min</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">ms</span> = min;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Set the maximum duration</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Backoff</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">setMax</span> = <span class="keyword">function</span> (<span class="params">max</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">max</span> = max;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Set the jitter</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api</span> <span class="variable">public</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Backoff</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">setJitter</span> = <span class="keyword">function</span> (<span class="params">jitter</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">jitter</span> = jitter;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">Manager</span> = <span class="comment">/*#__PURE__*/</span><span class="keyword">function</span> (<span class="params">_Emitter</span>) &#123;</span><br><span class="line">    <span class="title function_">_inherits</span>(<span class="title class_">Manager</span>, _Emitter);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> _super = <span class="title function_">_createSuper</span>(<span class="title class_">Manager</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Manager</span>(<span class="params">uri, opts</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> _this;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">_classCallCheck</span>(<span class="variable language_">this</span>, <span class="title class_">Manager</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> _a;</span><br><span class="line"></span><br><span class="line">      _this = _super.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">      _this.<span class="property">nsps</span> = &#123;&#125;;</span><br><span class="line">      _this.<span class="property">subs</span> = [];</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (uri &amp;&amp; <span class="string">&quot;object&quot;</span> === <span class="title function_">_typeof</span>(uri)) &#123;</span><br><span class="line">        opts = uri;</span><br><span class="line">        uri = <span class="literal">undefined</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      opts = opts || &#123;&#125;;</span><br><span class="line">      opts.<span class="property">path</span> = opts.<span class="property">path</span> || <span class="string">&quot;/socket.io&quot;</span>;</span><br><span class="line">      _this.<span class="property">opts</span> = opts;</span><br><span class="line">      <span class="title function_">installTimerFunctions</span>(<span class="title function_">_assertThisInitialized</span>(_this), opts);</span><br><span class="line"></span><br><span class="line">      _this.<span class="title function_">reconnection</span>(opts.<span class="property">reconnection</span> !== <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">      _this.<span class="title function_">reconnectionAttempts</span>(opts.<span class="property">reconnectionAttempts</span> || <span class="title class_">Infinity</span>);</span><br><span class="line"></span><br><span class="line">      _this.<span class="title function_">reconnectionDelay</span>(opts.<span class="property">reconnectionDelay</span> || <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">      _this.<span class="title function_">reconnectionDelayMax</span>(opts.<span class="property">reconnectionDelayMax</span> || <span class="number">5000</span>);</span><br><span class="line"></span><br><span class="line">      _this.<span class="title function_">randomizationFactor</span>((_a = opts.<span class="property">randomizationFactor</span>) !== <span class="literal">null</span> &amp;&amp; _a !== <span class="keyword">void</span> <span class="number">0</span> ? _a : <span class="number">0.5</span>);</span><br><span class="line"></span><br><span class="line">      _this.<span class="property">backoff</span> = <span class="keyword">new</span> <span class="title class_">Backoff</span>(&#123;</span><br><span class="line">        <span class="attr">min</span>: _this.<span class="title function_">reconnectionDelay</span>(),</span><br><span class="line">        <span class="attr">max</span>: _this.<span class="title function_">reconnectionDelayMax</span>(),</span><br><span class="line">        <span class="attr">jitter</span>: _this.<span class="title function_">randomizationFactor</span>()</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      _this.<span class="title function_">timeout</span>(<span class="literal">null</span> == opts.<span class="property">timeout</span> ? <span class="number">20000</span> : opts.<span class="property">timeout</span>);</span><br><span class="line"></span><br><span class="line">      _this.<span class="property">_readyState</span> = <span class="string">&quot;closed&quot;</span>;</span><br><span class="line">      _this.<span class="property">uri</span> = uri;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> _parser = opts.<span class="property">parser</span> || parser;</span><br><span class="line"></span><br><span class="line">      _this.<span class="property">encoder</span> = <span class="keyword">new</span> _parser.<span class="title class_">Encoder</span>();</span><br><span class="line">      _this.<span class="property">decoder</span> = <span class="keyword">new</span> _parser.<span class="title class_">Decoder</span>();</span><br><span class="line">      _this.<span class="property">_autoConnect</span> = opts.<span class="property">autoConnect</span> !== <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">if</span> (_this.<span class="property">_autoConnect</span>) _this.<span class="title function_">open</span>();</span><br><span class="line">      <span class="keyword">return</span> _this;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">_createClass</span>(<span class="title class_">Manager</span>, [&#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;reconnection&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">reconnection</span>(<span class="params">v</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">arguments</span>.<span class="property">length</span>) <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_reconnection</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_reconnection</span> = !!v;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;reconnectionAttempts&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">reconnectionAttempts</span>(<span class="params">v</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v === <span class="literal">undefined</span>) <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_reconnectionAttempts</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_reconnectionAttempts</span> = v;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;reconnectionDelay&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">reconnectionDelay</span>(<span class="params">v</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _a;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (v === <span class="literal">undefined</span>) <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_reconnectionDelay</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_reconnectionDelay</span> = v;</span><br><span class="line">        (_a = <span class="variable language_">this</span>.<span class="property">backoff</span>) === <span class="literal">null</span> || _a === <span class="keyword">void</span> <span class="number">0</span> ? <span class="keyword">void</span> <span class="number">0</span> : _a.<span class="title function_">setMin</span>(v);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;randomizationFactor&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">randomizationFactor</span>(<span class="params">v</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _a;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (v === <span class="literal">undefined</span>) <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_randomizationFactor</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_randomizationFactor</span> = v;</span><br><span class="line">        (_a = <span class="variable language_">this</span>.<span class="property">backoff</span>) === <span class="literal">null</span> || _a === <span class="keyword">void</span> <span class="number">0</span> ? <span class="keyword">void</span> <span class="number">0</span> : _a.<span class="title function_">setJitter</span>(v);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;reconnectionDelayMax&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">reconnectionDelayMax</span>(<span class="params">v</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _a;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (v === <span class="literal">undefined</span>) <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_reconnectionDelayMax</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_reconnectionDelayMax</span> = v;</span><br><span class="line">        (_a = <span class="variable language_">this</span>.<span class="property">backoff</span>) === <span class="literal">null</span> || _a === <span class="keyword">void</span> <span class="number">0</span> ? <span class="keyword">void</span> <span class="number">0</span> : _a.<span class="title function_">setMax</span>(v);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;timeout&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">timeout</span>(<span class="params">v</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">arguments</span>.<span class="property">length</span>) <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_timeout</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_timeout</span> = v;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Starts trying to reconnect if reconnection is enabled and we have not</span></span><br><span class="line"><span class="comment">       * started reconnecting yet</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;maybeReconnectOnOpen&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">maybeReconnectOnOpen</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// Only try to reconnect if it&#x27;s the first time we&#x27;re connecting</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">_reconnecting</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">_reconnection</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">backoff</span>.<span class="property">attempts</span> === <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="comment">// keeps reconnection from firing twice for the same reconnection loop</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">reconnect</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Sets the current transport `socket`.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; <span class="variable">fn</span> - optional, callback</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@return</span> <span class="variable">self</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;open&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">open</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this2 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (~<span class="variable language_">this</span>.<span class="property">_readyState</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;open&quot;</span>)) <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">engine</span> = <span class="keyword">new</span> <span class="title class_">Socket</span>$1(<span class="variable language_">this</span>.<span class="property">uri</span>, <span class="variable language_">this</span>.<span class="property">opts</span>);</span><br><span class="line">        <span class="keyword">var</span> socket = <span class="variable language_">this</span>.<span class="property">engine</span>;</span><br><span class="line">        <span class="keyword">var</span> self = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_readyState</span> = <span class="string">&quot;opening&quot;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">skipReconnect</span> = <span class="literal">false</span>; <span class="comment">// emit `open`</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> openSubDestroy = <span class="title function_">on</span>(socket, <span class="string">&quot;open&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          self.<span class="title function_">onopen</span>();</span><br><span class="line">          fn &amp;&amp; <span class="title function_">fn</span>();</span><br><span class="line">        &#125;); <span class="comment">// emit `error`</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> errorSub = <span class="title function_">on</span>(socket, <span class="string">&quot;error&quot;</span>, <span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">          self.<span class="title function_">cleanup</span>();</span><br><span class="line">          self.<span class="property">_readyState</span> = <span class="string">&quot;closed&quot;</span>;</span><br><span class="line"></span><br><span class="line">          _this2.<span class="title function_">emitReserved</span>(<span class="string">&quot;error&quot;</span>, err);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (fn) &#123;</span><br><span class="line">            <span class="title function_">fn</span>(err);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Only do this if there is no fn to handle the error</span></span><br><span class="line">            self.<span class="title function_">maybeReconnectOnOpen</span>();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">false</span> !== <span class="variable language_">this</span>.<span class="property">_timeout</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> timeout = <span class="variable language_">this</span>.<span class="property">_timeout</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (timeout === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="title function_">openSubDestroy</span>(); <span class="comment">// prevents a race condition with the &#x27;open&#x27; event</span></span><br><span class="line">          &#125; <span class="comment">// set timer</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          <span class="keyword">var</span> timer = <span class="variable language_">this</span>.<span class="title function_">setTimeoutFn</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">openSubDestroy</span>();</span><br><span class="line">            socket.<span class="title function_">close</span>(); <span class="comment">// @ts-ignore</span></span><br><span class="line"></span><br><span class="line">            socket.<span class="title function_">emit</span>(<span class="string">&quot;error&quot;</span>, <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;timeout&quot;</span>));</span><br><span class="line">          &#125;, timeout);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">autoUnref</span>) &#123;</span><br><span class="line">            timer.<span class="title function_">unref</span>();</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">subs</span>.<span class="title function_">push</span>(<span class="keyword">function</span> <span class="title function_">subDestroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">subs</span>.<span class="title function_">push</span>(openSubDestroy);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">subs</span>.<span class="title function_">push</span>(errorSub);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Alias for open()</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@return</span> <span class="variable">self</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;connect&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">connect</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">open</span>(fn);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon transport open.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onopen&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onopen</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// clear old subs</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">cleanup</span>(); <span class="comment">// mark as open</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_readyState</span> = <span class="string">&quot;open&quot;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;open&quot;</span>); <span class="comment">// add new subs</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> socket = <span class="variable language_">this</span>.<span class="property">engine</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">subs</span>.<span class="title function_">push</span>(<span class="title function_">on</span>(socket, <span class="string">&quot;ping&quot;</span>, <span class="variable language_">this</span>.<span class="property">onping</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)), <span class="title function_">on</span>(socket, <span class="string">&quot;data&quot;</span>, <span class="variable language_">this</span>.<span class="property">ondata</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)), <span class="title function_">on</span>(socket, <span class="string">&quot;error&quot;</span>, <span class="variable language_">this</span>.<span class="property">onerror</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)), <span class="title function_">on</span>(socket, <span class="string">&quot;close&quot;</span>, <span class="variable language_">this</span>.<span class="property">onclose</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)), <span class="title function_">on</span>(<span class="variable language_">this</span>.<span class="property">decoder</span>, <span class="string">&quot;decoded&quot;</span>, <span class="variable language_">this</span>.<span class="property">ondecoded</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon a ping.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onping&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onping</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;ping&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called with data.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;ondata&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">ondata</span>(<span class="params">data</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">decoder</span>.<span class="title function_">add</span>(data);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called when parser fully decodes a packet.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;ondecoded&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">ondecoded</span>(<span class="params">packet</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;packet&quot;</span>, packet);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon socket error.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onerror&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onerror</span>(<span class="params">err</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;error&quot;</span>, err);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Creates a new socket for the given `nsp`.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@return</span> &#123;<span class="type">Socket</span>&#125;</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@public</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;socket&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">socket</span>(<span class="params">nsp, opts</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> socket = <span class="variable language_">this</span>.<span class="property">nsps</span>[nsp];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!socket) &#123;</span><br><span class="line">          socket = <span class="keyword">new</span> <span class="title class_">Socket</span>(<span class="variable language_">this</span>, nsp, opts);</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">nsps</span>[nsp] = socket;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> socket;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon a socket close.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">socket</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;_destroy&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">_destroy</span>(<span class="params">socket</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> nsps = <span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="variable language_">this</span>.<span class="property">nsps</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> _i = <span class="number">0</span>, _nsps = nsps; _i &lt; _nsps.<span class="property">length</span>; _i++) &#123;</span><br><span class="line">          <span class="keyword">var</span> nsp = _nsps[_i];</span><br><span class="line">          <span class="keyword">var</span> _socket = <span class="variable language_">this</span>.<span class="property">nsps</span>[nsp];</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (_socket.<span class="property">active</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_close</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Writes a packet.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> <span class="variable">packet</span></span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;_packet&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">_packet</span>(<span class="params">packet</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> encodedPackets = <span class="variable language_">this</span>.<span class="property">encoder</span>.<span class="title function_">encode</span>(packet);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; encodedPackets.<span class="property">length</span>; i++) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">engine</span>.<span class="title function_">write</span>(encodedPackets[i], packet.<span class="property">options</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Clean up transport subscriptions and packet buffer.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;cleanup&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">cleanup</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">subs</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">subDestroy</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title function_">subDestroy</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">subs</span>.<span class="property">length</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">decoder</span>.<span class="title function_">destroy</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Close the current socket.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;_close&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">_close</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">skipReconnect</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_reconnecting</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">onclose</span>(<span class="string">&quot;forced close&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">engine</span>) <span class="variable language_">this</span>.<span class="property">engine</span>.<span class="title function_">close</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Alias for close()</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;disconnect&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">disconnect</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">_close</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon engine close.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onclose&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onclose</span>(<span class="params">reason, description</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">cleanup</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">backoff</span>.<span class="title function_">reset</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_readyState</span> = <span class="string">&quot;closed&quot;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;close&quot;</span>, reason, description);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_reconnection</span> &amp;&amp; !<span class="variable language_">this</span>.<span class="property">skipReconnect</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">reconnect</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Attempt a reconnection.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;reconnect&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">reconnect</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _this3 = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_reconnecting</span> || <span class="variable language_">this</span>.<span class="property">skipReconnect</span>) <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">var</span> self = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">backoff</span>.<span class="property">attempts</span> &gt;= <span class="variable language_">this</span>.<span class="property">_reconnectionAttempts</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">backoff</span>.<span class="title function_">reset</span>();</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;reconnect_failed&quot;</span>);</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">_reconnecting</span> = <span class="literal">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">var</span> delay = <span class="variable language_">this</span>.<span class="property">backoff</span>.<span class="title function_">duration</span>();</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">_reconnecting</span> = <span class="literal">true</span>;</span><br><span class="line">          <span class="keyword">var</span> timer = <span class="variable language_">this</span>.<span class="title function_">setTimeoutFn</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (self.<span class="property">skipReconnect</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">            _this3.<span class="title function_">emitReserved</span>(<span class="string">&quot;reconnect_attempt&quot;</span>, self.<span class="property">backoff</span>.<span class="property">attempts</span>); <span class="comment">// check again for the case socket closed in above events</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (self.<span class="property">skipReconnect</span>) <span class="keyword">return</span>;</span><br><span class="line">            self.<span class="title function_">open</span>(<span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">              <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                self.<span class="property">_reconnecting</span> = <span class="literal">false</span>;</span><br><span class="line">                self.<span class="title function_">reconnect</span>();</span><br><span class="line"></span><br><span class="line">                _this3.<span class="title function_">emitReserved</span>(<span class="string">&quot;reconnect_error&quot;</span>, err);</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                self.<span class="title function_">onreconnect</span>();</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;, delay);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">opts</span>.<span class="property">autoUnref</span>) &#123;</span><br><span class="line">            timer.<span class="title function_">unref</span>();</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">subs</span>.<span class="title function_">push</span>(<span class="keyword">function</span> <span class="title function_">subDestroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Called upon successful reconnect.</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@private</span></span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&quot;onreconnect&quot;</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="keyword">function</span> <span class="title function_">onreconnect</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> attempt = <span class="variable language_">this</span>.<span class="property">backoff</span>.<span class="property">attempts</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_reconnecting</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">backoff</span>.<span class="title function_">reset</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">emitReserved</span>(<span class="string">&quot;reconnect&quot;</span>, attempt);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Manager</span>;</span><br><span class="line">  &#125;(<span class="title class_">Emitter</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Managers cache.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> cache = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">lookup</span>(<span class="params">uri, opts</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">_typeof</span>(uri) === <span class="string">&quot;object&quot;</span>) &#123;</span><br><span class="line">      opts = uri;</span><br><span class="line">      uri = <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    opts = opts || &#123;&#125;;</span><br><span class="line">    <span class="keyword">var</span> parsed = <span class="title function_">url</span>(uri, opts.<span class="property">path</span> || <span class="string">&quot;/socket.io&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> source = parsed.<span class="property">source</span>;</span><br><span class="line">    <span class="keyword">var</span> id = parsed.<span class="property">id</span>;</span><br><span class="line">    <span class="keyword">var</span> path = parsed.<span class="property">path</span>;</span><br><span class="line">    <span class="keyword">var</span> sameNamespace = cache[id] &amp;&amp; path <span class="keyword">in</span> cache[id][<span class="string">&quot;nsps&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> newConnection = opts.<span class="property">forceNew</span> || opts[<span class="string">&quot;force new connection&quot;</span>] || <span class="literal">false</span> === opts.<span class="property">multiplex</span> || sameNamespace;</span><br><span class="line">    <span class="keyword">var</span> io;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (newConnection) &#123;</span><br><span class="line">      io = <span class="keyword">new</span> <span class="title class_">Manager</span>(source, opts);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!cache[id]) &#123;</span><br><span class="line">        cache[id] = <span class="keyword">new</span> <span class="title class_">Manager</span>(source, opts);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      io = cache[id];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (parsed.<span class="property">query</span> &amp;&amp; !opts.<span class="property">query</span>) &#123;</span><br><span class="line">      opts.<span class="property">query</span> = parsed.<span class="property">queryKey</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> io.<span class="title function_">socket</span>(parsed.<span class="property">path</span>, opts);</span><br><span class="line">  &#125; <span class="comment">// so that &quot;lookup&quot; can be used both as a function (e.g. `io(...)`) and as a</span></span><br><span class="line">  <span class="comment">// namespace (e.g. `io.connect(...)`), for backward compatibility</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="title function_">_extends</span>(lookup, &#123;</span><br><span class="line">    <span class="title class_">Manager</span>: <span class="title class_">Manager</span>,</span><br><span class="line">    <span class="title class_">Socket</span>: <span class="title class_">Socket</span>,</span><br><span class="line">    <span class="attr">io</span>: lookup,</span><br><span class="line">    <span class="attr">connect</span>: lookup</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> lookup;</span><br><span class="line"></span><br><span class="line">&#125;));</span><br><span class="line"><span class="comment">//# sourceMappingURL=socket.io.js.map</span></span><br></pre></td></tr></table></figure>
<h3 id="socket-io-js-map"><a href="#socket-io-js-map" class="headerlink" title="socket.io.js.map"></a>socket.io.js.map</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;version&quot;:3,&quot;file&quot;:&quot;socket.io.js&quot;,&quot;sources&quot;:[&quot;../node_modules/engine.io-client/node_modules/engine.io-parser/build/esm/commons.js&quot;,&quot;../node_modules/engine.io-client/node_modules/engine.io-parser/build/esm/encodePacket.browser.js&quot;,&quot;../node_modules/@socket.io/base64-arraybuffer/dist/base64-arraybuffer.es5.js&quot;,&quot;../node_modules/engine.io-client/node_modules/engine.io-parser/build/esm/decodePacket.browser.js&quot;,&quot;../node_modules/engine.io-client/node_modules/engine.io-parser/build/esm/index.js&quot;,&quot;../node_modules/@socket.io/component-emitter/index.mjs&quot;,&quot;../node_modules/engine.io-client/build/esm/globalThis.browser.js&quot;,&quot;../node_modules/engine.io-client/build/esm/util.js&quot;,&quot;../node_modules/engine.io-client/build/esm/transport.js&quot;,&quot;../node_modules/engine.io-client/build/esm/contrib/yeast.js&quot;,&quot;../node_modules/engine.io-client/build/esm/contrib/parseqs.js&quot;,&quot;../node_modules/engine.io-client/build/esm/contrib/has-cors.js&quot;,&quot;../node_modules/engine.io-client/build/esm/transports/xmlhttprequest.browser.js&quot;,&quot;../node_modules/engine.io-client/build/esm/transports/polling.js&quot;,&quot;../node_modules/engine.io-client/build/esm/transports/websocket-constructor.browser.js&quot;,&quot;../node_modules/engine.io-client/build/esm/transports/websocket.js&quot;,&quot;../node_modules/engine.io-client/build/esm/transports/index.js&quot;,&quot;../node_modules/engine.io-client/build/esm/contrib/parseuri.js&quot;,&quot;../node_modules/engine.io-client/build/esm/socket.js&quot;,&quot;../build/esm/url.js&quot;,&quot;../node_modules/socket.io-parser/build/esm/is-binary.js&quot;,&quot;../node_modules/socket.io-parser/build/esm/binary.js&quot;,&quot;../node_modules/socket.io-parser/build/esm/index.js&quot;,&quot;../build/esm/on.js&quot;,&quot;../build/esm/socket.js&quot;,&quot;../build/esm/contrib/backo2.js&quot;,&quot;../build/esm/manager.js&quot;,&quot;../build/esm/index.js&quot;],&quot;sourcesContent&quot;:[&quot;const PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES[\&quot;open\&quot;] = \&quot;0\&quot;;\nPACKET_TYPES[\&quot;close\&quot;] = \&quot;1\&quot;;\nPACKET_TYPES[\&quot;ping\&quot;] = \&quot;2\&quot;;\nPACKET_TYPES[\&quot;pong\&quot;] = \&quot;3\&quot;;\nPACKET_TYPES[\&quot;message\&quot;] = \&quot;4\&quot;;\nPACKET_TYPES[\&quot;upgrade\&quot;] = \&quot;5\&quot;;\nPACKET_TYPES[\&quot;noop\&quot;] = \&quot;6\&quot;;\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach(key =&gt; &#123;\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n&#125;);\nconst ERROR_PACKET = &#123; type: \&quot;error\&quot;, data: \&quot;parser error\&quot; &#125;;\nexport &#123; PACKET_TYPES, PACKET_TYPES_REVERSE, ERROR_PACKET &#125;;\n&quot;,&quot;import &#123; PACKET_TYPES &#125; from \&quot;./commons.js\&quot;;\nconst withNativeBlob = typeof Blob === \&quot;function\&quot; ||\n    (typeof Blob !== \&quot;undefined\&quot; &amp;&amp;\n        Object.prototype.toString.call(Blob) === \&quot;[object BlobConstructor]\&quot;);\nconst withNativeArrayBuffer = typeof ArrayBuffer === \&quot;function\&quot;;\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = obj =&gt; &#123;\n    return typeof ArrayBuffer.isView === \&quot;function\&quot;\n        ? ArrayBuffer.isView(obj)\n        : obj &amp;&amp; obj.buffer instanceof ArrayBuffer;\n&#125;;\nconst encodePacket = (&#123; type, data &#125;, supportsBinary, callback) =&gt; &#123;\n    if (withNativeBlob &amp;&amp; data instanceof Blob) &#123;\n        if (supportsBinary) &#123;\n            return callback(data);\n        &#125;\n        else &#123;\n            return encodeBlobAsBase64(data, callback);\n        &#125;\n    &#125;\n    else if (withNativeArrayBuffer &amp;&amp;\n        (data instanceof ArrayBuffer || isView(data))) &#123;\n        if (supportsBinary) &#123;\n            return callback(data);\n        &#125;\n        else &#123;\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        &#125;\n    &#125;\n    // plain string\n    return callback(PACKET_TYPES[type] + (data || \&quot;\&quot;));\n&#125;;\nconst encodeBlobAsBase64 = (data, callback) =&gt; &#123;\n    const fileReader = new FileReader();\n    fileReader.onload = function () &#123;\n        const content = fileReader.result.split(\&quot;,\&quot;)[1];\n        callback(\&quot;b\&quot; + content);\n    &#125;;\n    return fileReader.readAsDataURL(data);\n&#125;;\nexport default encodePacket;\n&quot;,&quot;/*\n * base64-arraybuffer 1.0.1 &lt;https://github.com/niklasvh/base64-arraybuffer&gt;\n * Copyright (c) 2022 Niklas von Hertzen &lt;https://hertzen.com&gt;\n * Released under MIT License\n */\nvar chars = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;;\n// Use a lookup table to find the index.\nvar lookup = typeof Uint8Array === &#x27;undefined&#x27; ? [] : new Uint8Array(256);\nfor (var i = 0; i &lt; chars.length; i++) &#123;\n    lookup[chars.charCodeAt(i)] = i;\n&#125;\nvar encode = function (arraybuffer) &#123;\n    var bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = &#x27;&#x27;;\n    for (i = 0; i &lt; len; i += 3) &#123;\n        base64 += chars[bytes[i] &gt;&gt; 2];\n        base64 += chars[((bytes[i] &amp; 3) &lt;&lt; 4) | (bytes[i + 1] &gt;&gt; 4)];\n        base64 += chars[((bytes[i + 1] &amp; 15) &lt;&lt; 2) | (bytes[i + 2] &gt;&gt; 6)];\n        base64 += chars[bytes[i + 2] &amp; 63];\n    &#125;\n    if (len % 3 === 2) &#123;\n        base64 = base64.substring(0, base64.length - 1) + &#x27;=&#x27;;\n    &#125;\n    else if (len % 3 === 1) &#123;\n        base64 = base64.substring(0, base64.length - 2) + &#x27;==&#x27;;\n    &#125;\n    return base64;\n&#125;;\nvar decode = function (base64) &#123;\n    var bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === &#x27;=&#x27;) &#123;\n        bufferLength--;\n        if (base64[base64.length - 2] === &#x27;=&#x27;) &#123;\n            bufferLength--;\n        &#125;\n    &#125;\n    var arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i &lt; len; i += 4) &#123;\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 &lt;&lt; 2) | (encoded2 &gt;&gt; 4);\n        bytes[p++] = ((encoded2 &amp; 15) &lt;&lt; 4) | (encoded3 &gt;&gt; 2);\n        bytes[p++] = ((encoded3 &amp; 3) &lt;&lt; 6) | (encoded4 &amp; 63);\n    &#125;\n    return arraybuffer;\n&#125;;\n\nexport &#123; decode, encode &#125;;\n//# sourceMappingURL=base64-arraybuffer.es5.js.map\n&quot;,&quot;import &#123; ERROR_PACKET, PACKET_TYPES_REVERSE &#125; from \&quot;./commons.js\&quot;;\nimport &#123; decode &#125; from \&quot;@socket.io/base64-arraybuffer\&quot;;\nconst withNativeArrayBuffer = typeof ArrayBuffer === \&quot;function\&quot;;\nconst decodePacket = (encodedPacket, binaryType) =&gt; &#123;\n    if (typeof encodedPacket !== \&quot;string\&quot;) &#123;\n        return &#123;\n            type: \&quot;message\&quot;,\n            data: mapBinary(encodedPacket, binaryType)\n        &#125;;\n    &#125;\n    const type = encodedPacket.charAt(0);\n    if (type === \&quot;b\&quot;) &#123;\n        return &#123;\n            type: \&quot;message\&quot;,\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType)\n        &#125;;\n    &#125;\n    const packetType = PACKET_TYPES_REVERSE[type];\n    if (!packetType) &#123;\n        return ERROR_PACKET;\n    &#125;\n    return encodedPacket.length &gt; 1\n        ? &#123;\n            type: PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1)\n        &#125;\n        : &#123;\n            type: PACKET_TYPES_REVERSE[type]\n        &#125;;\n&#125;;\nconst decodeBase64Packet = (data, binaryType) =&gt; &#123;\n    if (withNativeArrayBuffer) &#123;\n        const decoded = decode(data);\n        return mapBinary(decoded, binaryType);\n    &#125;\n    else &#123;\n        return &#123; base64: true, data &#125;; // fallback for old browsers\n    &#125;\n&#125;;\nconst mapBinary = (data, binaryType) =&gt; &#123;\n    switch (binaryType) &#123;\n        case \&quot;blob\&quot;:\n            return data instanceof ArrayBuffer ? new Blob([data]) : data;\n        case \&quot;arraybuffer\&quot;:\n        default:\n            return data; // assuming the data is already an ArrayBuffer\n    &#125;\n&#125;;\nexport default decodePacket;\n&quot;,&quot;import encodePacket from \&quot;./encodePacket.js\&quot;;\nimport decodePacket from \&quot;./decodePacket.js\&quot;;\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) =&gt; &#123;\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) =&gt; &#123;\n        // force base64 encoding for binary packets\n        encodePacket(packet, false, encodedPacket =&gt; &#123;\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) &#123;\n                callback(encodedPackets.join(SEPARATOR));\n            &#125;\n        &#125;);\n    &#125;);\n&#125;;\nconst decodePayload = (encodedPayload, binaryType) =&gt; &#123;\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i &lt; encodedPackets.length; i++) &#123;\n        const decodedPacket = decodePacket(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === \&quot;error\&quot;) &#123;\n            break;\n        &#125;\n    &#125;\n    return packets;\n&#125;;\nexport const protocol = 4;\nexport &#123; encodePacket, encodePayload, decodePacket, decodePayload &#125;;\n&quot;,&quot;/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nexport function Emitter(obj) &#123;\n  if (obj) return mixin(obj);\n&#125;\n\n/**\n * Mixin the emitter properties.\n *\n * @param &#123;Object&#125; obj\n * @return &#123;Object&#125;\n * @api private\n */\n\nfunction mixin(obj) &#123;\n  for (var key in Emitter.prototype) &#123;\n    obj[key] = Emitter.prototype[key];\n  &#125;\n  return obj;\n&#125;\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param &#123;String&#125; event\n * @param &#123;Function&#125; fn\n * @return &#123;Emitter&#125;\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn)&#123;\n  this._callbacks = this._callbacks || &#123;&#125;;\n  (this._callbacks[&#x27;$&#x27; + event] = this._callbacks[&#x27;$&#x27; + event] || [])\n    .push(fn);\n  return this;\n&#125;;\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param &#123;String&#125; event\n * @param &#123;Function&#125; fn\n * @return &#123;Emitter&#125;\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn)&#123;\n  function on() &#123;\n    this.off(event, on);\n    fn.apply(this, arguments);\n  &#125;\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n&#125;;\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param &#123;String&#125; event\n * @param &#123;Function&#125; fn\n * @return &#123;Emitter&#125;\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn)&#123;\n  this._callbacks = this._callbacks || &#123;&#125;;\n\n  // all\n  if (0 == arguments.length) &#123;\n    this._callbacks = &#123;&#125;;\n    return this;\n  &#125;\n\n  // specific event\n  var callbacks = this._callbacks[&#x27;$&#x27; + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) &#123;\n    delete this._callbacks[&#x27;$&#x27; + event];\n    return this;\n  &#125;\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i &lt; callbacks.length; i++) &#123;\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) &#123;\n      callbacks.splice(i, 1);\n      break;\n    &#125;\n  &#125;\n\n  // Remove event specific arrays for event types that no\n  // one is subscribed for to avoid memory leak.\n  if (callbacks.length === 0) &#123;\n    delete this._callbacks[&#x27;$&#x27; + event];\n  &#125;\n\n  return this;\n&#125;;\n\n/**\n * Emit `event` with the given args.\n *\n * @param &#123;String&#125; event\n * @param &#123;Mixed&#125; ...\n * @return &#123;Emitter&#125;\n */\n\nEmitter.prototype.emit = function(event)&#123;\n  this._callbacks = this._callbacks || &#123;&#125;;\n\n  var args = new Array(arguments.length - 1)\n    , callbacks = this._callbacks[&#x27;$&#x27; + event];\n\n  for (var i = 1; i &lt; arguments.length; i++) &#123;\n    args[i - 1] = arguments[i];\n  &#125;\n\n  if (callbacks) &#123;\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i &lt; len; ++i) &#123;\n      callbacks[i].apply(this, args);\n    &#125;\n  &#125;\n\n  return this;\n&#125;;\n\n// alias used for reserved events (protected method)\nEmitter.prototype.emitReserved = Emitter.prototype.emit;\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param &#123;String&#125; event\n * @return &#123;Array&#125;\n * @api public\n */\n\nEmitter.prototype.listeners = function(event)&#123;\n  this._callbacks = this._callbacks || &#123;&#125;;\n  return this._callbacks[&#x27;$&#x27; + event] || [];\n&#125;;\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param &#123;String&#125; event\n * @return &#123;Boolean&#125;\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event)&#123;\n  return !! this.listeners(event).length;\n&#125;;\n&quot;,&quot;export default (() =&gt; &#123;\n    if (typeof self !== \&quot;undefined\&quot;) &#123;\n        return self;\n    &#125;\n    else if (typeof window !== \&quot;undefined\&quot;) &#123;\n        return window;\n    &#125;\n    else &#123;\n        return Function(\&quot;return this\&quot;)();\n    &#125;\n&#125;)();\n&quot;,&quot;import globalThis from \&quot;./globalThis.js\&quot;;\nexport function pick(obj, ...attr) &#123;\n    return attr.reduce((acc, k) =&gt; &#123;\n        if (obj.hasOwnProperty(k)) &#123;\n            acc[k] = obj[k];\n        &#125;\n        return acc;\n    &#125;, &#123;&#125;);\n&#125;\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = clearTimeout;\nexport function installTimerFunctions(obj, opts) &#123;\n    if (opts.useNativeTimers) &#123;\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(globalThis);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(globalThis);\n    &#125;\n    else &#123;\n        obj.setTimeoutFn = setTimeout.bind(globalThis);\n        obj.clearTimeoutFn = clearTimeout.bind(globalThis);\n    &#125;\n&#125;\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn&#x27;t supported in IE9\nexport function byteLength(obj) &#123;\n    if (typeof obj === \&quot;string\&quot;) &#123;\n        return utf8Length(obj);\n    &#125;\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n&#125;\nfunction utf8Length(str) &#123;\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i &lt; l; i++) &#123;\n        c = str.charCodeAt(i);\n        if (c &lt; 0x80) &#123;\n            length += 1;\n        &#125;\n        else if (c &lt; 0x800) &#123;\n            length += 2;\n        &#125;\n        else if (c &lt; 0xd800 || c &gt;= 0xe000) &#123;\n            length += 3;\n        &#125;\n        else &#123;\n            i++;\n            length += 4;\n        &#125;\n    &#125;\n    return length;\n&#125;\n&quot;,&quot;import &#123; decodePacket &#125; from \&quot;engine.io-parser\&quot;;\nimport &#123; Emitter &#125; from \&quot;@socket.io/component-emitter\&quot;;\nimport &#123; installTimerFunctions &#125; from \&quot;./util.js\&quot;;\nclass TransportError extends Error &#123;\n    constructor(reason, description, context) &#123;\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = \&quot;TransportError\&quot;;\n    &#125;\n&#125;\nexport class Transport extends Emitter &#123;\n    /**\n     * Transport abstract constructor.\n     *\n     * @param &#123;Object&#125; options.\n     * @api private\n     */\n    constructor(opts) &#123;\n        super();\n        this.writable = false;\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.readyState = \&quot;\&quot;;\n        this.socket = opts.socket;\n    &#125;\n    /**\n     * Emits an error.\n     *\n     * @param &#123;String&#125; reason\n     * @param description\n     * @param context - the error context\n     * @return &#123;Transport&#125; for chaining\n     * @api protected\n     */\n    onError(reason, description, context) &#123;\n        super.emitReserved(\&quot;error\&quot;, new TransportError(reason, description, context));\n        return this;\n    &#125;\n    /**\n     * Opens the transport.\n     *\n     * @api public\n     */\n    open() &#123;\n        if (\&quot;closed\&quot; === this.readyState || \&quot;\&quot; === this.readyState) &#123;\n            this.readyState = \&quot;opening\&quot;;\n            this.doOpen();\n        &#125;\n        return this;\n    &#125;\n    /**\n     * Closes the transport.\n     *\n     * @api public\n     */\n    close() &#123;\n        if (\&quot;opening\&quot; === this.readyState || \&quot;open\&quot; === this.readyState) &#123;\n            this.doClose();\n            this.onClose();\n        &#125;\n        return this;\n    &#125;\n    /**\n     * Sends multiple packets.\n     *\n     * @param &#123;Array&#125; packets\n     * @api public\n     */\n    send(packets) &#123;\n        if (\&quot;open\&quot; === this.readyState) &#123;\n            this.write(packets);\n        &#125;\n        else &#123;\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        &#125;\n    &#125;\n    /**\n     * Called upon open\n     *\n     * @api protected\n     */\n    onOpen() &#123;\n        this.readyState = \&quot;open\&quot;;\n        this.writable = true;\n        super.emitReserved(\&quot;open\&quot;);\n    &#125;\n    /**\n     * Called with data.\n     *\n     * @param &#123;String&#125; data\n     * @api protected\n     */\n    onData(data) &#123;\n        const packet = decodePacket(data, this.socket.binaryType);\n        this.onPacket(packet);\n    &#125;\n    /**\n     * Called with a decoded packet.\n     *\n     * @api protected\n     */\n    onPacket(packet) &#123;\n        super.emitReserved(\&quot;packet\&quot;, packet);\n    &#125;\n    /**\n     * Called upon close.\n     *\n     * @api protected\n     */\n    onClose(details) &#123;\n        this.readyState = \&quot;closed\&quot;;\n        super.emitReserved(\&quot;close\&quot;, details);\n    &#125;\n&#125;\n&quot;,&quot;// imported from https://github.com/unshiftio/yeast\n&#x27;use strict&#x27;;\nconst alphabet = &#x27;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_&#x27;.split(&#x27;&#x27;), length = 64, map = &#123;&#125;;\nlet seed = 0, i = 0, prev;\n/**\n * Return a string representing the specified number.\n *\n * @param &#123;Number&#125; num The number to convert.\n * @returns &#123;String&#125; The string representation of the number.\n * @api public\n */\nexport function encode(num) &#123;\n    let encoded = &#x27;&#x27;;\n    do &#123;\n        encoded = alphabet[num % length] + encoded;\n        num = Math.floor(num / length);\n    &#125; while (num &gt; 0);\n    return encoded;\n&#125;\n/**\n * Return the integer value specified by the given string.\n *\n * @param &#123;String&#125; str The string to convert.\n * @returns &#123;Number&#125; The integer value represented by the string.\n * @api public\n */\nexport function decode(str) &#123;\n    let decoded = 0;\n    for (i = 0; i &lt; str.length; i++) &#123;\n        decoded = decoded * length + map[str.charAt(i)];\n    &#125;\n    return decoded;\n&#125;\n/**\n * Yeast: A tiny growing id generator.\n *\n * @returns &#123;String&#125; A unique id.\n * @api public\n */\nexport function yeast() &#123;\n    const now = encode(+new Date());\n    if (now !== prev)\n        return seed = 0, prev = now;\n    return now + &#x27;.&#x27; + encode(seed++);\n&#125;\n//\n// Map each character to its index.\n//\nfor (; i &lt; length; i++)\n    map[alphabet[i]] = i;\n&quot;,&quot;// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param &#123;Object&#125;\n * @api private\n */\nexport function encode(obj) &#123;\n    let str = &#x27;&#x27;;\n    for (let i in obj) &#123;\n        if (obj.hasOwnProperty(i)) &#123;\n            if (str.length)\n                str += &#x27;&amp;&#x27;;\n            str += encodeURIComponent(i) + &#x27;=&#x27; + encodeURIComponent(obj[i]);\n        &#125;\n    &#125;\n    return str;\n&#125;\n/**\n * Parses a simple querystring into an object\n *\n * @param &#123;String&#125; qs\n * @api private\n */\nexport function decode(qs) &#123;\n    let qry = &#123;&#125;;\n    let pairs = qs.split(&#x27;&amp;&#x27;);\n    for (let i = 0, l = pairs.length; i &lt; l; i++) &#123;\n        let pair = pairs[i].split(&#x27;=&#x27;);\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    &#125;\n    return qry;\n&#125;\n&quot;,&quot;// imported from https://github.com/component/has-cors\nlet value = false;\ntry &#123;\n    value = typeof XMLHttpRequest !== &#x27;undefined&#x27; &amp;&amp;\n        &#x27;withCredentials&#x27; in new XMLHttpRequest();\n&#125;\ncatch (err) &#123;\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n&#125;\nexport const hasCORS = value;\n&quot;,&quot;// browser shim for xmlhttprequest module\nimport &#123; hasCORS &#125; from \&quot;../contrib/has-cors.js\&quot;;\nimport globalThis from \&quot;../globalThis.js\&quot;;\nexport default function (opts) &#123;\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try &#123;\n        if (\&quot;undefined\&quot; !== typeof XMLHttpRequest &amp;&amp; (!xdomain || hasCORS)) &#123;\n            return new XMLHttpRequest();\n        &#125;\n    &#125;\n    catch (e) &#123; &#125;\n    if (!xdomain) &#123;\n        try &#123;\n            return new globalThis[[\&quot;Active\&quot;].concat(\&quot;Object\&quot;).join(\&quot;X\&quot;)](\&quot;Microsoft.XMLHTTP\&quot;);\n        &#125;\n        catch (e) &#123; &#125;\n    &#125;\n&#125;\n&quot;,&quot;import &#123; Transport &#125; from \&quot;../transport.js\&quot;;\nimport &#123; yeast &#125; from \&quot;../contrib/yeast.js\&quot;;\nimport &#123; encode &#125; from \&quot;../contrib/parseqs.js\&quot;;\nimport &#123; encodePayload, decodePayload &#125; from \&quot;engine.io-parser\&quot;;\nimport XMLHttpRequest from \&quot;./xmlhttprequest.js\&quot;;\nimport &#123; Emitter &#125; from \&quot;@socket.io/component-emitter\&quot;;\nimport &#123; installTimerFunctions, pick &#125; from \&quot;../util.js\&quot;;\nimport globalThis from \&quot;../globalThis.js\&quot;;\nfunction empty() &#123; &#125;\nconst hasXHR2 = (function () &#123;\n    const xhr = new XMLHttpRequest(&#123;\n        xdomain: false\n    &#125;);\n    return null != xhr.responseType;\n&#125;)();\nexport class Polling extends Transport &#123;\n    /**\n     * XHR Polling constructor.\n     *\n     * @param &#123;Object&#125; opts\n     * @api public\n     */\n    constructor(opts) &#123;\n        super(opts);\n        this.polling = false;\n        if (typeof location !== \&quot;undefined\&quot;) &#123;\n            const isSSL = \&quot;https:\&quot; === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) &#123;\n                port = isSSL ? \&quot;443\&quot; : \&quot;80\&quot;;\n            &#125;\n            this.xd =\n                (typeof location !== \&quot;undefined\&quot; &amp;&amp;\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n            this.xs = opts.secure !== isSSL;\n        &#125;\n        /**\n         * XHR supports binary\n         */\n        const forceBase64 = opts &amp;&amp; opts.forceBase64;\n        this.supportsBinary = hasXHR2 &amp;&amp; !forceBase64;\n    &#125;\n    /**\n     * Transport name.\n     */\n    get name() &#123;\n        return \&quot;polling\&quot;;\n    &#125;\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @api private\n     */\n    doOpen() &#123;\n        this.poll();\n    &#125;\n    /**\n     * Pauses polling.\n     *\n     * @param &#123;Function&#125; callback upon buffers are flushed and transport is paused\n     * @api private\n     */\n    pause(onPause) &#123;\n        this.readyState = \&quot;pausing\&quot;;\n        const pause = () =&gt; &#123;\n            this.readyState = \&quot;paused\&quot;;\n            onPause();\n        &#125;;\n        if (this.polling || !this.writable) &#123;\n            let total = 0;\n            if (this.polling) &#123;\n                total++;\n                this.once(\&quot;pollComplete\&quot;, function () &#123;\n                    --total || pause();\n                &#125;);\n            &#125;\n            if (!this.writable) &#123;\n                total++;\n                this.once(\&quot;drain\&quot;, function () &#123;\n                    --total || pause();\n                &#125;);\n            &#125;\n        &#125;\n        else &#123;\n            pause();\n        &#125;\n    &#125;\n    /**\n     * Starts polling cycle.\n     *\n     * @api public\n     */\n    poll() &#123;\n        this.polling = true;\n        this.doPoll();\n        this.emitReserved(\&quot;poll\&quot;);\n    &#125;\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @api private\n     */\n    onData(data) &#123;\n        const callback = packet =&gt; &#123;\n            // if its the first message we consider the transport open\n            if (\&quot;opening\&quot; === this.readyState &amp;&amp; packet.type === \&quot;open\&quot;) &#123;\n                this.onOpen();\n            &#125;\n            // if its a close packet, we close the ongoing requests\n            if (\&quot;close\&quot; === packet.type) &#123;\n                this.onClose(&#123; description: \&quot;transport closed by the server\&quot; &#125;);\n                return false;\n            &#125;\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        &#125;;\n        // decode payload\n        decodePayload(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if (\&quot;closed\&quot; !== this.readyState) &#123;\n            // if we got data we&#x27;re not polling\n            this.polling = false;\n            this.emitReserved(\&quot;pollComplete\&quot;);\n            if (\&quot;open\&quot; === this.readyState) &#123;\n                this.poll();\n            &#125;\n            else &#123;\n            &#125;\n        &#125;\n    &#125;\n    /**\n     * For polling, send a close packet.\n     *\n     * @api private\n     */\n    doClose() &#123;\n        const close = () =&gt; &#123;\n            this.write([&#123; type: \&quot;close\&quot; &#125;]);\n        &#125;;\n        if (\&quot;open\&quot; === this.readyState) &#123;\n            close();\n        &#125;\n        else &#123;\n            // in case we&#x27;re trying to close while\n            // handshaking is in progress (GH-164)\n            this.once(\&quot;open\&quot;, close);\n        &#125;\n    &#125;\n    /**\n     * Writes a packets payload.\n     *\n     * @param &#123;Array&#125; data packets\n     * @param &#123;Function&#125; drain callback\n     * @api private\n     */\n    write(packets) &#123;\n        this.writable = false;\n        encodePayload(packets, data =&gt; &#123;\n            this.doWrite(data, () =&gt; &#123;\n                this.writable = true;\n                this.emitReserved(\&quot;drain\&quot;);\n            &#125;);\n        &#125;);\n    &#125;\n    /**\n     * Generates uri for connection.\n     *\n     * @api private\n     */\n    uri() &#123;\n        let query = this.query || &#123;&#125;;\n        const schema = this.opts.secure ? \&quot;https\&quot; : \&quot;http\&quot;;\n        let port = \&quot;\&quot;;\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) &#123;\n            query[this.opts.timestampParam] = yeast();\n        &#125;\n        if (!this.supportsBinary &amp;&amp; !query.sid) &#123;\n            query.b64 = 1;\n        &#125;\n        // avoid port if default for schema\n        if (this.opts.port &amp;&amp;\n            ((\&quot;https\&quot; === schema &amp;&amp; Number(this.opts.port) !== 443) ||\n                (\&quot;http\&quot; === schema &amp;&amp; Number(this.opts.port) !== 80))) &#123;\n            port = \&quot;:\&quot; + this.opts.port;\n        &#125;\n        const encodedQuery = encode(query);\n        const ipv6 = this.opts.hostname.indexOf(\&quot;:\&quot;) !== -1;\n        return (schema +\n            \&quot;://\&quot; +\n            (ipv6 ? \&quot;[\&quot; + this.opts.hostname + \&quot;]\&quot; : this.opts.hostname) +\n            port +\n            this.opts.path +\n            (encodedQuery.length ? \&quot;?\&quot; + encodedQuery : \&quot;\&quot;));\n    &#125;\n    /**\n     * Creates a request.\n     *\n     * @param &#123;String&#125; method\n     * @api private\n     */\n    request(opts = &#123;&#125;) &#123;\n        Object.assign(opts, &#123; xd: this.xd, xs: this.xs &#125;, this.opts);\n        return new Request(this.uri(), opts);\n    &#125;\n    /**\n     * Sends data.\n     *\n     * @param &#123;String&#125; data to send.\n     * @param &#123;Function&#125; called upon flush.\n     * @api private\n     */\n    doWrite(data, fn) &#123;\n        const req = this.request(&#123;\n            method: \&quot;POST\&quot;,\n            data: data\n        &#125;);\n        req.on(\&quot;success\&quot;, fn);\n        req.on(\&quot;error\&quot;, (xhrStatus, context) =&gt; &#123;\n            this.onError(\&quot;xhr post error\&quot;, xhrStatus, context);\n        &#125;);\n    &#125;\n    /**\n     * Starts a poll cycle.\n     *\n     * @api private\n     */\n    doPoll() &#123;\n        const req = this.request();\n        req.on(\&quot;data\&quot;, this.onData.bind(this));\n        req.on(\&quot;error\&quot;, (xhrStatus, context) =&gt; &#123;\n            this.onError(\&quot;xhr poll error\&quot;, xhrStatus, context);\n        &#125;);\n        this.pollXhr = req;\n    &#125;\n&#125;\nexport class Request extends Emitter &#123;\n    /**\n     * Request constructor\n     *\n     * @param &#123;Object&#125; options\n     * @api public\n     */\n    constructor(uri, opts) &#123;\n        super();\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.method = opts.method || \&quot;GET\&quot;;\n        this.uri = uri;\n        this.async = false !== opts.async;\n        this.data = undefined !== opts.data ? opts.data : null;\n        this.create();\n    &#125;\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @api private\n     */\n    create() &#123;\n        const opts = pick(this.opts, \&quot;agent\&quot;, \&quot;pfx\&quot;, \&quot;key\&quot;, \&quot;passphrase\&quot;, \&quot;cert\&quot;, \&quot;ca\&quot;, \&quot;ciphers\&quot;, \&quot;rejectUnauthorized\&quot;, \&quot;autoUnref\&quot;);\n        opts.xdomain = !!this.opts.xd;\n        opts.xscheme = !!this.opts.xs;\n        const xhr = (this.xhr = new XMLHttpRequest(opts));\n        try &#123;\n            xhr.open(this.method, this.uri, this.async);\n            try &#123;\n                if (this.opts.extraHeaders) &#123;\n                    xhr.setDisableHeaderCheck &amp;&amp; xhr.setDisableHeaderCheck(true);\n                    for (let i in this.opts.extraHeaders) &#123;\n                        if (this.opts.extraHeaders.hasOwnProperty(i)) &#123;\n                            xhr.setRequestHeader(i, this.opts.extraHeaders[i]);\n                        &#125;\n                    &#125;\n                &#125;\n            &#125;\n            catch (e) &#123; &#125;\n            if (\&quot;POST\&quot; === this.method) &#123;\n                try &#123;\n                    xhr.setRequestHeader(\&quot;Content-type\&quot;, \&quot;text/plain;charset=UTF-8\&quot;);\n                &#125;\n                catch (e) &#123; &#125;\n            &#125;\n            try &#123;\n                xhr.setRequestHeader(\&quot;Accept\&quot;, \&quot;*/*\&quot;);\n            &#125;\n            catch (e) &#123; &#125;\n            // ie6 check\n            if (\&quot;withCredentials\&quot; in xhr) &#123;\n                xhr.withCredentials = this.opts.withCredentials;\n            &#125;\n            if (this.opts.requestTimeout) &#123;\n                xhr.timeout = this.opts.requestTimeout;\n            &#125;\n            xhr.onreadystatechange = () =&gt; &#123;\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) &#123;\n                    this.onLoad();\n                &#125;\n                else &#123;\n                    // make sure the `error` event handler that&#x27;s user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() =&gt; &#123;\n                        this.onError(typeof xhr.status === \&quot;number\&quot; ? xhr.status : 0);\n                    &#125;, 0);\n                &#125;\n            &#125;;\n            xhr.send(this.data);\n        &#125;\n        catch (e) &#123;\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the &#x27;error&#x27; event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() =&gt; &#123;\n                this.onError(e);\n            &#125;, 0);\n            return;\n        &#125;\n        if (typeof document !== \&quot;undefined\&quot;) &#123;\n            this.index = Request.requestsCount++;\n            Request.requests[this.index] = this;\n        &#125;\n    &#125;\n    /**\n     * Called upon error.\n     *\n     * @api private\n     */\n    onError(err) &#123;\n        this.emitReserved(\&quot;error\&quot;, err, this.xhr);\n        this.cleanup(true);\n    &#125;\n    /**\n     * Cleans up house.\n     *\n     * @api private\n     */\n    cleanup(fromError) &#123;\n        if (\&quot;undefined\&quot; === typeof this.xhr || null === this.xhr) &#123;\n            return;\n        &#125;\n        this.xhr.onreadystatechange = empty;\n        if (fromError) &#123;\n            try &#123;\n                this.xhr.abort();\n            &#125;\n            catch (e) &#123; &#125;\n        &#125;\n        if (typeof document !== \&quot;undefined\&quot;) &#123;\n            delete Request.requests[this.index];\n        &#125;\n        this.xhr = null;\n    &#125;\n    /**\n     * Called upon load.\n     *\n     * @api private\n     */\n    onLoad() &#123;\n        const data = this.xhr.responseText;\n        if (data !== null) &#123;\n            this.emitReserved(\&quot;data\&quot;, data);\n            this.emitReserved(\&quot;success\&quot;);\n            this.cleanup();\n        &#125;\n    &#125;\n    /**\n     * Aborts the request.\n     *\n     * @api public\n     */\n    abort() &#123;\n        this.cleanup();\n    &#125;\n&#125;\nRequest.requestsCount = 0;\nRequest.requests = &#123;&#125;;\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== \&quot;undefined\&quot;) &#123;\n    // @ts-ignore\n    if (typeof attachEvent === \&quot;function\&quot;) &#123;\n        // @ts-ignore\n        attachEvent(\&quot;onunload\&quot;, unloadHandler);\n    &#125;\n    else if (typeof addEventListener === \&quot;function\&quot;) &#123;\n        const terminationEvent = \&quot;onpagehide\&quot; in globalThis ? \&quot;pagehide\&quot; : \&quot;unload\&quot;;\n        addEventListener(terminationEvent, unloadHandler, false);\n    &#125;\n&#125;\nfunction unloadHandler() &#123;\n    for (let i in Request.requests) &#123;\n        if (Request.requests.hasOwnProperty(i)) &#123;\n            Request.requests[i].abort();\n        &#125;\n    &#125;\n&#125;\n&quot;,&quot;import globalThis from \&quot;../globalThis.js\&quot;;\nexport const nextTick = (() =&gt; &#123;\n    const isPromiseAvailable = typeof Promise === \&quot;function\&quot; &amp;&amp; typeof Promise.resolve === \&quot;function\&quot;;\n    if (isPromiseAvailable) &#123;\n        return cb =&gt; Promise.resolve().then(cb);\n    &#125;\n    else &#123;\n        return (cb, setTimeoutFn) =&gt; setTimeoutFn(cb, 0);\n    &#125;\n&#125;)();\nexport const WebSocket = globalThis.WebSocket || globalThis.MozWebSocket;\nexport const usingBrowserWebSocket = true;\nexport const defaultBinaryType = \&quot;arraybuffer\&quot;;\n&quot;,&quot;import &#123; Transport &#125; from \&quot;../transport.js\&quot;;\nimport &#123; encode &#125; from \&quot;../contrib/parseqs.js\&quot;;\nimport &#123; yeast &#125; from \&quot;../contrib/yeast.js\&quot;;\nimport &#123; pick &#125; from \&quot;../util.js\&quot;;\nimport &#123; defaultBinaryType, nextTick, usingBrowserWebSocket, WebSocket &#125; from \&quot;./websocket-constructor.js\&quot;;\nimport &#123; encodePacket &#125; from \&quot;engine.io-parser\&quot;;\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== \&quot;undefined\&quot; &amp;&amp;\n    typeof navigator.product === \&quot;string\&quot; &amp;&amp;\n    navigator.product.toLowerCase() === \&quot;reactnative\&quot;;\nexport class WS extends Transport &#123;\n    /**\n     * WebSocket transport constructor.\n     *\n     * @api &#123;Object&#125; connection options\n     * @api public\n     */\n    constructor(opts) &#123;\n        super(opts);\n        this.supportsBinary = !opts.forceBase64;\n    &#125;\n    /**\n     * Transport name.\n     *\n     * @api public\n     */\n    get name() &#123;\n        return \&quot;websocket\&quot;;\n    &#125;\n    /**\n     * Opens socket.\n     *\n     * @api private\n     */\n    doOpen() &#123;\n        if (!this.check()) &#123;\n            // let probe timeout\n            return;\n        &#125;\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the &#x27;headers&#x27; option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? &#123;&#125;\n            : pick(this.opts, \&quot;agent\&quot;, \&quot;perMessageDeflate\&quot;, \&quot;pfx\&quot;, \&quot;key\&quot;, \&quot;passphrase\&quot;, \&quot;cert\&quot;, \&quot;ca\&quot;, \&quot;ciphers\&quot;, \&quot;rejectUnauthorized\&quot;, \&quot;localAddress\&quot;, \&quot;protocolVersion\&quot;, \&quot;origin\&quot;, \&quot;maxPayload\&quot;, \&quot;family\&quot;, \&quot;checkServerIdentity\&quot;);\n        if (this.opts.extraHeaders) &#123;\n            opts.headers = this.opts.extraHeaders;\n        &#125;\n        try &#123;\n            this.ws =\n                usingBrowserWebSocket &amp;&amp; !isReactNative\n                    ? protocols\n                        ? new WebSocket(uri, protocols)\n                        : new WebSocket(uri)\n                    : new WebSocket(uri, protocols, opts);\n        &#125;\n        catch (err) &#123;\n            return this.emitReserved(\&quot;error\&quot;, err);\n        &#125;\n        this.ws.binaryType = this.socket.binaryType || defaultBinaryType;\n        this.addEventListeners();\n    &#125;\n    /**\n     * Adds event listeners to the socket\n     *\n     * @api private\n     */\n    addEventListeners() &#123;\n        this.ws.onopen = () =&gt; &#123;\n            if (this.opts.autoUnref) &#123;\n                this.ws._socket.unref();\n            &#125;\n            this.onOpen();\n        &#125;;\n        this.ws.onclose = closeEvent =&gt; this.onClose(&#123;\n            description: \&quot;websocket connection closed\&quot;,\n            context: closeEvent\n        &#125;);\n        this.ws.onmessage = ev =&gt; this.onData(ev.data);\n        this.ws.onerror = e =&gt; this.onError(\&quot;websocket error\&quot;, e);\n    &#125;\n    /**\n     * Writes data to socket.\n     *\n     * @param &#123;Array&#125; array of packets.\n     * @api private\n     */\n    write(packets) &#123;\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i &lt; packets.length; i++) &#123;\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            encodePacket(packet, this.supportsBinary, data =&gt; &#123;\n                // always create a new object (GH-437)\n                const opts = &#123;&#125;;\n                if (!usingBrowserWebSocket) &#123;\n                    if (packet.options) &#123;\n                        opts.compress = packet.options.compress;\n                    &#125;\n                    if (this.opts.perMessageDeflate) &#123;\n                        const len = \n                        // @ts-ignore\n                        \&quot;string\&quot; === typeof data ? Buffer.byteLength(data) : data.length;\n                        if (len &lt; this.opts.perMessageDeflate.threshold) &#123;\n                            opts.compress = false;\n                        &#125;\n                    &#125;\n                &#125;\n                // Sometimes the websocket has already been closed but the browser didn&#x27;t\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try &#123;\n                    if (usingBrowserWebSocket) &#123;\n                        // TypeError is thrown when passing the second argument on Safari\n                        this.ws.send(data);\n                    &#125;\n                    else &#123;\n                        this.ws.send(data, opts);\n                    &#125;\n                &#125;\n                catch (e) &#123;\n                &#125;\n                if (lastPacket) &#123;\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    nextTick(() =&gt; &#123;\n                        this.writable = true;\n                        this.emitReserved(\&quot;drain\&quot;);\n                    &#125;, this.setTimeoutFn);\n                &#125;\n            &#125;);\n        &#125;\n    &#125;\n    /**\n     * Closes socket.\n     *\n     * @api private\n     */\n    doClose() &#123;\n        if (typeof this.ws !== \&quot;undefined\&quot;) &#123;\n            this.ws.close();\n            this.ws = null;\n        &#125;\n    &#125;\n    /**\n     * Generates uri for connection.\n     *\n     * @api private\n     */\n    uri() &#123;\n        let query = this.query || &#123;&#125;;\n        const schema = this.opts.secure ? \&quot;wss\&quot; : \&quot;ws\&quot;;\n        let port = \&quot;\&quot;;\n        // avoid port if default for schema\n        if (this.opts.port &amp;&amp;\n            ((\&quot;wss\&quot; === schema &amp;&amp; Number(this.opts.port) !== 443) ||\n                (\&quot;ws\&quot; === schema &amp;&amp; Number(this.opts.port) !== 80))) &#123;\n            port = \&quot;:\&quot; + this.opts.port;\n        &#125;\n        // append timestamp to URI\n        if (this.opts.timestampRequests) &#123;\n            query[this.opts.timestampParam] = yeast();\n        &#125;\n        // communicate binary support capabilities\n        if (!this.supportsBinary) &#123;\n            query.b64 = 1;\n        &#125;\n        const encodedQuery = encode(query);\n        const ipv6 = this.opts.hostname.indexOf(\&quot;:\&quot;) !== -1;\n        return (schema +\n            \&quot;://\&quot; +\n            (ipv6 ? \&quot;[\&quot; + this.opts.hostname + \&quot;]\&quot; : this.opts.hostname) +\n            port +\n            this.opts.path +\n            (encodedQuery.length ? \&quot;?\&quot; + encodedQuery : \&quot;\&quot;));\n    &#125;\n    /**\n     * Feature detection for WebSocket.\n     *\n     * @return &#123;Boolean&#125; whether this transport is available.\n     * @api public\n     */\n    check() &#123;\n        return (!!WebSocket &amp;&amp;\n            !(\&quot;__initialize\&quot; in WebSocket &amp;&amp; this.name === WS.prototype.name));\n    &#125;\n&#125;\n&quot;,&quot;import &#123; Polling &#125; from \&quot;./polling.js\&quot;;\nimport &#123; WS &#125; from \&quot;./websocket.js\&quot;;\nexport const transports = &#123;\n    websocket: WS,\n    polling: Polling\n&#125;;\n&quot;,&quot;// imported from https://github.com/galkn/parseuri\n/**\n * Parses an URI\n *\n * @author Steven Levithan &lt;stevenlevithan.com&gt; (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]&#123;0,4&#125;:)&#123;2,7&#125;[a-f0-9]&#123;0,4&#125;|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    &#x27;source&#x27;, &#x27;protocol&#x27;, &#x27;authority&#x27;, &#x27;userInfo&#x27;, &#x27;user&#x27;, &#x27;password&#x27;, &#x27;host&#x27;, &#x27;port&#x27;, &#x27;relative&#x27;, &#x27;path&#x27;, &#x27;directory&#x27;, &#x27;file&#x27;, &#x27;query&#x27;, &#x27;anchor&#x27;\n];\nexport function parse(str) &#123;\n    const src = str, b = str.indexOf(&#x27;[&#x27;), e = str.indexOf(&#x27;]&#x27;);\n    if (b != -1 &amp;&amp; e != -1) &#123;\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, &#x27;;&#x27;) + str.substring(e, str.length);\n    &#125;\n    let m = re.exec(str || &#x27;&#x27;), uri = &#123;&#125;, i = 14;\n    while (i--) &#123;\n        uri[parts[i]] = m[i] || &#x27;&#x27;;\n    &#125;\n    if (b != -1 &amp;&amp; e != -1) &#123;\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, &#x27;:&#x27;);\n        uri.authority = uri.authority.replace(&#x27;[&#x27;, &#x27;&#x27;).replace(&#x27;]&#x27;, &#x27;&#x27;).replace(/;/g, &#x27;:&#x27;);\n        uri.ipv6uri = true;\n    &#125;\n    uri.pathNames = pathNames(uri, uri[&#x27;path&#x27;]);\n    uri.queryKey = queryKey(uri, uri[&#x27;query&#x27;]);\n    return uri;\n&#125;\nfunction pathNames(obj, path) &#123;\n    const regx = /\\/&#123;2,9&#125;/g, names = path.replace(regx, \&quot;/\&quot;).split(\&quot;/\&quot;);\n    if (path.substr(0, 1) == &#x27;/&#x27; || path.length === 0) &#123;\n        names.splice(0, 1);\n    &#125;\n    if (path.substr(path.length - 1, 1) == &#x27;/&#x27;) &#123;\n        names.splice(names.length - 1, 1);\n    &#125;\n    return names;\n&#125;\nfunction queryKey(uri, query) &#123;\n    const data = &#123;&#125;;\n    query.replace(/(?:^|&amp;)([^&amp;=]*)=?([^&amp;]*)/g, function ($0, $1, $2) &#123;\n        if ($1) &#123;\n            data[$1] = $2;\n        &#125;\n    &#125;);\n    return data;\n&#125;\n&quot;,&quot;import &#123; transports &#125; from \&quot;./transports/index.js\&quot;;\nimport &#123; installTimerFunctions, byteLength &#125; from \&quot;./util.js\&quot;;\nimport &#123; decode &#125; from \&quot;./contrib/parseqs.js\&quot;;\nimport &#123; parse &#125; from \&quot;./contrib/parseuri.js\&quot;;\nimport &#123; Emitter &#125; from \&quot;@socket.io/component-emitter\&quot;;\nimport &#123; protocol &#125; from \&quot;engine.io-parser\&quot;;\nexport class Socket extends Emitter &#123;\n    /**\n     * Socket constructor.\n     *\n     * @param &#123;String|Object&#125; uri or options\n     * @param &#123;Object&#125; opts - options\n     * @api public\n     */\n    constructor(uri, opts = &#123;&#125;) &#123;\n        super();\n        if (uri &amp;&amp; \&quot;object\&quot; === typeof uri) &#123;\n            opts = uri;\n            uri = null;\n        &#125;\n        if (uri) &#123;\n            uri = parse(uri);\n            opts.hostname = uri.host;\n            opts.secure = uri.protocol === \&quot;https\&quot; || uri.protocol === \&quot;wss\&quot;;\n            opts.port = uri.port;\n            if (uri.query)\n                opts.query = uri.query;\n        &#125;\n        else if (opts.host) &#123;\n            opts.hostname = parse(opts.host).host;\n        &#125;\n        installTimerFunctions(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== \&quot;undefined\&quot; &amp;&amp; \&quot;https:\&quot; === location.protocol;\n        if (opts.hostname &amp;&amp; !opts.port) &#123;\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? \&quot;443\&quot; : \&quot;80\&quot;;\n        &#125;\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== \&quot;undefined\&quot; ? location.hostname : \&quot;localhost\&quot;);\n        this.port =\n            opts.port ||\n                (typeof location !== \&quot;undefined\&quot; &amp;&amp; location.port\n                    ? location.port\n                    : this.secure\n                        ? \&quot;443\&quot;\n                        : \&quot;80\&quot;);\n        this.transports = opts.transports || [\&quot;polling\&quot;, \&quot;websocket\&quot;];\n        this.readyState = \&quot;\&quot;;\n        this.writeBuffer = [];\n        this.prevBufferLen = 0;\n        this.opts = Object.assign(&#123;\n            path: \&quot;/engine.io\&quot;,\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: \&quot;t\&quot;,\n            rememberUpgrade: false,\n            rejectUnauthorized: true,\n            perMessageDeflate: &#123;\n                threshold: 1024\n            &#125;,\n            transportOptions: &#123;&#125;,\n            closeOnBeforeunload: true\n        &#125;, opts);\n        this.opts.path = this.opts.path.replace(/\\/$/, \&quot;\&quot;) + \&quot;/\&quot;;\n        if (typeof this.opts.query === \&quot;string\&quot;) &#123;\n            this.opts.query = decode(this.opts.query);\n        &#125;\n        // set on handshake\n        this.id = null;\n        this.upgrades = null;\n        this.pingInterval = null;\n        this.pingTimeout = null;\n        // set on heartbeat\n        this.pingTimeoutTimer = null;\n        if (typeof addEventListener === \&quot;function\&quot;) &#123;\n            if (this.opts.closeOnBeforeunload) &#123;\n                // Firefox closes the connection when the \&quot;beforeunload\&quot; event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no \&quot;disconnect\&quot; event at the Socket.IO level when the page is\n                // closed/reloaded)\n                addEventListener(\&quot;beforeunload\&quot;, () =&gt; &#123;\n                    if (this.transport) &#123;\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    &#125;\n                &#125;, false);\n            &#125;\n            if (this.hostname !== \&quot;localhost\&quot;) &#123;\n                this.offlineEventListener = () =&gt; &#123;\n                    this.onClose(\&quot;transport close\&quot;, &#123;\n                        description: \&quot;network connection lost\&quot;\n                    &#125;);\n                &#125;;\n                addEventListener(\&quot;offline\&quot;, this.offlineEventListener, false);\n            &#125;\n        &#125;\n        this.open();\n    &#125;\n    /**\n     * Creates transport of the given type.\n     *\n     * @param &#123;String&#125; transport name\n     * @return &#123;Transport&#125;\n     * @api private\n     */\n    createTransport(name) &#123;\n        const query = Object.assign(&#123;&#125;, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign(&#123;&#125;, this.opts.transportOptions[name], this.opts, &#123;\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port\n        &#125;);\n        return new transports[name](opts);\n    &#125;\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @api private\n     */\n    open() &#123;\n        let transport;\n        if (this.opts.rememberUpgrade &amp;&amp;\n            Socket.priorWebsocketSuccess &amp;&amp;\n            this.transports.indexOf(\&quot;websocket\&quot;) !== -1) &#123;\n            transport = \&quot;websocket\&quot;;\n        &#125;\n        else if (0 === this.transports.length) &#123;\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() =&gt; &#123;\n                this.emitReserved(\&quot;error\&quot;, \&quot;No transports available\&quot;);\n            &#125;, 0);\n            return;\n        &#125;\n        else &#123;\n            transport = this.transports[0];\n        &#125;\n        this.readyState = \&quot;opening\&quot;;\n        // Retry with the next transport if the transport is disabled (jsonp: false)\n        try &#123;\n            transport = this.createTransport(transport);\n        &#125;\n        catch (e) &#123;\n            this.transports.shift();\n            this.open();\n            return;\n        &#125;\n        transport.open();\n        this.setTransport(transport);\n    &#125;\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @api private\n     */\n    setTransport(transport) &#123;\n        if (this.transport) &#123;\n            this.transport.removeAllListeners();\n        &#125;\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on(\&quot;drain\&quot;, this.onDrain.bind(this))\n            .on(\&quot;packet\&quot;, this.onPacket.bind(this))\n            .on(\&quot;error\&quot;, this.onError.bind(this))\n            .on(\&quot;close\&quot;, reason =&gt; this.onClose(\&quot;transport close\&quot;, reason));\n    &#125;\n    /**\n     * Probes a transport.\n     *\n     * @param &#123;String&#125; transport name\n     * @api private\n     */\n    probe(name) &#123;\n        let transport = this.createTransport(name);\n        let failed = false;\n        Socket.priorWebsocketSuccess = false;\n        const onTransportOpen = () =&gt; &#123;\n            if (failed)\n                return;\n            transport.send([&#123; type: \&quot;ping\&quot;, data: \&quot;probe\&quot; &#125;]);\n            transport.once(\&quot;packet\&quot;, msg =&gt; &#123;\n                if (failed)\n                    return;\n                if (\&quot;pong\&quot; === msg.type &amp;&amp; \&quot;probe\&quot; === msg.data) &#123;\n                    this.upgrading = true;\n                    this.emitReserved(\&quot;upgrading\&quot;, transport);\n                    if (!transport)\n                        return;\n                    Socket.priorWebsocketSuccess = \&quot;websocket\&quot; === transport.name;\n                    this.transport.pause(() =&gt; &#123;\n                        if (failed)\n                            return;\n                        if (\&quot;closed\&quot; === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([&#123; type: \&quot;upgrade\&quot; &#125;]);\n                        this.emitReserved(\&quot;upgrade\&quot;, transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    &#125;);\n                &#125;\n                else &#123;\n                    const err = new Error(\&quot;probe error\&quot;);\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved(\&quot;upgradeError\&quot;, err);\n                &#125;\n            &#125;);\n        &#125;;\n        function freezeTransport() &#123;\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        &#125;\n        // Handle any error that happens while probing\n        const onerror = err =&gt; &#123;\n            const error = new Error(\&quot;probe error: \&quot; + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved(\&quot;upgradeError\&quot;, error);\n        &#125;;\n        function onTransportClose() &#123;\n            onerror(\&quot;transport closed\&quot;);\n        &#125;\n        // When the socket is closed while we&#x27;re probing\n        function onclose() &#123;\n            onerror(\&quot;socket closed\&quot;);\n        &#125;\n        // When the socket is upgraded while we&#x27;re probing\n        function onupgrade(to) &#123;\n            if (transport &amp;&amp; to.name !== transport.name) &#123;\n                freezeTransport();\n            &#125;\n        &#125;\n        // Remove all listeners on the transport and on self\n        const cleanup = () =&gt; &#123;\n            transport.removeListener(\&quot;open\&quot;, onTransportOpen);\n            transport.removeListener(\&quot;error\&quot;, onerror);\n            transport.removeListener(\&quot;close\&quot;, onTransportClose);\n            this.off(\&quot;close\&quot;, onclose);\n            this.off(\&quot;upgrading\&quot;, onupgrade);\n        &#125;;\n        transport.once(\&quot;open\&quot;, onTransportOpen);\n        transport.once(\&quot;error\&quot;, onerror);\n        transport.once(\&quot;close\&quot;, onTransportClose);\n        this.once(\&quot;close\&quot;, onclose);\n        this.once(\&quot;upgrading\&quot;, onupgrade);\n        transport.open();\n    &#125;\n    /**\n     * Called when connection is deemed open.\n     *\n     * @api private\n     */\n    onOpen() &#123;\n        this.readyState = \&quot;open\&quot;;\n        Socket.priorWebsocketSuccess = \&quot;websocket\&quot; === this.transport.name;\n        this.emitReserved(\&quot;open\&quot;);\n        this.flush();\n        // we check for `readyState` in case an `open`\n        // listener already closed the socket\n        if (\&quot;open\&quot; === this.readyState &amp;&amp;\n            this.opts.upgrade &amp;&amp;\n            this.transport.pause) &#123;\n            let i = 0;\n            const l = this.upgrades.length;\n            for (; i &lt; l; i++) &#123;\n                this.probe(this.upgrades[i]);\n            &#125;\n        &#125;\n    &#125;\n    /**\n     * Handles a packet.\n     *\n     * @api private\n     */\n    onPacket(packet) &#123;\n        if (\&quot;opening\&quot; === this.readyState ||\n            \&quot;open\&quot; === this.readyState ||\n            \&quot;closing\&quot; === this.readyState) &#123;\n            this.emitReserved(\&quot;packet\&quot;, packet);\n            // Socket is live - any packet counts\n            this.emitReserved(\&quot;heartbeat\&quot;);\n            switch (packet.type) &#123;\n                case \&quot;open\&quot;:\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case \&quot;ping\&quot;:\n                    this.resetPingTimeout();\n                    this.sendPacket(\&quot;pong\&quot;);\n                    this.emitReserved(\&quot;ping\&quot;);\n                    this.emitReserved(\&quot;pong\&quot;);\n                    break;\n                case \&quot;error\&quot;:\n                    const err = new Error(\&quot;server error\&quot;);\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this.onError(err);\n                    break;\n                case \&quot;message\&quot;:\n                    this.emitReserved(\&quot;data\&quot;, packet.data);\n                    this.emitReserved(\&quot;message\&quot;, packet.data);\n                    break;\n            &#125;\n        &#125;\n        else &#123;\n        &#125;\n    &#125;\n    /**\n     * Called upon handshake completion.\n     *\n     * @param &#123;Object&#125; data - handshake obj\n     * @api private\n     */\n    onHandshake(data) &#123;\n        this.emitReserved(\&quot;handshake\&quot;, data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this.upgrades = this.filterUpgrades(data.upgrades);\n        this.pingInterval = data.pingInterval;\n        this.pingTimeout = data.pingTimeout;\n        this.maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if (\&quot;closed\&quot; === this.readyState)\n            return;\n        this.resetPingTimeout();\n    &#125;\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @api private\n     */\n    resetPingTimeout() &#123;\n        this.clearTimeoutFn(this.pingTimeoutTimer);\n        this.pingTimeoutTimer = this.setTimeoutFn(() =&gt; &#123;\n            this.onClose(\&quot;ping timeout\&quot;);\n        &#125;, this.pingInterval + this.pingTimeout);\n        if (this.opts.autoUnref) &#123;\n            this.pingTimeoutTimer.unref();\n        &#125;\n    &#125;\n    /**\n     * Called on `drain` event\n     *\n     * @api private\n     */\n    onDrain() &#123;\n        this.writeBuffer.splice(0, this.prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this.prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) &#123;\n            this.emitReserved(\&quot;drain\&quot;);\n        &#125;\n        else &#123;\n            this.flush();\n        &#125;\n    &#125;\n    /**\n     * Flush write buffers.\n     *\n     * @api private\n     */\n    flush() &#123;\n        if (\&quot;closed\&quot; !== this.readyState &amp;&amp;\n            this.transport.writable &amp;&amp;\n            !this.upgrading &amp;&amp;\n            this.writeBuffer.length) &#123;\n            const packets = this.getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this.prevBufferLen = packets.length;\n            this.emitReserved(\&quot;flush\&quot;);\n        &#125;\n    &#125;\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    getWritablePackets() &#123;\n        const shouldCheckPayloadSize = this.maxPayload &amp;&amp;\n            this.transport.name === \&quot;polling\&quot; &amp;&amp;\n            this.writeBuffer.length &gt; 1;\n        if (!shouldCheckPayloadSize) &#123;\n            return this.writeBuffer;\n        &#125;\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i &lt; this.writeBuffer.length; i++) &#123;\n            const data = this.writeBuffer[i].data;\n            if (data) &#123;\n                payloadSize += byteLength(data);\n            &#125;\n            if (i &gt; 0 &amp;&amp; payloadSize &gt; this.maxPayload) &#123;\n                return this.writeBuffer.slice(0, i);\n            &#125;\n            payloadSize += 2; // separator + packet type\n        &#125;\n        return this.writeBuffer;\n    &#125;\n    /**\n     * Sends a message.\n     *\n     * @param &#123;String&#125; message.\n     * @param &#123;Function&#125; callback function.\n     * @param &#123;Object&#125; options.\n     * @return &#123;Socket&#125; for chaining.\n     * @api public\n     */\n    write(msg, options, fn) &#123;\n        this.sendPacket(\&quot;message\&quot;, msg, options, fn);\n        return this;\n    &#125;\n    send(msg, options, fn) &#123;\n        this.sendPacket(\&quot;message\&quot;, msg, options, fn);\n        return this;\n    &#125;\n    /**\n     * Sends a packet.\n     *\n     * @param &#123;String&#125; packet type.\n     * @param &#123;String&#125; data.\n     * @param &#123;Object&#125; options.\n     * @param &#123;Function&#125; callback function.\n     * @api private\n     */\n    sendPacket(type, data, options, fn) &#123;\n        if (\&quot;function\&quot; === typeof data) &#123;\n            fn = data;\n            data = undefined;\n        &#125;\n        if (\&quot;function\&quot; === typeof options) &#123;\n            fn = options;\n            options = null;\n        &#125;\n        if (\&quot;closing\&quot; === this.readyState || \&quot;closed\&quot; === this.readyState) &#123;\n            return;\n        &#125;\n        options = options || &#123;&#125;;\n        options.compress = false !== options.compress;\n        const packet = &#123;\n            type: type,\n            data: data,\n            options: options\n        &#125;;\n        this.emitReserved(\&quot;packetCreate\&quot;, packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once(\&quot;flush\&quot;, fn);\n        this.flush();\n    &#125;\n    /**\n     * Closes the connection.\n     *\n     * @api public\n     */\n    close() &#123;\n        const close = () =&gt; &#123;\n            this.onClose(\&quot;forced close\&quot;);\n            this.transport.close();\n        &#125;;\n        const cleanupAndClose = () =&gt; &#123;\n            this.off(\&quot;upgrade\&quot;, cleanupAndClose);\n            this.off(\&quot;upgradeError\&quot;, cleanupAndClose);\n            close();\n        &#125;;\n        const waitForUpgrade = () =&gt; &#123;\n            // wait for upgrade to finish since we can&#x27;t send packets while pausing a transport\n            this.once(\&quot;upgrade\&quot;, cleanupAndClose);\n            this.once(\&quot;upgradeError\&quot;, cleanupAndClose);\n        &#125;;\n        if (\&quot;opening\&quot; === this.readyState || \&quot;open\&quot; === this.readyState) &#123;\n            this.readyState = \&quot;closing\&quot;;\n            if (this.writeBuffer.length) &#123;\n                this.once(\&quot;drain\&quot;, () =&gt; &#123;\n                    if (this.upgrading) &#123;\n                        waitForUpgrade();\n                    &#125;\n                    else &#123;\n                        close();\n                    &#125;\n                &#125;);\n            &#125;\n            else if (this.upgrading) &#123;\n                waitForUpgrade();\n            &#125;\n            else &#123;\n                close();\n            &#125;\n        &#125;\n        return this;\n    &#125;\n    /**\n     * Called upon transport error\n     *\n     * @api private\n     */\n    onError(err) &#123;\n        Socket.priorWebsocketSuccess = false;\n        this.emitReserved(\&quot;error\&quot;, err);\n        this.onClose(\&quot;transport error\&quot;, err);\n    &#125;\n    /**\n     * Called upon transport close.\n     *\n     * @api private\n     */\n    onClose(reason, description) &#123;\n        if (\&quot;opening\&quot; === this.readyState ||\n            \&quot;open\&quot; === this.readyState ||\n            \&quot;closing\&quot; === this.readyState) &#123;\n            // clear timers\n            this.clearTimeoutFn(this.pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners(\&quot;close\&quot;);\n            // ensure transport won&#x27;t stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (typeof removeEventListener === \&quot;function\&quot;) &#123;\n                removeEventListener(\&quot;offline\&quot;, this.offlineEventListener, false);\n            &#125;\n            // set ready state\n            this.readyState = \&quot;closed\&quot;;\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved(\&quot;close\&quot;, reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this.prevBufferLen = 0;\n        &#125;\n    &#125;\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param &#123;Array&#125; server upgrades\n     * @api private\n     *\n     */\n    filterUpgrades(upgrades) &#123;\n        const filteredUpgrades = [];\n        let i = 0;\n        const j = upgrades.length;\n        for (; i &lt; j; i++) &#123;\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        &#125;\n        return filteredUpgrades;\n    &#125;\n&#125;\nSocket.protocol = protocol;\n&quot;,&quot;import &#123; parse &#125; from \&quot;engine.io-client\&quot;;\n/**\n * URL parser.\n *\n * @param uri - url\n * @param path - the request path of the connection\n * @param loc - An object meant to mimic window.location.\n *        Defaults to window.location.\n * @public\n */\nexport function url(uri, path = \&quot;\&quot;, loc) &#123;\n    let obj = uri;\n    // default to window.location\n    loc = loc || (typeof location !== \&quot;undefined\&quot; &amp;&amp; location);\n    if (null == uri)\n        uri = loc.protocol + \&quot;//\&quot; + loc.host;\n    // relative path support\n    if (typeof uri === \&quot;string\&quot;) &#123;\n        if (\&quot;/\&quot; === uri.charAt(0)) &#123;\n            if (\&quot;/\&quot; === uri.charAt(1)) &#123;\n                uri = loc.protocol + uri;\n            &#125;\n            else &#123;\n                uri = loc.host + uri;\n            &#125;\n        &#125;\n        if (!/^(https?|wss?):\\/\\//.test(uri)) &#123;\n            if (\&quot;undefined\&quot; !== typeof loc) &#123;\n                uri = loc.protocol + \&quot;//\&quot; + uri;\n            &#125;\n            else &#123;\n                uri = \&quot;https://\&quot; + uri;\n            &#125;\n        &#125;\n        // parse\n        obj = parse(uri);\n    &#125;\n    // make sure we treat `localhost:80` and `localhost` equally\n    if (!obj.port) &#123;\n        if (/^(http|ws)$/.test(obj.protocol)) &#123;\n            obj.port = \&quot;80\&quot;;\n        &#125;\n        else if (/^(http|ws)s$/.test(obj.protocol)) &#123;\n            obj.port = \&quot;443\&quot;;\n        &#125;\n    &#125;\n    obj.path = obj.path || \&quot;/\&quot;;\n    const ipv6 = obj.host.indexOf(\&quot;:\&quot;) !== -1;\n    const host = ipv6 ? \&quot;[\&quot; + obj.host + \&quot;]\&quot; : obj.host;\n    // define unique id\n    obj.id = obj.protocol + \&quot;://\&quot; + host + \&quot;:\&quot; + obj.port + path;\n    // define href\n    obj.href =\n        obj.protocol +\n            \&quot;://\&quot; +\n            host +\n            (loc &amp;&amp; loc.port === obj.port ? \&quot;\&quot; : \&quot;:\&quot; + obj.port);\n    return obj;\n&#125;\n&quot;,&quot;const withNativeArrayBuffer = typeof ArrayBuffer === \&quot;function\&quot;;\nconst isView = (obj) =&gt; &#123;\n    return typeof ArrayBuffer.isView === \&quot;function\&quot;\n        ? ArrayBuffer.isView(obj)\n        : obj.buffer instanceof ArrayBuffer;\n&#125;;\nconst toString = Object.prototype.toString;\nconst withNativeBlob = typeof Blob === \&quot;function\&quot; ||\n    (typeof Blob !== \&quot;undefined\&quot; &amp;&amp;\n        toString.call(Blob) === \&quot;[object BlobConstructor]\&quot;);\nconst withNativeFile = typeof File === \&quot;function\&quot; ||\n    (typeof File !== \&quot;undefined\&quot; &amp;&amp;\n        toString.call(File) === \&quot;[object FileConstructor]\&quot;);\n/**\n * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.\n *\n * @private\n */\nexport function isBinary(obj) &#123;\n    return ((withNativeArrayBuffer &amp;&amp; (obj instanceof ArrayBuffer || isView(obj))) ||\n        (withNativeBlob &amp;&amp; obj instanceof Blob) ||\n        (withNativeFile &amp;&amp; obj instanceof File));\n&#125;\nexport function hasBinary(obj, toJSON) &#123;\n    if (!obj || typeof obj !== \&quot;object\&quot;) &#123;\n        return false;\n    &#125;\n    if (Array.isArray(obj)) &#123;\n        for (let i = 0, l = obj.length; i &lt; l; i++) &#123;\n            if (hasBinary(obj[i])) &#123;\n                return true;\n            &#125;\n        &#125;\n        return false;\n    &#125;\n    if (isBinary(obj)) &#123;\n        return true;\n    &#125;\n    if (obj.toJSON &amp;&amp;\n        typeof obj.toJSON === \&quot;function\&quot; &amp;&amp;\n        arguments.length === 1) &#123;\n        return hasBinary(obj.toJSON(), true);\n    &#125;\n    for (const key in obj) &#123;\n        if (Object.prototype.hasOwnProperty.call(obj, key) &amp;&amp; hasBinary(obj[key])) &#123;\n            return true;\n        &#125;\n    &#125;\n    return false;\n&#125;\n&quot;,&quot;import &#123; isBinary &#125; from \&quot;./is-binary.js\&quot;;\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param &#123;Object&#125; packet - socket.io event packet\n * @return &#123;Object&#125; with deconstructed packet and list of buffers\n * @public\n */\nexport function deconstructPacket(packet) &#123;\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary &#x27;attachments&#x27;\n    return &#123; packet: pack, buffers: buffers &#125;;\n&#125;\nfunction _deconstructPacket(data, buffers) &#123;\n    if (!data)\n        return data;\n    if (isBinary(data)) &#123;\n        const placeholder = &#123; _placeholder: true, num: buffers.length &#125;;\n        buffers.push(data);\n        return placeholder;\n    &#125;\n    else if (Array.isArray(data)) &#123;\n        const newData = new Array(data.length);\n        for (let i = 0; i &lt; data.length; i++) &#123;\n            newData[i] = _deconstructPacket(data[i], buffers);\n        &#125;\n        return newData;\n    &#125;\n    else if (typeof data === \&quot;object\&quot; &amp;&amp; !(data instanceof Date)) &#123;\n        const newData = &#123;&#125;;\n        for (const key in data) &#123;\n            if (Object.prototype.hasOwnProperty.call(data, key)) &#123;\n                newData[key] = _deconstructPacket(data[key], buffers);\n            &#125;\n        &#125;\n        return newData;\n    &#125;\n    return data;\n&#125;\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param &#123;Object&#125; packet - event packet with placeholders\n * @param &#123;Array&#125; buffers - binary buffers to put in placeholder positions\n * @return &#123;Object&#125; reconstructed packet\n * @public\n */\nexport function reconstructPacket(packet, buffers) &#123;\n    packet.data = _reconstructPacket(packet.data, buffers);\n    packet.attachments = undefined; // no longer useful\n    return packet;\n&#125;\nfunction _reconstructPacket(data, buffers) &#123;\n    if (!data)\n        return data;\n    if (data &amp;&amp; data._placeholder) &#123;\n        return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n    &#125;\n    else if (Array.isArray(data)) &#123;\n        for (let i = 0; i &lt; data.length; i++) &#123;\n            data[i] = _reconstructPacket(data[i], buffers);\n        &#125;\n    &#125;\n    else if (typeof data === \&quot;object\&quot;) &#123;\n        for (const key in data) &#123;\n            if (Object.prototype.hasOwnProperty.call(data, key)) &#123;\n                data[key] = _reconstructPacket(data[key], buffers);\n            &#125;\n        &#125;\n    &#125;\n    return data;\n&#125;\n&quot;,&quot;import &#123; Emitter &#125; from \&quot;@socket.io/component-emitter\&quot;;\nimport &#123; deconstructPacket, reconstructPacket &#125; from \&quot;./binary.js\&quot;;\nimport &#123; isBinary, hasBinary &#125; from \&quot;./is-binary.js\&quot;;\n/**\n * Protocol version.\n *\n * @public\n */\nexport const protocol = 5;\nexport var PacketType;\n(function (PacketType) &#123;\n    PacketType[PacketType[\&quot;CONNECT\&quot;] = 0] = \&quot;CONNECT\&quot;;\n    PacketType[PacketType[\&quot;DISCONNECT\&quot;] = 1] = \&quot;DISCONNECT\&quot;;\n    PacketType[PacketType[\&quot;EVENT\&quot;] = 2] = \&quot;EVENT\&quot;;\n    PacketType[PacketType[\&quot;ACK\&quot;] = 3] = \&quot;ACK\&quot;;\n    PacketType[PacketType[\&quot;CONNECT_ERROR\&quot;] = 4] = \&quot;CONNECT_ERROR\&quot;;\n    PacketType[PacketType[\&quot;BINARY_EVENT\&quot;] = 5] = \&quot;BINARY_EVENT\&quot;;\n    PacketType[PacketType[\&quot;BINARY_ACK\&quot;] = 6] = \&quot;BINARY_ACK\&quot;;\n&#125;)(PacketType || (PacketType = &#123;&#125;));\n/**\n * A socket.io Encoder instance\n */\nexport class Encoder &#123;\n    /**\n     * Encoder constructor\n     *\n     * @param &#123;function&#125; replacer - custom replacer to pass down to JSON.parse\n     */\n    constructor(replacer) &#123;\n        this.replacer = replacer;\n    &#125;\n    /**\n     * Encode a packet as a single string if non-binary, or as a\n     * buffer sequence, depending on packet type.\n     *\n     * @param &#123;Object&#125; obj - packet object\n     */\n    encode(obj) &#123;\n        if (obj.type === PacketType.EVENT || obj.type === PacketType.ACK) &#123;\n            if (hasBinary(obj)) &#123;\n                obj.type =\n                    obj.type === PacketType.EVENT\n                        ? PacketType.BINARY_EVENT\n                        : PacketType.BINARY_ACK;\n                return this.encodeAsBinary(obj);\n            &#125;\n        &#125;\n        return [this.encodeAsString(obj)];\n    &#125;\n    /**\n     * Encode packet as string.\n     */\n    encodeAsString(obj) &#123;\n        // first is type\n        let str = \&quot;\&quot; + obj.type;\n        // attachments if we have them\n        if (obj.type === PacketType.BINARY_EVENT ||\n            obj.type === PacketType.BINARY_ACK) &#123;\n            str += obj.attachments + \&quot;-\&quot;;\n        &#125;\n        // if we have a namespace other than `/`\n        // we append it followed by a comma `,`\n        if (obj.nsp &amp;&amp; \&quot;/\&quot; !== obj.nsp) &#123;\n            str += obj.nsp + \&quot;,\&quot;;\n        &#125;\n        // immediately followed by the id\n        if (null != obj.id) &#123;\n            str += obj.id;\n        &#125;\n        // json data\n        if (null != obj.data) &#123;\n            str += JSON.stringify(obj.data, this.replacer);\n        &#125;\n        return str;\n    &#125;\n    /**\n     * Encode packet as &#x27;buffer sequence&#x27; by removing blobs, and\n     * deconstructing packet into object with placeholders and\n     * a list of buffers.\n     */\n    encodeAsBinary(obj) &#123;\n        const deconstruction = deconstructPacket(obj);\n        const pack = this.encodeAsString(deconstruction.packet);\n        const buffers = deconstruction.buffers;\n        buffers.unshift(pack); // add packet info to beginning of data list\n        return buffers; // write all the buffers\n    &#125;\n&#125;\n/**\n * A socket.io Decoder instance\n *\n * @return &#123;Object&#125; decoder\n */\nexport class Decoder extends Emitter &#123;\n    /**\n     * Decoder constructor\n     *\n     * @param &#123;function&#125; reviver - custom reviver to pass down to JSON.stringify\n     */\n    constructor(reviver) &#123;\n        super();\n        this.reviver = reviver;\n    &#125;\n    /**\n     * Decodes an encoded packet string into packet JSON.\n     *\n     * @param &#123;String&#125; obj - encoded packet\n     */\n    add(obj) &#123;\n        let packet;\n        if (typeof obj === \&quot;string\&quot;) &#123;\n            packet = this.decodeString(obj);\n            if (packet.type === PacketType.BINARY_EVENT ||\n                packet.type === PacketType.BINARY_ACK) &#123;\n                // binary packet&#x27;s json\n                this.reconstructor = new BinaryReconstructor(packet);\n                // no attachments, labeled binary but no binary data to follow\n                if (packet.attachments === 0) &#123;\n                    super.emitReserved(\&quot;decoded\&quot;, packet);\n                &#125;\n            &#125;\n            else &#123;\n                // non-binary full packet\n                super.emitReserved(\&quot;decoded\&quot;, packet);\n            &#125;\n        &#125;\n        else if (isBinary(obj) || obj.base64) &#123;\n            // raw binary data\n            if (!this.reconstructor) &#123;\n                throw new Error(\&quot;got binary data when not reconstructing a packet\&quot;);\n            &#125;\n            else &#123;\n                packet = this.reconstructor.takeBinaryData(obj);\n                if (packet) &#123;\n                    // received final buffer\n                    this.reconstructor = null;\n                    super.emitReserved(\&quot;decoded\&quot;, packet);\n                &#125;\n            &#125;\n        &#125;\n        else &#123;\n            throw new Error(\&quot;Unknown type: \&quot; + obj);\n        &#125;\n    &#125;\n    /**\n     * Decode a packet String (JSON data)\n     *\n     * @param &#123;String&#125; str\n     * @return &#123;Object&#125; packet\n     */\n    decodeString(str) &#123;\n        let i = 0;\n        // look up type\n        const p = &#123;\n            type: Number(str.charAt(0)),\n        &#125;;\n        if (PacketType[p.type] === undefined) &#123;\n            throw new Error(\&quot;unknown packet type \&quot; + p.type);\n        &#125;\n        // look up attachments if type binary\n        if (p.type === PacketType.BINARY_EVENT ||\n            p.type === PacketType.BINARY_ACK) &#123;\n            const start = i + 1;\n            while (str.charAt(++i) !== \&quot;-\&quot; &amp;&amp; i != str.length) &#123; &#125;\n            const buf = str.substring(start, i);\n            if (buf != Number(buf) || str.charAt(i) !== \&quot;-\&quot;) &#123;\n                throw new Error(\&quot;Illegal attachments\&quot;);\n            &#125;\n            p.attachments = Number(buf);\n        &#125;\n        // look up namespace (if any)\n        if (\&quot;/\&quot; === str.charAt(i + 1)) &#123;\n            const start = i + 1;\n            while (++i) &#123;\n                const c = str.charAt(i);\n                if (\&quot;,\&quot; === c)\n                    break;\n                if (i === str.length)\n                    break;\n            &#125;\n            p.nsp = str.substring(start, i);\n        &#125;\n        else &#123;\n            p.nsp = \&quot;/\&quot;;\n        &#125;\n        // look up id\n        const next = str.charAt(i + 1);\n        if (\&quot;\&quot; !== next &amp;&amp; Number(next) == next) &#123;\n            const start = i + 1;\n            while (++i) &#123;\n                const c = str.charAt(i);\n                if (null == c || Number(c) != c) &#123;\n                    --i;\n                    break;\n                &#125;\n                if (i === str.length)\n                    break;\n            &#125;\n            p.id = Number(str.substring(start, i + 1));\n        &#125;\n        // look up json data\n        if (str.charAt(++i)) &#123;\n            const payload = this.tryParse(str.substr(i));\n            if (Decoder.isPayloadValid(p.type, payload)) &#123;\n                p.data = payload;\n            &#125;\n            else &#123;\n                throw new Error(\&quot;invalid payload\&quot;);\n            &#125;\n        &#125;\n        return p;\n    &#125;\n    tryParse(str) &#123;\n        try &#123;\n            return JSON.parse(str, this.reviver);\n        &#125;\n        catch (e) &#123;\n            return false;\n        &#125;\n    &#125;\n    static isPayloadValid(type, payload) &#123;\n        switch (type) &#123;\n            case PacketType.CONNECT:\n                return typeof payload === \&quot;object\&quot;;\n            case PacketType.DISCONNECT:\n                return payload === undefined;\n            case PacketType.CONNECT_ERROR:\n                return typeof payload === \&quot;string\&quot; || typeof payload === \&quot;object\&quot;;\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                return Array.isArray(payload) &amp;&amp; payload.length &gt; 0;\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                return Array.isArray(payload);\n        &#125;\n    &#125;\n    /**\n     * Deallocates a parser&#x27;s resources\n     */\n    destroy() &#123;\n        if (this.reconstructor) &#123;\n            this.reconstructor.finishedReconstruction();\n        &#125;\n    &#125;\n&#125;\n/**\n * A manager of a binary event&#x27;s &#x27;buffer sequence&#x27;. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param &#123;Object&#125; packet\n * @return &#123;BinaryReconstructor&#125; initialized reconstructor\n */\nclass BinaryReconstructor &#123;\n    constructor(packet) &#123;\n        this.packet = packet;\n        this.buffers = [];\n        this.reconPack = packet;\n    &#125;\n    /**\n     * Method to be called when binary data received from connection\n     * after a BINARY_EVENT packet.\n     *\n     * @param &#123;Buffer | ArrayBuffer&#125; binData - the raw binary data received\n     * @return &#123;null | Object&#125; returns null if more binary data is expected or\n     *   a reconstructed packet object if all buffers have been received.\n     */\n    takeBinaryData(binData) &#123;\n        this.buffers.push(binData);\n        if (this.buffers.length === this.reconPack.attachments) &#123;\n            // done with buffer list\n            const packet = reconstructPacket(this.reconPack, this.buffers);\n            this.finishedReconstruction();\n            return packet;\n        &#125;\n        return null;\n    &#125;\n    /**\n     * Cleans up binary packet reconstruction variables.\n     */\n    finishedReconstruction() &#123;\n        this.reconPack = null;\n        this.buffers = [];\n    &#125;\n&#125;\n&quot;,&quot;export function on(obj, ev, fn) &#123;\n    obj.on(ev, fn);\n    return function subDestroy() &#123;\n        obj.off(ev, fn);\n    &#125;;\n&#125;\n&quot;,&quot;import &#123; PacketType &#125; from \&quot;socket.io-parser\&quot;;\nimport &#123; on &#125; from \&quot;./on.js\&quot;;\nimport &#123; Emitter, &#125; from \&quot;@socket.io/component-emitter\&quot;;\n/**\n * Internal events.\n * These events can&#x27;t be emitted by the user.\n */\nconst RESERVED_EVENTS = Object.freeze(&#123;\n    connect: 1,\n    connect_error: 1,\n    disconnect: 1,\n    disconnecting: 1,\n    // EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener\n    newListener: 1,\n    removeListener: 1,\n&#125;);\nexport class Socket extends Emitter &#123;\n    /**\n     * `Socket` constructor.\n     *\n     * @public\n     */\n    constructor(io, nsp, opts) &#123;\n        super();\n        this.connected = false;\n        this.receiveBuffer = [];\n        this.sendBuffer = [];\n        this.ids = 0;\n        this.acks = &#123;&#125;;\n        this.flags = &#123;&#125;;\n        this.io = io;\n        this.nsp = nsp;\n        if (opts &amp;&amp; opts.auth) &#123;\n            this.auth = opts.auth;\n        &#125;\n        if (this.io._autoConnect)\n            this.open();\n    &#125;\n    /**\n     * Whether the socket is currently disconnected\n     */\n    get disconnected() &#123;\n        return !this.connected;\n    &#125;\n    /**\n     * Subscribe to open, close and packet events\n     *\n     * @private\n     */\n    subEvents() &#123;\n        if (this.subs)\n            return;\n        const io = this.io;\n        this.subs = [\n            on(io, \&quot;open\&quot;, this.onopen.bind(this)),\n            on(io, \&quot;packet\&quot;, this.onpacket.bind(this)),\n            on(io, \&quot;error\&quot;, this.onerror.bind(this)),\n            on(io, \&quot;close\&quot;, this.onclose.bind(this)),\n        ];\n    &#125;\n    /**\n     * Whether the Socket will try to reconnect when its Manager connects or reconnects\n     */\n    get active() &#123;\n        return !!this.subs;\n    &#125;\n    /**\n     * \&quot;Opens\&quot; the socket.\n     *\n     * @public\n     */\n    connect() &#123;\n        if (this.connected)\n            return this;\n        this.subEvents();\n        if (!this.io[\&quot;_reconnecting\&quot;])\n            this.io.open(); // ensure open\n        if (\&quot;open\&quot; === this.io._readyState)\n            this.onopen();\n        return this;\n    &#125;\n    /**\n     * Alias for connect()\n     */\n    open() &#123;\n        return this.connect();\n    &#125;\n    /**\n     * Sends a `message` event.\n     *\n     * @return self\n     * @public\n     */\n    send(...args) &#123;\n        args.unshift(\&quot;message\&quot;);\n        this.emit.apply(this, args);\n        return this;\n    &#125;\n    /**\n     * Override `emit`.\n     * If the event is in `events`, it&#x27;s emitted normally.\n     *\n     * @return self\n     * @public\n     */\n    emit(ev, ...args) &#123;\n        if (RESERVED_EVENTS.hasOwnProperty(ev)) &#123;\n            throw new Error(&#x27;\&quot;&#x27; + ev + &#x27;\&quot; is a reserved event name&#x27;);\n        &#125;\n        args.unshift(ev);\n        const packet = &#123;\n            type: PacketType.EVENT,\n            data: args,\n        &#125;;\n        packet.options = &#123;&#125;;\n        packet.options.compress = this.flags.compress !== false;\n        // event ack callback\n        if (\&quot;function\&quot; === typeof args[args.length - 1]) &#123;\n            const id = this.ids++;\n            const ack = args.pop();\n            this._registerAckCallback(id, ack);\n            packet.id = id;\n        &#125;\n        const isTransportWritable = this.io.engine &amp;&amp;\n            this.io.engine.transport &amp;&amp;\n            this.io.engine.transport.writable;\n        const discardPacket = this.flags.volatile &amp;&amp; (!isTransportWritable || !this.connected);\n        if (discardPacket) &#123;\n        &#125;\n        else if (this.connected) &#123;\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        &#125;\n        else &#123;\n            this.sendBuffer.push(packet);\n        &#125;\n        this.flags = &#123;&#125;;\n        return this;\n    &#125;\n    /**\n     * @private\n     */\n    _registerAckCallback(id, ack) &#123;\n        const timeout = this.flags.timeout;\n        if (timeout === undefined) &#123;\n            this.acks[id] = ack;\n            return;\n        &#125;\n        // @ts-ignore\n        const timer = this.io.setTimeoutFn(() =&gt; &#123;\n            delete this.acks[id];\n            for (let i = 0; i &lt; this.sendBuffer.length; i++) &#123;\n                if (this.sendBuffer[i].id === id) &#123;\n                    this.sendBuffer.splice(i, 1);\n                &#125;\n            &#125;\n            ack.call(this, new Error(\&quot;operation has timed out\&quot;));\n        &#125;, timeout);\n        this.acks[id] = (...args) =&gt; &#123;\n            // @ts-ignore\n            this.io.clearTimeoutFn(timer);\n            ack.apply(this, [null, ...args]);\n        &#125;;\n    &#125;\n    /**\n     * Sends a packet.\n     *\n     * @param packet\n     * @private\n     */\n    packet(packet) &#123;\n        packet.nsp = this.nsp;\n        this.io._packet(packet);\n    &#125;\n    /**\n     * Called upon engine `open`.\n     *\n     * @private\n     */\n    onopen() &#123;\n        if (typeof this.auth == \&quot;function\&quot;) &#123;\n            this.auth((data) =&gt; &#123;\n                this.packet(&#123; type: PacketType.CONNECT, data &#125;);\n            &#125;);\n        &#125;\n        else &#123;\n            this.packet(&#123; type: PacketType.CONNECT, data: this.auth &#125;);\n        &#125;\n    &#125;\n    /**\n     * Called upon engine or manager `error`.\n     *\n     * @param err\n     * @private\n     */\n    onerror(err) &#123;\n        if (!this.connected) &#123;\n            this.emitReserved(\&quot;connect_error\&quot;, err);\n        &#125;\n    &#125;\n    /**\n     * Called upon engine `close`.\n     *\n     * @param reason\n     * @param description\n     * @private\n     */\n    onclose(reason, description) &#123;\n        this.connected = false;\n        delete this.id;\n        this.emitReserved(\&quot;disconnect\&quot;, reason, description);\n    &#125;\n    /**\n     * Called with socket packet.\n     *\n     * @param packet\n     * @private\n     */\n    onpacket(packet) &#123;\n        const sameNamespace = packet.nsp === this.nsp;\n        if (!sameNamespace)\n            return;\n        switch (packet.type) &#123;\n            case PacketType.CONNECT:\n                if (packet.data &amp;&amp; packet.data.sid) &#123;\n                    const id = packet.data.sid;\n                    this.onconnect(id);\n                &#125;\n                else &#123;\n                    this.emitReserved(\&quot;connect_error\&quot;, new Error(\&quot;It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)\&quot;));\n                &#125;\n                break;\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                this.onevent(packet);\n                break;\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                this.onack(packet);\n                break;\n            case PacketType.DISCONNECT:\n                this.ondisconnect();\n                break;\n            case PacketType.CONNECT_ERROR:\n                this.destroy();\n                const err = new Error(packet.data.message);\n                // @ts-ignore\n                err.data = packet.data.data;\n                this.emitReserved(\&quot;connect_error\&quot;, err);\n                break;\n        &#125;\n    &#125;\n    /**\n     * Called upon a server event.\n     *\n     * @param packet\n     * @private\n     */\n    onevent(packet) &#123;\n        const args = packet.data || [];\n        if (null != packet.id) &#123;\n            args.push(this.ack(packet.id));\n        &#125;\n        if (this.connected) &#123;\n            this.emitEvent(args);\n        &#125;\n        else &#123;\n            this.receiveBuffer.push(Object.freeze(args));\n        &#125;\n    &#125;\n    emitEvent(args) &#123;\n        if (this._anyListeners &amp;&amp; this._anyListeners.length) &#123;\n            const listeners = this._anyListeners.slice();\n            for (const listener of listeners) &#123;\n                listener.apply(this, args);\n            &#125;\n        &#125;\n        super.emit.apply(this, args);\n    &#125;\n    /**\n     * Produces an ack callback to emit with an event.\n     *\n     * @private\n     */\n    ack(id) &#123;\n        const self = this;\n        let sent = false;\n        return function (...args) &#123;\n            // prevent double callbacks\n            if (sent)\n                return;\n            sent = true;\n            self.packet(&#123;\n                type: PacketType.ACK,\n                id: id,\n                data: args,\n            &#125;);\n        &#125;;\n    &#125;\n    /**\n     * Called upon a server acknowlegement.\n     *\n     * @param packet\n     * @private\n     */\n    onack(packet) &#123;\n        const ack = this.acks[packet.id];\n        if (\&quot;function\&quot; === typeof ack) &#123;\n            ack.apply(this, packet.data);\n            delete this.acks[packet.id];\n        &#125;\n        else &#123;\n        &#125;\n    &#125;\n    /**\n     * Called upon server connect.\n     *\n     * @private\n     */\n    onconnect(id) &#123;\n        this.id = id;\n        this.connected = true;\n        this.emitBuffered();\n        this.emitReserved(\&quot;connect\&quot;);\n    &#125;\n    /**\n     * Emit buffered events (received and emitted).\n     *\n     * @private\n     */\n    emitBuffered() &#123;\n        this.receiveBuffer.forEach((args) =&gt; this.emitEvent(args));\n        this.receiveBuffer = [];\n        this.sendBuffer.forEach((packet) =&gt; &#123;\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        &#125;);\n        this.sendBuffer = [];\n    &#125;\n    /**\n     * Called upon server disconnect.\n     *\n     * @private\n     */\n    ondisconnect() &#123;\n        this.destroy();\n        this.onclose(\&quot;io server disconnect\&quot;);\n    &#125;\n    /**\n     * Called upon forced client/server side disconnections,\n     * this method ensures the manager stops tracking us and\n     * that reconnections don&#x27;t get triggered for this.\n     *\n     * @private\n     */\n    destroy() &#123;\n        if (this.subs) &#123;\n            // clean subscriptions to avoid reconnections\n            this.subs.forEach((subDestroy) =&gt; subDestroy());\n            this.subs = undefined;\n        &#125;\n        this.io[\&quot;_destroy\&quot;](this);\n    &#125;\n    /**\n     * Disconnects the socket manually.\n     *\n     * @return self\n     * @public\n     */\n    disconnect() &#123;\n        if (this.connected) &#123;\n            this.packet(&#123; type: PacketType.DISCONNECT &#125;);\n        &#125;\n        // remove socket from pool\n        this.destroy();\n        if (this.connected) &#123;\n            // fire events\n            this.onclose(\&quot;io client disconnect\&quot;);\n        &#125;\n        return this;\n    &#125;\n    /**\n     * Alias for disconnect()\n     *\n     * @return self\n     * @public\n     */\n    close() &#123;\n        return this.disconnect();\n    &#125;\n    /**\n     * Sets the compress flag.\n     *\n     * @param compress - if `true`, compresses the sending data\n     * @return self\n     * @public\n     */\n    compress(compress) &#123;\n        this.flags.compress = compress;\n        return this;\n    &#125;\n    /**\n     * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not\n     * ready to send messages.\n     *\n     * @returns self\n     * @public\n     */\n    get volatile() &#123;\n        this.flags.volatile = true;\n        return this;\n    &#125;\n    /**\n     * Sets a modifier for a subsequent event emission that the callback will be called with an error when the\n     * given number of milliseconds have elapsed without an acknowledgement from the server:\n     *\n     * ```\n     * socket.timeout(5000).emit(\&quot;my-event\&quot;, (err) =&gt; &#123;\n     *   if (err) &#123;\n     *     // the server did not acknowledge the event in the given delay\n     *   &#125;\n     * &#125;);\n     * ```\n     *\n     * @returns self\n     * @public\n     */\n    timeout(timeout) &#123;\n        this.flags.timeout = timeout;\n        return this;\n    &#125;\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @param listener\n     * @public\n     */\n    onAny(listener) &#123;\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.push(listener);\n        return this;\n    &#125;\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @param listener\n     * @public\n     */\n    prependAny(listener) &#123;\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.unshift(listener);\n        return this;\n    &#125;\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @param listener\n     * @public\n     */\n    offAny(listener) &#123;\n        if (!this._anyListeners) &#123;\n            return this;\n        &#125;\n        if (listener) &#123;\n            const listeners = this._anyListeners;\n            for (let i = 0; i &lt; listeners.length; i++) &#123;\n                if (listener === listeners[i]) &#123;\n                    listeners.splice(i, 1);\n                    return this;\n                &#125;\n            &#125;\n        &#125;\n        else &#123;\n            this._anyListeners = [];\n        &#125;\n        return this;\n    &#125;\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     *\n     * @public\n     */\n    listenersAny() &#123;\n        return this._anyListeners || [];\n    &#125;\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @param listener\n     *\n     * &lt;pre&gt;&lt;code&gt;\n     *\n     * socket.onAnyOutgoing((event, ...args) =&gt; &#123;\n     *   console.log(event);\n     * &#125;);\n     *\n     * &lt;/pre&gt;&lt;/code&gt;\n     *\n     * @public\n     */\n    onAnyOutgoing(listener) &#123;\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.push(listener);\n        return this;\n    &#125;\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @param listener\n     *\n     * &lt;pre&gt;&lt;code&gt;\n     *\n     * socket.prependAnyOutgoing((event, ...args) =&gt; &#123;\n     *   console.log(event);\n     * &#125;);\n     *\n     * &lt;/pre&gt;&lt;/code&gt;\n     *\n     * @public\n     */\n    prependAnyOutgoing(listener) &#123;\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.unshift(listener);\n        return this;\n    &#125;\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @param listener\n     *\n     * &lt;pre&gt;&lt;code&gt;\n     *\n     * const handler = (event, ...args) =&gt; &#123;\n     *   console.log(event);\n     * &#125;\n     *\n     * socket.onAnyOutgoing(handler);\n     *\n     * // then later\n     * socket.offAnyOutgoing(handler);\n     *\n     * &lt;/pre&gt;&lt;/code&gt;\n     *\n     * @public\n     */\n    offAnyOutgoing(listener) &#123;\n        if (!this._anyOutgoingListeners) &#123;\n            return this;\n        &#125;\n        if (listener) &#123;\n            const listeners = this._anyOutgoingListeners;\n            for (let i = 0; i &lt; listeners.length; i++) &#123;\n                if (listener === listeners[i]) &#123;\n                    listeners.splice(i, 1);\n                    return this;\n                &#125;\n            &#125;\n        &#125;\n        else &#123;\n            this._anyOutgoingListeners = [];\n        &#125;\n        return this;\n    &#125;\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     *\n     * @public\n     */\n    listenersAnyOutgoing() &#123;\n        return this._anyOutgoingListeners || [];\n    &#125;\n    /**\n     * Notify the listeners for each packet sent\n     *\n     * @param packet\n     *\n     * @private\n     */\n    notifyOutgoingListeners(packet) &#123;\n        if (this._anyOutgoingListeners &amp;&amp; this._anyOutgoingListeners.length) &#123;\n            const listeners = this._anyOutgoingListeners.slice();\n            for (const listener of listeners) &#123;\n                listener.apply(this, packet.data);\n            &#125;\n        &#125;\n    &#125;\n&#125;\n&quot;,&quot;/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param &#123;Object&#125; opts\n * @api public\n */\nexport function Backoff(opts) &#123;\n    opts = opts || &#123;&#125;;\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n    this.factor = opts.factor || 2;\n    this.jitter = opts.jitter &gt; 0 &amp;&amp; opts.jitter &lt;= 1 ? opts.jitter : 0;\n    this.attempts = 0;\n&#125;\n/**\n * Return the backoff duration.\n *\n * @return &#123;Number&#125;\n * @api public\n */\nBackoff.prototype.duration = function () &#123;\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n    if (this.jitter) &#123;\n        var rand = Math.random();\n        var deviation = Math.floor(rand * this.jitter * ms);\n        ms = (Math.floor(rand * 10) &amp; 1) == 0 ? ms - deviation : ms + deviation;\n    &#125;\n    return Math.min(ms, this.max) | 0;\n&#125;;\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\nBackoff.prototype.reset = function () &#123;\n    this.attempts = 0;\n&#125;;\n/**\n * Set the minimum duration\n *\n * @api public\n */\nBackoff.prototype.setMin = function (min) &#123;\n    this.ms = min;\n&#125;;\n/**\n * Set the maximum duration\n *\n * @api public\n */\nBackoff.prototype.setMax = function (max) &#123;\n    this.max = max;\n&#125;;\n/**\n * Set the jitter\n *\n * @api public\n */\nBackoff.prototype.setJitter = function (jitter) &#123;\n    this.jitter = jitter;\n&#125;;\n&quot;,&quot;import &#123; Socket as Engine, installTimerFunctions, &#125; from \&quot;engine.io-client\&quot;;\nimport &#123; Socket &#125; from \&quot;./socket.js\&quot;;\nimport * as parser from \&quot;socket.io-parser\&quot;;\nimport &#123; on &#125; from \&quot;./on.js\&quot;;\nimport &#123; Backoff &#125; from \&quot;./contrib/backo2.js\&quot;;\nimport &#123; Emitter, &#125; from \&quot;@socket.io/component-emitter\&quot;;\nexport class Manager extends Emitter &#123;\n    constructor(uri, opts) &#123;\n        var _a;\n        super();\n        this.nsps = &#123;&#125;;\n        this.subs = [];\n        if (uri &amp;&amp; \&quot;object\&quot; === typeof uri) &#123;\n            opts = uri;\n            uri = undefined;\n        &#125;\n        opts = opts || &#123;&#125;;\n        opts.path = opts.path || \&quot;/socket.io\&quot;;\n        this.opts = opts;\n        installTimerFunctions(this, opts);\n        this.reconnection(opts.reconnection !== false);\n        this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n        this.reconnectionDelay(opts.reconnectionDelay || 1000);\n        this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n        this.randomizationFactor((_a = opts.randomizationFactor) !== null &amp;&amp; _a !== void 0 ? _a : 0.5);\n        this.backoff = new Backoff(&#123;\n            min: this.reconnectionDelay(),\n            max: this.reconnectionDelayMax(),\n            jitter: this.randomizationFactor(),\n        &#125;);\n        this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n        this._readyState = \&quot;closed\&quot;;\n        this.uri = uri;\n        const _parser = opts.parser || parser;\n        this.encoder = new _parser.Encoder();\n        this.decoder = new _parser.Decoder();\n        this._autoConnect = opts.autoConnect !== false;\n        if (this._autoConnect)\n            this.open();\n    &#125;\n    reconnection(v) &#123;\n        if (!arguments.length)\n            return this._reconnection;\n        this._reconnection = !!v;\n        return this;\n    &#125;\n    reconnectionAttempts(v) &#123;\n        if (v === undefined)\n            return this._reconnectionAttempts;\n        this._reconnectionAttempts = v;\n        return this;\n    &#125;\n    reconnectionDelay(v) &#123;\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelay;\n        this._reconnectionDelay = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMin(v);\n        return this;\n    &#125;\n    randomizationFactor(v) &#123;\n        var _a;\n        if (v === undefined)\n            return this._randomizationFactor;\n        this._randomizationFactor = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setJitter(v);\n        return this;\n    &#125;\n    reconnectionDelayMax(v) &#123;\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelayMax;\n        this._reconnectionDelayMax = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMax(v);\n        return this;\n    &#125;\n    timeout(v) &#123;\n        if (!arguments.length)\n            return this._timeout;\n        this._timeout = v;\n        return this;\n    &#125;\n    /**\n     * Starts trying to reconnect if reconnection is enabled and we have not\n     * started reconnecting yet\n     *\n     * @private\n     */\n    maybeReconnectOnOpen() &#123;\n        // Only try to reconnect if it&#x27;s the first time we&#x27;re connecting\n        if (!this._reconnecting &amp;&amp;\n            this._reconnection &amp;&amp;\n            this.backoff.attempts === 0) &#123;\n            // keeps reconnection from firing twice for the same reconnection loop\n            this.reconnect();\n        &#125;\n    &#125;\n    /**\n     * Sets the current transport `socket`.\n     *\n     * @param &#123;Function&#125; fn - optional, callback\n     * @return self\n     * @public\n     */\n    open(fn) &#123;\n        if (~this._readyState.indexOf(\&quot;open\&quot;))\n            return this;\n        this.engine = new Engine(this.uri, this.opts);\n        const socket = this.engine;\n        const self = this;\n        this._readyState = \&quot;opening\&quot;;\n        this.skipReconnect = false;\n        // emit `open`\n        const openSubDestroy = on(socket, \&quot;open\&quot;, function () &#123;\n            self.onopen();\n            fn &amp;&amp; fn();\n        &#125;);\n        // emit `error`\n        const errorSub = on(socket, \&quot;error\&quot;, (err) =&gt; &#123;\n            self.cleanup();\n            self._readyState = \&quot;closed\&quot;;\n            this.emitReserved(\&quot;error\&quot;, err);\n            if (fn) &#123;\n                fn(err);\n            &#125;\n            else &#123;\n                // Only do this if there is no fn to handle the error\n                self.maybeReconnectOnOpen();\n            &#125;\n        &#125;);\n        if (false !== this._timeout) &#123;\n            const timeout = this._timeout;\n            if (timeout === 0) &#123;\n                openSubDestroy(); // prevents a race condition with the &#x27;open&#x27; event\n            &#125;\n            // set timer\n            const timer = this.setTimeoutFn(() =&gt; &#123;\n                openSubDestroy();\n                socket.close();\n                // @ts-ignore\n                socket.emit(\&quot;error\&quot;, new Error(\&quot;timeout\&quot;));\n            &#125;, timeout);\n            if (this.opts.autoUnref) &#123;\n                timer.unref();\n            &#125;\n            this.subs.push(function subDestroy() &#123;\n                clearTimeout(timer);\n            &#125;);\n        &#125;\n        this.subs.push(openSubDestroy);\n        this.subs.push(errorSub);\n        return this;\n    &#125;\n    /**\n     * Alias for open()\n     *\n     * @return self\n     * @public\n     */\n    connect(fn) &#123;\n        return this.open(fn);\n    &#125;\n    /**\n     * Called upon transport open.\n     *\n     * @private\n     */\n    onopen() &#123;\n        // clear old subs\n        this.cleanup();\n        // mark as open\n        this._readyState = \&quot;open\&quot;;\n        this.emitReserved(\&quot;open\&quot;);\n        // add new subs\n        const socket = this.engine;\n        this.subs.push(on(socket, \&quot;ping\&quot;, this.onping.bind(this)), on(socket, \&quot;data\&quot;, this.ondata.bind(this)), on(socket, \&quot;error\&quot;, this.onerror.bind(this)), on(socket, \&quot;close\&quot;, this.onclose.bind(this)), on(this.decoder, \&quot;decoded\&quot;, this.ondecoded.bind(this)));\n    &#125;\n    /**\n     * Called upon a ping.\n     *\n     * @private\n     */\n    onping() &#123;\n        this.emitReserved(\&quot;ping\&quot;);\n    &#125;\n    /**\n     * Called with data.\n     *\n     * @private\n     */\n    ondata(data) &#123;\n        this.decoder.add(data);\n    &#125;\n    /**\n     * Called when parser fully decodes a packet.\n     *\n     * @private\n     */\n    ondecoded(packet) &#123;\n        this.emitReserved(\&quot;packet\&quot;, packet);\n    &#125;\n    /**\n     * Called upon socket error.\n     *\n     * @private\n     */\n    onerror(err) &#123;\n        this.emitReserved(\&quot;error\&quot;, err);\n    &#125;\n    /**\n     * Creates a new socket for the given `nsp`.\n     *\n     * @return &#123;Socket&#125;\n     * @public\n     */\n    socket(nsp, opts) &#123;\n        let socket = this.nsps[nsp];\n        if (!socket) &#123;\n            socket = new Socket(this, nsp, opts);\n            this.nsps[nsp] = socket;\n        &#125;\n        return socket;\n    &#125;\n    /**\n     * Called upon a socket close.\n     *\n     * @param socket\n     * @private\n     */\n    _destroy(socket) &#123;\n        const nsps = Object.keys(this.nsps);\n        for (const nsp of nsps) &#123;\n            const socket = this.nsps[nsp];\n            if (socket.active) &#123;\n                return;\n            &#125;\n        &#125;\n        this._close();\n    &#125;\n    /**\n     * Writes a packet.\n     *\n     * @param packet\n     * @private\n     */\n    _packet(packet) &#123;\n        const encodedPackets = this.encoder.encode(packet);\n        for (let i = 0; i &lt; encodedPackets.length; i++) &#123;\n            this.engine.write(encodedPackets[i], packet.options);\n        &#125;\n    &#125;\n    /**\n     * Clean up transport subscriptions and packet buffer.\n     *\n     * @private\n     */\n    cleanup() &#123;\n        this.subs.forEach((subDestroy) =&gt; subDestroy());\n        this.subs.length = 0;\n        this.decoder.destroy();\n    &#125;\n    /**\n     * Close the current socket.\n     *\n     * @private\n     */\n    _close() &#123;\n        this.skipReconnect = true;\n        this._reconnecting = false;\n        this.onclose(\&quot;forced close\&quot;);\n        if (this.engine)\n            this.engine.close();\n    &#125;\n    /**\n     * Alias for close()\n     *\n     * @private\n     */\n    disconnect() &#123;\n        return this._close();\n    &#125;\n    /**\n     * Called upon engine close.\n     *\n     * @private\n     */\n    onclose(reason, description) &#123;\n        this.cleanup();\n        this.backoff.reset();\n        this._readyState = \&quot;closed\&quot;;\n        this.emitReserved(\&quot;close\&quot;, reason, description);\n        if (this._reconnection &amp;&amp; !this.skipReconnect) &#123;\n            this.reconnect();\n        &#125;\n    &#125;\n    /**\n     * Attempt a reconnection.\n     *\n     * @private\n     */\n    reconnect() &#123;\n        if (this._reconnecting || this.skipReconnect)\n            return this;\n        const self = this;\n        if (this.backoff.attempts &gt;= this._reconnectionAttempts) &#123;\n            this.backoff.reset();\n            this.emitReserved(\&quot;reconnect_failed\&quot;);\n            this._reconnecting = false;\n        &#125;\n        else &#123;\n            const delay = this.backoff.duration();\n            this._reconnecting = true;\n            const timer = this.setTimeoutFn(() =&gt; &#123;\n                if (self.skipReconnect)\n                    return;\n                this.emitReserved(\&quot;reconnect_attempt\&quot;, self.backoff.attempts);\n                // check again for the case socket closed in above events\n                if (self.skipReconnect)\n                    return;\n                self.open((err) =&gt; &#123;\n                    if (err) &#123;\n                        self._reconnecting = false;\n                        self.reconnect();\n                        this.emitReserved(\&quot;reconnect_error\&quot;, err);\n                    &#125;\n                    else &#123;\n                        self.onreconnect();\n                    &#125;\n                &#125;);\n            &#125;, delay);\n            if (this.opts.autoUnref) &#123;\n                timer.unref();\n            &#125;\n            this.subs.push(function subDestroy() &#123;\n                clearTimeout(timer);\n            &#125;);\n        &#125;\n    &#125;\n    /**\n     * Called upon successful reconnect.\n     *\n     * @private\n     */\n    onreconnect() &#123;\n        const attempt = this.backoff.attempts;\n        this._reconnecting = false;\n        this.backoff.reset();\n        this.emitReserved(\&quot;reconnect\&quot;, attempt);\n    &#125;\n&#125;\n&quot;,&quot;import &#123; url &#125; from \&quot;./url.js\&quot;;\nimport &#123; Manager &#125; from \&quot;./manager.js\&quot;;\nimport &#123; Socket &#125; from \&quot;./socket.js\&quot;;\n/**\n * Managers cache.\n */\nconst cache = &#123;&#125;;\nfunction lookup(uri, opts) &#123;\n    if (typeof uri === \&quot;object\&quot;) &#123;\n        opts = uri;\n        uri = undefined;\n    &#125;\n    opts = opts || &#123;&#125;;\n    const parsed = url(uri, opts.path || \&quot;/socket.io\&quot;);\n    const source = parsed.source;\n    const id = parsed.id;\n    const path = parsed.path;\n    const sameNamespace = cache[id] &amp;&amp; path in cache[id][\&quot;nsps\&quot;];\n    const newConnection = opts.forceNew ||\n        opts[\&quot;force new connection\&quot;] ||\n        false === opts.multiplex ||\n        sameNamespace;\n    let io;\n    if (newConnection) &#123;\n        io = new Manager(source, opts);\n    &#125;\n    else &#123;\n        if (!cache[id]) &#123;\n            cache[id] = new Manager(source, opts);\n        &#125;\n        io = cache[id];\n    &#125;\n    if (parsed.query &amp;&amp; !opts.query) &#123;\n        opts.query = parsed.queryKey;\n    &#125;\n    return io.socket(parsed.path, opts);\n&#125;\n// so that \&quot;lookup\&quot; can be used both as a function (e.g. `io(...)`) and as a\n// namespace (e.g. `io.connect(...)`), for backward compatibility\nObject.assign(lookup, &#123;\n    Manager,\n    Socket,\n    io: lookup,\n    connect: lookup,\n&#125;);\n/**\n * Protocol version.\n *\n * @public\n */\nexport &#123; protocol &#125; from \&quot;socket.io-parser\&quot;;\n/**\n * Expose constructors for standalone build.\n *\n * @public\n */\nexport &#123; Manager, Socket, lookup as io, lookup as connect, lookup as default, &#125;;\n&quot;],&quot;names&quot;:[&quot;PACKET_TYPES&quot;,&quot;Object&quot;,&quot;create&quot;,&quot;PACKET_TYPES_REVERSE&quot;,&quot;keys&quot;,&quot;forEach&quot;,&quot;key&quot;,&quot;ERROR_PACKET&quot;,&quot;type&quot;,&quot;data&quot;,&quot;withNativeBlob&quot;,&quot;Blob&quot;,&quot;prototype&quot;,&quot;toString&quot;,&quot;call&quot;,&quot;withNativeArrayBuffer&quot;,&quot;ArrayBuffer&quot;,&quot;isView&quot;,&quot;obj&quot;,&quot;buffer&quot;,&quot;encodePacket&quot;,&quot;supportsBinary&quot;,&quot;callback&quot;,&quot;encodeBlobAsBase64&quot;,&quot;fileReader&quot;,&quot;FileReader&quot;,&quot;onload&quot;,&quot;content&quot;,&quot;result&quot;,&quot;split&quot;,&quot;readAsDataURL&quot;,&quot;lookup&quot;,&quot;i&quot;,&quot;decode&quot;,&quot;decodePacket&quot;,&quot;encodedPacket&quot;,&quot;binaryType&quot;,&quot;mapBinary&quot;,&quot;charAt&quot;,&quot;decodeBase64Packet&quot;,&quot;substring&quot;,&quot;packetType&quot;,&quot;length&quot;,&quot;decoded&quot;,&quot;base64&quot;,&quot;SEPARATOR&quot;,&quot;String&quot;,&quot;fromCharCode&quot;,&quot;encodePayload&quot;,&quot;packets&quot;,&quot;encodedPackets&quot;,&quot;Array&quot;,&quot;count&quot;,&quot;packet&quot;,&quot;join&quot;,&quot;decodePayload&quot;,&quot;encodedPayload&quot;,&quot;decodedPacket&quot;,&quot;push&quot;,&quot;protocol&quot;,&quot;Emitter&quot;,&quot;mixin&quot;,&quot;on&quot;,&quot;addEventListener&quot;,&quot;event&quot;,&quot;fn&quot;,&quot;_callbacks&quot;,&quot;once&quot;,&quot;off&quot;,&quot;apply&quot;,&quot;arguments&quot;,&quot;removeListener&quot;,&quot;removeAllListeners&quot;,&quot;removeEventListener&quot;,&quot;callbacks&quot;,&quot;cb&quot;,&quot;splice&quot;,&quot;emit&quot;,&quot;args&quot;,&quot;slice&quot;,&quot;len&quot;,&quot;emitReserved&quot;,&quot;listeners&quot;,&quot;hasListeners&quot;,&quot;self&quot;,&quot;window&quot;,&quot;Function&quot;,&quot;pick&quot;,&quot;attr&quot;,&quot;reduce&quot;,&quot;acc&quot;,&quot;k&quot;,&quot;hasOwnProperty&quot;,&quot;NATIVE_SET_TIMEOUT&quot;,&quot;setTimeout&quot;,&quot;NATIVE_CLEAR_TIMEOUT&quot;,&quot;clearTimeout&quot;,&quot;installTimerFunctions&quot;,&quot;opts&quot;,&quot;useNativeTimers&quot;,&quot;setTimeoutFn&quot;,&quot;bind&quot;,&quot;globalThis&quot;,&quot;clearTimeoutFn&quot;,&quot;BASE64_OVERHEAD&quot;,&quot;byteLength&quot;,&quot;utf8Length&quot;,&quot;Math&quot;,&quot;ceil&quot;,&quot;size&quot;,&quot;str&quot;,&quot;c&quot;,&quot;l&quot;,&quot;charCodeAt&quot;,&quot;TransportError&quot;,&quot;reason&quot;,&quot;description&quot;,&quot;context&quot;,&quot;Error&quot;,&quot;Transport&quot;,&quot;writable&quot;,&quot;query&quot;,&quot;readyState&quot;,&quot;socket&quot;,&quot;doOpen&quot;,&quot;doClose&quot;,&quot;onClose&quot;,&quot;write&quot;,&quot;onPacket&quot;,&quot;details&quot;,&quot;alphabet&quot;,&quot;map&quot;,&quot;seed&quot;,&quot;prev&quot;,&quot;encode&quot;,&quot;num&quot;,&quot;encoded&quot;,&quot;floor&quot;,&quot;yeast&quot;,&quot;now&quot;,&quot;Date&quot;,&quot;encodeURIComponent&quot;,&quot;qs&quot;,&quot;qry&quot;,&quot;pairs&quot;,&quot;pair&quot;,&quot;decodeURIComponent&quot;,&quot;value&quot;,&quot;XMLHttpRequest&quot;,&quot;err&quot;,&quot;hasCORS&quot;,&quot;xdomain&quot;,&quot;e&quot;,&quot;concat&quot;,&quot;empty&quot;,&quot;hasXHR2&quot;,&quot;xhr&quot;,&quot;responseType&quot;,&quot;Polling&quot;,&quot;polling&quot;,&quot;location&quot;,&quot;isSSL&quot;,&quot;port&quot;,&quot;xd&quot;,&quot;hostname&quot;,&quot;xs&quot;,&quot;secure&quot;,&quot;forceBase64&quot;,&quot;poll&quot;,&quot;onPause&quot;,&quot;pause&quot;,&quot;total&quot;,&quot;doPoll&quot;,&quot;onOpen&quot;,&quot;close&quot;,&quot;doWrite&quot;,&quot;schema&quot;,&quot;timestampRequests&quot;,&quot;timestampParam&quot;,&quot;sid&quot;,&quot;b64&quot;,&quot;Number&quot;,&quot;encodedQuery&quot;,&quot;ipv6&quot;,&quot;indexOf&quot;,&quot;path&quot;,&quot;Request&quot;,&quot;uri&quot;,&quot;req&quot;,&quot;request&quot;,&quot;method&quot;,&quot;xhrStatus&quot;,&quot;onError&quot;,&quot;onData&quot;,&quot;pollXhr&quot;,&quot;async&quot;,&quot;undefined&quot;,&quot;xscheme&quot;,&quot;open&quot;,&quot;extraHeaders&quot;,&quot;setDisableHeaderCheck&quot;,&quot;setRequestHeader&quot;,&quot;withCredentials&quot;,&quot;requestTimeout&quot;,&quot;timeout&quot;,&quot;onreadystatechange&quot;,&quot;status&quot;,&quot;onLoad&quot;,&quot;send&quot;,&quot;document&quot;,&quot;index&quot;,&quot;requestsCount&quot;,&quot;requests&quot;,&quot;cleanup&quot;,&quot;fromError&quot;,&quot;abort&quot;,&quot;responseText&quot;,&quot;attachEvent&quot;,&quot;unloadHandler&quot;,&quot;terminationEvent&quot;,&quot;nextTick&quot;,&quot;isPromiseAvailable&quot;,&quot;Promise&quot;,&quot;resolve&quot;,&quot;then&quot;,&quot;WebSocket&quot;,&quot;MozWebSocket&quot;,&quot;usingBrowserWebSocket&quot;,&quot;defaultBinaryType&quot;,&quot;isReactNative&quot;,&quot;navigator&quot;,&quot;product&quot;,&quot;toLowerCase&quot;,&quot;WS&quot;,&quot;check&quot;,&quot;protocols&quot;,&quot;headers&quot;,&quot;ws&quot;,&quot;addEventListeners&quot;,&quot;onopen&quot;,&quot;autoUnref&quot;,&quot;_socket&quot;,&quot;unref&quot;,&quot;onclose&quot;,&quot;closeEvent&quot;,&quot;onmessage&quot;,&quot;ev&quot;,&quot;onerror&quot;,&quot;lastPacket&quot;,&quot;name&quot;,&quot;transports&quot;,&quot;websocket&quot;,&quot;re&quot;,&quot;parts&quot;,&quot;parse&quot;,&quot;src&quot;,&quot;b&quot;,&quot;replace&quot;,&quot;m&quot;,&quot;exec&quot;,&quot;source&quot;,&quot;host&quot;,&quot;authority&quot;,&quot;ipv6uri&quot;,&quot;pathNames&quot;,&quot;queryKey&quot;,&quot;regx&quot;,&quot;names&quot;,&quot;substr&quot;,&quot;$0&quot;,&quot;$1&quot;,&quot;$2&quot;,&quot;Socket&quot;,&quot;writeBuffer&quot;,&quot;prevBufferLen&quot;,&quot;agent&quot;,&quot;upgrade&quot;,&quot;rememberUpgrade&quot;,&quot;rejectUnauthorized&quot;,&quot;perMessageDeflate&quot;,&quot;threshold&quot;,&quot;transportOptions&quot;,&quot;closeOnBeforeunload&quot;,&quot;id&quot;,&quot;upgrades&quot;,&quot;pingInterval&quot;,&quot;pingTimeout&quot;,&quot;pingTimeoutTimer&quot;,&quot;transport&quot;,&quot;offlineEventListener&quot;,&quot;EIO&quot;,&quot;priorWebsocketSuccess&quot;,&quot;createTransport&quot;,&quot;shift&quot;,&quot;setTransport&quot;,&quot;onDrain&quot;,&quot;failed&quot;,&quot;onTransportOpen&quot;,&quot;msg&quot;,&quot;upgrading&quot;,&quot;flush&quot;,&quot;freezeTransport&quot;,&quot;error&quot;,&quot;onTransportClose&quot;,&quot;onupgrade&quot;,&quot;to&quot;,&quot;probe&quot;,&quot;onHandshake&quot;,&quot;JSON&quot;,&quot;resetPingTimeout&quot;,&quot;sendPacket&quot;,&quot;code&quot;,&quot;filterUpgrades&quot;,&quot;maxPayload&quot;,&quot;getWritablePackets&quot;,&quot;shouldCheckPayloadSize&quot;,&quot;payloadSize&quot;,&quot;options&quot;,&quot;compress&quot;,&quot;cleanupAndClose&quot;,&quot;waitForUpgrade&quot;,&quot;filteredUpgrades&quot;,&quot;j&quot;,&quot;url&quot;,&quot;loc&quot;,&quot;test&quot;,&quot;href&quot;,&quot;withNativeFile&quot;,&quot;File&quot;,&quot;isBinary&quot;,&quot;hasBinary&quot;,&quot;toJSON&quot;,&quot;isArray&quot;,&quot;deconstructPacket&quot;,&quot;buffers&quot;,&quot;packetData&quot;,&quot;pack&quot;,&quot;_deconstructPacket&quot;,&quot;attachments&quot;,&quot;placeholder&quot;,&quot;_placeholder&quot;,&quot;newData&quot;,&quot;reconstructPacket&quot;,&quot;_reconstructPacket&quot;,&quot;PacketType&quot;,&quot;Encoder&quot;,&quot;replacer&quot;,&quot;EVENT&quot;,&quot;ACK&quot;,&quot;BINARY_EVENT&quot;,&quot;BINARY_ACK&quot;,&quot;encodeAsBinary&quot;,&quot;encodeAsString&quot;,&quot;nsp&quot;,&quot;stringify&quot;,&quot;deconstruction&quot;,&quot;unshift&quot;,&quot;Decoder&quot;,&quot;reviver&quot;,&quot;decodeString&quot;,&quot;reconstructor&quot;,&quot;BinaryReconstructor&quot;,&quot;takeBinaryData&quot;,&quot;p&quot;,&quot;start&quot;,&quot;buf&quot;,&quot;next&quot;,&quot;payload&quot;,&quot;tryParse&quot;,&quot;isPayloadValid&quot;,&quot;finishedReconstruction&quot;,&quot;CONNECT&quot;,&quot;DISCONNECT&quot;,&quot;CONNECT_ERROR&quot;,&quot;reconPack&quot;,&quot;binData&quot;,&quot;subDestroy&quot;,&quot;RESERVED_EVENTS&quot;,&quot;freeze&quot;,&quot;connect&quot;,&quot;connect_error&quot;,&quot;disconnect&quot;,&quot;disconnecting&quot;,&quot;newListener&quot;,&quot;io&quot;,&quot;connected&quot;,&quot;receiveBuffer&quot;,&quot;sendBuffer&quot;,&quot;ids&quot;,&quot;acks&quot;,&quot;flags&quot;,&quot;auth&quot;,&quot;_autoConnect&quot;,&quot;subs&quot;,&quot;onpacket&quot;,&quot;subEvents&quot;,&quot;_readyState&quot;,&quot;ack&quot;,&quot;pop&quot;,&quot;_registerAckCallback&quot;,&quot;isTransportWritable&quot;,&quot;engine&quot;,&quot;discardPacket&quot;,&quot;notifyOutgoingListeners&quot;,&quot;timer&quot;,&quot;_packet&quot;,&quot;sameNamespace&quot;,&quot;onconnect&quot;,&quot;onevent&quot;,&quot;onack&quot;,&quot;ondisconnect&quot;,&quot;destroy&quot;,&quot;message&quot;,&quot;emitEvent&quot;,&quot;_anyListeners&quot;,&quot;listener&quot;,&quot;sent&quot;,&quot;emitBuffered&quot;,&quot;_anyOutgoingListeners&quot;,&quot;Backoff&quot;,&quot;ms&quot;,&quot;min&quot;,&quot;max&quot;,&quot;factor&quot;,&quot;jitter&quot;,&quot;attempts&quot;,&quot;duration&quot;,&quot;pow&quot;,&quot;rand&quot;,&quot;random&quot;,&quot;deviation&quot;,&quot;reset&quot;,&quot;setMin&quot;,&quot;setMax&quot;,&quot;setJitter&quot;,&quot;Manager&quot;,&quot;_a&quot;,&quot;nsps&quot;,&quot;reconnection&quot;,&quot;reconnectionAttempts&quot;,&quot;Infinity&quot;,&quot;reconnectionDelay&quot;,&quot;reconnectionDelayMax&quot;,&quot;randomizationFactor&quot;,&quot;backoff&quot;,&quot;_parser&quot;,&quot;parser&quot;,&quot;encoder&quot;,&quot;decoder&quot;,&quot;autoConnect&quot;,&quot;v&quot;,&quot;_reconnection&quot;,&quot;_reconnectionAttempts&quot;,&quot;_reconnectionDelay&quot;,&quot;_randomizationFactor&quot;,&quot;_reconnectionDelayMax&quot;,&quot;_timeout&quot;,&quot;_reconnecting&quot;,&quot;reconnect&quot;,&quot;Engine&quot;,&quot;skipReconnect&quot;,&quot;openSubDestroy&quot;,&quot;errorSub&quot;,&quot;maybeReconnectOnOpen&quot;,&quot;onping&quot;,&quot;ondata&quot;,&quot;ondecoded&quot;,&quot;add&quot;,&quot;active&quot;,&quot;_close&quot;,&quot;delay&quot;,&quot;onreconnect&quot;,&quot;attempt&quot;,&quot;cache&quot;,&quot;parsed&quot;,&quot;newConnection&quot;,&quot;forceNew&quot;,&quot;multiplex&quot;],&quot;mappings&quot;:&quot;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&quot;&#125;</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://bitterteaer.github.io">karr</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://bitterteaer.github.io/flask-websocket/">https://bitterteaer.github.io/flask-websocket/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://unpkg.com/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://unpkg.com/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/java%E4%B8%8E%E5%AE%89%E5%8D%93socket%E9%80%9A%E8%AE%AF/" title="java与安卓socket通讯"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">java与安卓socket通讯</div></div></a></div><div class="next-post pull-right"><a href="/%E9%80%82%E7%94%A8%E4%BA%8Eyolov5%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86%E8%BD%AC%E6%8D%A2/" title="适用于yolov5的数据集转换"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">适用于yolov5的数据集转换</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">karr</div><div class="author-info__description">莫等闲，白了少年头。</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">281</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">195</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://gitee.com/bitterteaer"><i class="fab fa-github"></i><span>gitee</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/bitterteaer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://www.cnblogs.com/bitterteaer" target="_blank" title="Cnblogs"><i class="fa fa-book-open"></i></a><a class="social-icon" href="mailto:bitterteaer@163.com" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="toc-number">1.</span> <span class="toc-text">项目结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-socketio"><span class="toc-number">2.</span> <span class="toc-text">web-socketio</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#index-html"><span class="toc-number">2.1.</span> <span class="toc-text">index.html</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flask-socketio"><span class="toc-number">3.</span> <span class="toc-text">flask-socketio</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#app-py"><span class="toc-number">3.1.</span> <span class="toc-text">app.py</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#socketio-v4-5-1-js"><span class="toc-number">4.</span> <span class="toc-text">socketio_v4.5.1.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#socket-io-js-map"><span class="toc-number">5.</span> <span class="toc-text">socket.io.js.map</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/%E4%BC%A0%E7%BB%9F%E5%AE%8C%E6%95%B4%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E5%9B%BE/" title="传统完整的微服务系统架构图">传统完整的微服务系统架构图</a><time datetime="2025-02-22T04:08:47.000Z" title="Created 2025-02-22 12:08:47">2025-02-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/python-re-search/" title="python re.search">python re.search</a><time datetime="2025-01-07T04:22:09.000Z" title="Created 2025-01-07 12:22:09">2025-01-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/%E8%8B%B1%E8%AF%AD%E5%8D%95%E8%AF%8Dstate%E5%92%8Cstatus%E7%9A%84%E5%8C%BA%E5%88%AB/" title="state和status的区别">state和status的区别</a><time datetime="2025-01-02T08:01:19.000Z" title="Created 2025-01-02 16:01:19">2025-01-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86vue%E4%B9%8B%E4%BA%8B%E4%BB%B6%E9%98%BB%E6%AD%A2%E5%86%92%E6%B3%A1/" title="重新认识vue之事件阻止冒泡">重新认识vue之事件阻止冒泡</a><time datetime="2025-01-02T06:31:55.000Z" title="Created 2025-01-02 14:31:55">2025-01-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Extraneous-non-props-attributes-id-were-passed-to-component-but-could-not-be___/" title="Extraneous non-props attributes (id) were passed to component but could not be automatically inherited because component renders fragment or text root nodes.">Extraneous non-props attributes (id) were passed to component but could not be automatically inherited because component renders fragment or text root nodes.</a><time datetime="2024-11-13T02:29:10.000Z" title="Created 2024-11-13 10:29:10">2024-11-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By karr</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a href="https://beian.miit.gov.cn/" target="_blank">粤ICP备2024240115号</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://unpkg.com/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>